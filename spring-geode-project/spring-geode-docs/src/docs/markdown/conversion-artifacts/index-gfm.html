<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.17">
<meta name="author" content="John Blum">
<title>Spring Boot for Apache Geode Reference Guide</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}
details>summary::-webkit-details-marker{display:none}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos,pre.pygments .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
pre.pygments span.linenos{display:inline-block;margin-right:.75em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
li>p:empty:only-child::before{content:"";display:inline-block}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/prettify.min.css">
</head>
<body id="spring-boot-data-geode" class="book toc2 toc-left">
<div id="header">
<h1>Spring Boot for Apache Geode Reference Guide</h1>
<div class="details">
<span id="author" class="author">John Blum</span><br>
<span id="revnumber">version {version},</span>
<span id="revdate">2022-10-06</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#introduction">1. Introduction</a></li>
<li><a href="#getting-started">2. Getting Started</a></li>
<li><a href="#maven-gradle">3. Using Spring Boot for Apache Geode</a></li>
<li><a href="#sbdg-dependency-versions">4. Primary Dependency Versions</a></li>
<li><a href="#geode-clientcache-applications">5. Building <code>ClientCache</code> Applications</a></li>
<li><a href="#geode-configuration-auto">6. Auto-configuration</a></li>
<li><a href="#geode-configuration-declarative">7. Declarative Configuration</a></li>
<li><a href="#geode-configuration-externalized">8. Externalized Configuration</a></li>
<li><a href="#geode-configuration-gemfire-properties">9. Using Geode Properties</a></li>
<li><a href="#geode-caching-provider">10. Caching with Apache Geode</a></li>
<li><a href="#geode-data-access-region-templates">11. Data Access with GemfireTemplate</a></li>
<li><a href="#geode-repositories">12. Spring Data Repositories</a></li>
<li><a href="#geode-functions">13. Function Implementations &amp; Executions</a></li>
<li><a href="#geode-continuous-query">14. Continuous Query</a></li>
<li><a href="#geode-data-using">15. Using Data</a></li>
<li><a href="#geode-data-serialization">16. Data Serialization with PDX</a></li>
<li><a href="#geode-logging">17. Logging</a></li>
<li><a href="#geode-security">18. Security</a></li>
<li><a href="#geode-testing">19. Testing</a></li>
<li><a href="#geode-api-extensions">20. Apache Geode API Extensions</a></li>
<li><a href="#actuator">21. Spring Boot Actuator</a></li>
<li><a href="#geode-session">22. Spring Session</a></li>
<li><a href="#cloudfoundry">23. Pivotal CloudFoundry</a></li>
<li><a href="#geode-docker">24. Docker</a></li>
<li><a href="#geode-samples">25. Samples</a></li>
<li><a href="#appendix">26. Appendix</a></li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div id="abstract" class="paragraph">
<p>Spring Boot for Apache Geode provides the convenience of Spring Boot&#8217;s <em>convention over configuration</em> approach
by using <em>auto-configuration</em> with Spring Framework&#8217;s powerful abstractions and highly consistent programming model to
simplify the development of Apache Geode applications in a Spring context.</p>
</div>
<div class="paragraph">
<p>Secondarily, Spring Boot for Apache Geode provides developers with a consistent experience whether building
and running Spring Boot, Apache Geode applications locally or in a managed environment, such as with
<a href="https://tanzu.vmware.com/tanzu">VMware Tanzu Application Service</a> (TAS).</p>
</div>
<div class="paragraph">
<p>This project is a continuation and a logical extension to Spring Data for Apache Geode&#8217;s
<a href="https://docs.spring.io/spring-data/geode/docs/current/reference/html/#bootstrap-annotation-config">Annotation-based configuration model</a>, and the goals
set forth in that model: <em>To enable application developers to <strong>get up and running</strong> as <strong>quickly</strong>, <strong>reliably</strong>, and as
<strong>easily</strong> as possible</em>. In fact, Spring Boot for Apache Geode builds on this very
<a href="https://docs.spring.io/spring-data/geode/docs/current/reference/html/#bootstrap-annotation-config">foundation</a> cemented in Spring Data for Apache Geode
since the Spring Data Kay (2.0) Release Train.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="introduction">1. Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Spring Boot for Apache Geode automatically applies <em>auto-configuration</em> to several key application concerns
(<em>use cases</em>) including, but not limited to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>Look-Aside, [Async] Inline, Near</em> and <em>Multi-Site Caching</em>, by using Apache Geode as a caching provider
in <a href="https://docs.spring.io/spring/docs/current/spring-framework-reference/integration.html#cache">Spring&#8217;s Cache Abstraction</a>.
For more information, see <a href="#geode-caching-provider">Caching with Apache Geode</a>.</p>
</li>
<li>
<p><a href="https://en.wikipedia.org/wiki/System_of_record"><em>System of Record</em> (SOR)</a>, persisting application state in Apache Geode
by using <a href="https://docs.spring.io/spring-data/commons/docs/current/reference/html/#repositories">Spring Data Repositories</a>.
For more information, see <a href="#geode-repositories">Spring Data Repositories</a>.</p>
</li>
<li>
<p><em>Transactions</em>, managing application state consistently with <a href="https://docs.spring.io/spring/docs/current/spring-framework-reference/data-access.html#transaction">Spring Transaction Management</a>
with support for both <a href="https://docs.spring.io/spring-data/geode/docs/current/reference/html/#apis:transaction-management">Local Cache</a>
and <a href="https://docs.spring.io/spring-data/geode/docs/current/reference/html/#apis:global-transaction-management">Global JTA</a> Transactions.</p>
</li>
<li>
<p><em>Distributed Computations</em>, run with Apache Geode&#8217;s <a href="https://geode.apache.org/docs/guide/{apache-geode-doc-version}/developing/function_exec/chapter_overview.html">Function Execution</a>
framework and conveniently implemented and executed with <a href="https://docs.spring.io/spring-data/geode/docs/current/reference/html/#function-annotations">POJO-based, annotation support for Functions</a>.
For more information, see <a href="#geode-functions">Function Implementations &amp; Executions</a>.</p>
</li>
<li>
<p><em>Continuous Queries</em>, expressing interests in a stream of events and letting applications react to and process changes
to data in near real-time with Apache Geode&#8217;s <a href="https://geode.apache.org/docs/guide/{apache-geode-doc-version}/developing/continuous_querying/chapter_overview.html">Continuous Query (CQ)</a>.
Listeners/Handlers are defined as simple Message-Driven POJOs (MDP) with Spring&#8217;s <a href="https://docs.spring.io/spring/docs/current/spring-framework-reference/integration.html#jms-mdp">Message Listener Container</a>,
which has been <a href="https://docs.spring.io/spring-data/geode/docs/current/reference/html/#apis:continuous-query">extended</a> with its <a href="https://docs.spring.io/spring-data/geode/docs/current/reference/html/#bootstrap-annotation-config-continuous-queries">configurable</a>
CQ support.
For more information, see <a href="#geode-continuous-query">Continuous Query</a>.</p>
</li>
<li>
<p><em>Data Serialization</em> using Apache Geode <a href="https://geode.apache.org/docs/guide/{apache-geode-doc-version}/developing/data_serialization/gemfire_pdx_serialization.html">PDX</a>
with first-class <a href="https://docs.spring.io/spring-data/geode/docs/current/reference/html/#bootstrap-annotation-config-pdx">configuration</a>
and <a href="https://docs.spring.io/spring-data/geode/docs/current/reference/html/#mapping.pdx-serializer">support</a>.
For more information, see <a href="#geode-data-serialization">Data Serialization with PDX</a>.</p>
</li>
<li>
<p><em>Data Initialization</em> to quickly load (import) data to hydrate the cache during application startup or write (export)
data on application shutdown to move data between environments (for example, TEST to DEV).
For more information, see <a href="#geode-data-using">Using Data</a>.</p>
</li>
<li>
<p><em>Actuator</em>, to gain insight into the runtime behavior and operation of your cache, whether a client or a peer.
For more information, see <a href="#actuator">Spring Boot Actuator</a>.</p>
</li>
<li>
<p><em>Logging</em>, to quickly and conveniently enable or adjust Apache Geode log levels in your Spring Boot application
to gain insight into the runtime operations of the application as they occur.
For more information, see <a href="#geode-logging">Logging</a>.</p>
</li>
<li>
<p><em>Security</em>, including <a href="https://geode.apache.org/docs/guide/{apache-geode-doc-version}/managing/security/authentication_overview.html">Authentication</a>
&amp; <a href="https://geode.apache.org/docs/guide/{apache-geode-doc-version}/managing/security/authorization_overview.html">Authorization</a>, and Transport Layer Security (TLS)
with Apache Geode <a href="https://geode.apache.org/docs/guide/{apache-geode-doc-version}/managing/security/ssl_overview.html">Secure Socket Layer (SSL)</a>. Once more,
Spring Data for Apache Geode includes first-class support for configuring <a href="https://docs.spring.io/spring-data/geode/docs/current/reference/html/#bootstrap-annotation-config-security">Auth</a>
and <a href="https://docs.spring.io/spring-data/geode/docs/current/reference/html/#bootstrap-annotation-config-ssl">SSL</a>.
For more information, see <a href="#geode-security">Security</a>.</p>
</li>
<li>
<p><em>HTTP Session state management</em>, by including Spring Session for Apache Geode on your application&#8217;s classpath.
For more information, see <a href="#geode-session">Spring Session</a>.</p>
</li>
<li>
<p><em>Testing</em>. Whether you write Unit or Integration Tests for Apache Geode in a Spring context, SBDG covers all
your testing needs with the help of <a href="https://github.com/spring-projects/spring-test-data-geode#spring-test-framework-for-apache-geode&#8212;&#8203;vmware-tanzu-gemfire">STDG</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>While Spring Data for Apache Geode offers a simple, consistent, convenient and declarative approach to configure
all these powerful Apache Geode features, Spring Boot for Apache Geode makes it even easier to do, as we
will explore throughout this reference documentation.</p>
</div>
<div class="sect2">
<h3 id="introduction-goals">1.1. Goals</h3>
<div class="paragraph">
<p>While the SBDG project has many goals and objectives, the primary goals of this project center around three key
principles:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>From <strong><em>Open Source</em></strong> (Apache Geode) to <strong><em>Commercial</em></strong> (VMware Tanzu GemFire).</p>
</li>
<li>
<p>From <strong><em>Non-Managed</em></strong> (self-managed/self-hosted or on-premise installations) to <strong><em>Managed</em></strong>
(VMware Tanzu GemFire for VMs, VMware Tanzu GemFire for K8S) environments.</p>
</li>
<li>
<p>With <strong>little to no code or configuration changes</strong> necessary.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>It is also possible to go in the reverse direction, from <em>Managed</em> back to a <em>Non-Managed</em> environment
and even from <em>Commercial</em> back to the <em>Open Source</em> offering, again, with <em>little to no code or configuration</em> changes.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
SBDG&#8217;s promise is to deliver on these principles as much as is technically possible and as is technically allowed
by Apache Geode.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="getting-started">2. Getting Started</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To be immediately productive and as effective as possible when you use Spring Boot for Apache Geode, it helps
to understand the foundation on which this project is built.</p>
</div>
<div class="paragraph">
<p>The story begins with the Spring Framework and the <a href="https://docs.spring.io/spring/docs/current/spring-framework-reference/core.html#spring-core">core technologies and concepts</a>
built into the Spring container.</p>
</div>
<div class="paragraph">
<p>Then our journey continues with the extensions built into Spring Data for Apache Geode to simplify the development
of Apache Geode applications in a Spring context, using Spring&#8217;s powerful abstractions and highly consistent
programming model. This part of the story was greatly enhanced in Spring Data Kay,
with the <a href="https://docs.spring.io/spring-data/geode/docs/current/reference/html/#bootstrap-annotation-config">Annotation-based configuration model</a>.
Though this new configuration approach uses annotations and provides sensible defaults, its use is also very explicit
and assumes nothing. If any part of the configuration is ambiguous, SDG will fail fast. SDG gives you choice, so you
still must tell SDG what you want.</p>
</div>
<div class="paragraph">
<p>Next, we venture into Spring Boot and all of its wonderfully expressive and highly opinionated &#8220;convention over configuration&#8221;
approach for getting the most out of your Spring Apache Geode applications in the easiest, quickest, and most
reliable way possible. We accomplish this by combining Spring Data for Apache Geode&#8217;s <a href="https://docs.spring.io/spring-data/geode/docs/current/reference/html/#bootstrap-annotation-config">annotation-based configuration</a>
with Spring Boot&#8217;s <a href="https://docs.spring.io/spring-boot/docs/current/reference/html/#using-boot-auto-configuration">auto-configuration</a> to get you up and running
even faster and more reliably so that you are productive from the start.</p>
</div>
<div class="paragraph">
<p>As a result, it would be pertinent to begin your Spring Boot education
with <a href="https://docs.spring.io/spring-boot/docs/current/reference/html/#getting-started">Spring Boot&#8217;s documentation</a>.</p>
</div>
<div class="paragraph">
<p>Finally, we arrive at Spring Boot for Apache Geode (SBDG).</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
See the corresponding Sample <a href="guides/getting-started.html">Guide</a> and {github-samples-url}/intro/getting-started[Code]
to see Spring Boot for Apache Geode in action.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="maven-gradle">3. Using Spring Boot for Apache Geode</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To use Spring Boot for Apache Geode, declare the <code>spring-geode-starter</code> on your Spring Boot application classpath:</p>
</div>
<div class="exampleblock">
<div class="title">Example 1. Maven</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;dependencies&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.springframework.geode&lt;/groupId&gt;
        &lt;artifactId&gt;spring-geode-starter&lt;/artifactId&gt;
        &lt;version&gt;{spring-boot-data-geode-version}&lt;/version&gt;
    &lt;/dependency&gt;
&lt;/dependencies&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="gradle">dependencies {
    compile 'org.springframework.geode:spring-geode-starter:{spring-boot-data-geode-version}'
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="maven-bom">3.1. Maven BOM</h3>
<div class="paragraph">
<p>If you anticipate using more than one Spring Boot for Apache Geode (SBDG) module in your Spring Boot application,
you can also declare the new <code>org.springframework.geode:spring-geode-bom</code> Maven BOM in your application Maven POM.</p>
</div>
<div class="paragraph">
<p>Your application use case may require more than one module if (for example, you need (HTTP) Session state management
and replication with, for example, <code>spring-geode-starter-session</code>), if you need to enable Spring Boot Actuator endpoints
for Apache Geode (for example, <code>spring-geode-starter-actuator</code>), or if you need assistance writing complex Unit
and (Distributed) Integration Tests with Spring Test for Apache Geode (STDG) (for example, <code>spring-geode-starter-test</code>).</p>
</div>
<div class="paragraph">
<p>You can declare and use any one of the SBDG modules:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>spring-geode-starter</code></p>
</li>
<li>
<p><code>spring-geode-starter-actuator</code></p>
</li>
<li>
<p><code>spring-geode-starter-logging</code></p>
</li>
<li>
<p><code>spring-geode-starter-session</code></p>
</li>
<li>
<p><code>spring-geode-starter-test</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When more than one SBDG module is in use, it makes sense to declare the <code>spring-geode-bom</code> to manage all the dependencies
such that the versions and transitive dependencies necessarily align properly.</p>
</div>
<div class="paragraph">
<p>A Spring Boot application Maven POM that declares the <code>spring-geode-bom</code> along with two or more module dependencies
might appear as follows:</p>
</div>
<div class="exampleblock">
<div class="title">Example 2. Spring Boot application Maven POM</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;project xmlns="http://maven.apache.org/POM/4.0.0"&gt;

    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;

    &lt;parent&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;
        &lt;version&gt;{spring-boot-version}&lt;/version&gt;
    &lt;/parent&gt;

    &lt;artifactId&gt;my-spring-boot-application&lt;/artifactId&gt;

    &lt;properties&gt;
        &lt;spring-geode.version&gt;{spring-boot-data-geode-version}&lt;/spring-geode.version&gt;
    &lt;/properties&gt;

    &lt;dependencyManagement&gt;
        &lt;dependencies&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;org.springframework.geode&lt;/groupId&gt;
                &lt;artifactId&gt;spring-geode-bom&lt;/artifactId&gt;
                &lt;version&gt;${spring-geode.version}&lt;/version&gt;
                &lt;scope&gt;import&lt;/scope&gt;
                &lt;type&gt;pom&lt;/type&gt;
            &lt;/dependency&gt;
        &lt;/dependencies&gt;
    &lt;/dependencyManagement&gt;

    &lt;dependencies&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.geode&lt;/groupId&gt;
            &lt;artifactId&gt;spring-geode-starter&lt;/artifactId&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.geode&lt;/groupId&gt;
            &lt;artifactId&gt;spring-geode-starter-session&lt;/artifactId&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.geode&lt;/groupId&gt;
            &lt;artifactId&gt;spring-geode-starter-test&lt;/artifactId&gt;
            &lt;scope&gt;test&lt;/scope&gt;
        &lt;/dependency&gt;
    &lt;/dependencies&gt;

&lt;/project&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Notice that:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The Spring Boot application Maven POM (<code>pom.xml</code>) contains a <code>&lt;dependencyManagement&gt;</code> section that declares
the <code>org.springframework.geode:spring-geode-bom</code>.</p>
</li>
<li>
<p>None of the <code>spring-geode-starter[-xyz]</code> dependencies explicitly specify a <code>&lt;version&gt;</code>. The version is managed by
the <code>spring-geode.version</code> property, making it easy to switch between versions of SBDG as needed and use it in all
the SBDG modules declared and used in your application Maven POM.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If you change the version of SBDG, be sure to change the <code>org.springframework.boot:spring-boot-starter-parent</code> POM
version to match.  SBDG is always one <code>major</code> version behind but matches on <code>minor</code> version and <code>patch</code> version
(and <code>version qualifier</code>&#8201;&#8212;&#8201;<code>SNAPSHOT</code>, <code>M#</code>, <code>RC#</code>, or <code>RELEASE</code>, if applicable).</p>
</div>
<div class="paragraph">
<p>For example, SBDG <code>1.4.0</code> is based on Spring Boot <code>2.4.0</code>. SBDG <code>1.3.5.RELEASE</code> is based on Spring Boot <code>2.3.5.RELEASE</code>,
and so on. It is important that the versions align.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
All of these concerns are handled for you by going to <a href="https://start.spring.io">start.spring.io</a>
and adding the &#8220;_Spring for Apache Geode_&#8221; dependency to a project. For convenience, you can click
this <a href="https://start.spring.io/#!platformVersion={spring-boot-version}&amp;dependencies=geode">link</a> to get started.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="gradle-dependency-management">3.2. Gradle Dependency Management</h3>
<div class="paragraph">
<p>Using Gradle is similar to using Maven.</p>
</div>
<div class="paragraph">
<p>Again, if you declare and use more than one SBDG module in your Spring Boot application (for example,
the <code>spring-geode-starter</code> along with the <code>spring-geode-starter-session</code> dependency), declaring the <code>spring-geode-bom</code>
inside your application Gradle build file helps.</p>
</div>
<div class="paragraph">
<p>Your application Gradle build file configuration (roughly) appears as follows:</p>
</div>
<div class="exampleblock">
<div class="title">Example 3. Spring Boot application Gradle build file</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="groovy">plugins {
  id 'org.springframework.boot' version '{spring-boot-version}'
  id 'io.spring.dependency-management' version '1.0.10.RELEASE'
  id 'java'
}

// ...

ext {
  set('springGeodeVersion', "{spring-boot-data-geode-version}")
}

dependencies {
  implementation 'org.springframework.geode:spring-geode-starter'
  implementation 'org.springframework.geode:spring-geode-starter-actuator'
  testImplementation 'org.springframework.boot:spring-boot-starter-test'
}

dependencyManagement {
  imports {
    mavenBom "org.springframework.geode:spring-geode-bom:${springGeodeVersion}"
  }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>A combination of the <a href="https://docs.spring.io/spring-boot/docs/current/reference/html/using-spring-boot.html#using-boot-gradle">Spring Boot Gradle Plugin</a>
and the <a href="https://github.com/spring-gradle-plugins/dependency-management-plugin">Spring Dependency Management Gradle Plugin</a>
manages the application dependencies for you.</p>
</div>
<div class="paragraph">
<p>In a nutshell, the <em>Spring Dependency Management Gradle Plugin</em> provides dependency management capabilities for Gradle,
much like Maven. The <em>Spring Boot Gradle Plugin</em> defines a curated and tested set of versions for many third party Java
libraries. Together, they make adding dependencies and managing (compatible) versions easier.</p>
</div>
<div class="paragraph">
<p>Again, you do not need to explicitly declare the version when adding a dependency, including a new SBDG module
dependency (for example, <code>spring-geode-starter-session</code>), since this has already been determined for you.
You can declare the dependency as follows:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="groovy">implementation 'org.springframework.geode:spring-geode-starter-session'</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The version of SBDG is controlled by the extension property (<code>springGeodeVersion</code>) in the application Gradle build file.</p>
</div>
<div class="paragraph">
<p>To use a different version of SBDG, set the <code>springGeodeVersion</code> property to the desired version (for example,
<code>1.3.5.RELEASE</code>). Remember to be sure that the version of Spring Boot matches.</p>
</div>
<div class="paragraph">
<p>SBDG is always one <code>major</code> version behind but matches on <code>minor</code> version and <code>patch</code> version (and <code>version qualifier</code>,
such as <code>SNAPSHOT</code>, <code>M#</code>, <code>RC#</code>, or <code>RELEASE</code>, if applicable). For example, SBDG <code>1.4.0</code> is based on Spring Boot <code>2.4.0</code>,
SBDG <code>1.3.5.RELEASE</code> is based on Spring Boot <code>2.3.5.RELEASE</code>, and so on. It is important that the versions align.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
All of these concerns are handled for you by going to <a href="https://start.spring.io">start.spring.io</a>
and adding the &#8220;_Spring for Apache Geode_&#8221; dependency to a project. For convenience, you can click
this <a href="https://start.spring.io/#!platformVersion={spring-boot-version}&amp;dependencies=geode">link</a> to get started.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="sbdg-dependency-versions">4. Primary Dependency Versions</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Spring Boot for Apache Geode {version} builds and depends on the following versions of the base projects
listed below:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. Dependencies &amp; Versions</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Version</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Java (JRE)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">17</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Apache Geode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">{apache-geode-artifact-version}</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Spring Framework</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">{spring-version}</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Spring Boot</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">{spring-boot-version}</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Spring Data for Apache Geode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">{spring-data-geode-version}</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Spring Session for Apache Geode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">{spring-session-data-geode-version}</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Spring Test for Apache Geode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">{spring-test-data-geode-version}</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>It is essential that the versions of all the dependencies listed in the table above align accordingly. If the dependency
versions are misaligned, then functionality could be missing, or certain functions could behave unpredictably
from its specified contract.</p>
</div>
<div class="paragraph">
<p>Please follow dependency versions listed in the table above and use it as a guide when setting up
your Spring Boot projects using Apache Geode.</p>
</div>
<div class="paragraph">
<p>Again, the best way to setup your Spring Boot projects is by first, declaring the <code>spring-boot-starter-parent</code> Maven POM
as the parent POM in your project POM:</p>
</div>
<div class="exampleblock">
<div class="title">Example 4. Spring Boot application Maven POM parent</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;parent&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;
    &lt;version&gt;{spring-boot-version}&lt;/version&gt;
&lt;/parent&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Or, when using Grade:</p>
</div>
<div class="exampleblock">
<div class="title">Example 5. Spring Boot application Gradle build file Gradle Plugins required for dependency management</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="groovy">plugins {
  id 'org.springframework.boot' version '{spring-boot-version}'
  id 'io.spring.dependency-management' version '1.0.10.RELEASE'
  id 'java'
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>And then, use the Spring Boot for Apache Geode, <code>spring-geode-bom</code>.  For example, with Maven:</p>
</div>
<div class="exampleblock">
<div class="title">Example 6. Spring Boot application using the Spring Boot for Apache Geode, <code>spring-geode-bom</code> BOM in Maven</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;properties&gt;
    &lt;spring-geode.version&gt;{spring-boot-data-geode-version}&lt;/spring-geode.version&gt;
&lt;/properties&gt;

&lt;dependencyManagement&gt;
    &lt;dependencies&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.geode&lt;/groupId&gt;
            &lt;artifactId&gt;spring-geode-bom&lt;/artifactId&gt;
            &lt;version&gt;${spring-geode.version}&lt;/version&gt;
            &lt;scope&gt;import&lt;/scope&gt;
            &lt;type&gt;pom&lt;/type&gt;
        &lt;/dependency&gt;
    &lt;/dependencies&gt;
&lt;/dependencyManagement&gt;

&lt;dependencies&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.springframework.geode&lt;/groupId&gt;
        &lt;artifactId&gt;spring-geode-starter&lt;/artifactId&gt;
    &lt;/dependency&gt;
&lt;/dependencies&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Or, with Gradle:</p>
</div>
<div class="exampleblock">
<div class="title">Example 7. Spring Boot application using the Spring Boot for Apache Geode, <code>spring-geode-bom</code> BOM in Gradle</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="groovy">ext {
    set('springGeodeVersion', "{spring-boot-data-geode-version}")
}

dependencies {
    implementation 'org.springframework.geode:spring-geode-starter'
}

dependencyManagement {
    imports {
        mavenBom "org.springframework.geode:spring-geode-bom:${springGeodeVersion}"
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>All of this is made simple by going to <a href="https://start.spring.io">start.spring.io</a> and creating a Spring Boot
<code>{spring-boot-version}</code> project using Apache Geode.</p>
</div>
<div class="sect2">
<h3 id="sbdg-dependency-version-overrides">4.1. Overriding Dependency Versions</h3>
<div class="paragraph">
<p>While Spring Boot for Apache Geode requires baseline versions of the <a href="#sbdg-dependency-versions">primary dependencies</a>
listed above, it is possible, using Spring Boot&#8217;s dependency management capabilities, to override the versions of
3rd-party Java libraries and dependencies managed by Spring Boot itself.</p>
</div>
<div class="paragraph">
<p>When your Spring Boot application Maven POM inherits from the <code>org.springframework.boot:spring-boot-starter-parent</code>,
or alternatively, applies the Spring Dependency Management Gradle Plugin (<code>io.spring.dependency-management</code>) along with
the Spring Boot Gradle Plugin (<code>org.springframework.boot</code>) in your Spring Boot application Gradle build file, then you
automatically enable the dependency management capabilities provided by Spring Boot for all 3rd-party Java libraries
and dependencies curated and managed by Spring Boot.</p>
</div>
<div class="paragraph">
<p>Spring Boot&#8217;s dependency management harmonizes all 3rd-party Java libraries and dependencies that you are likely to use
in your Spring Boot applications. All these dependencies have been tested and proven to work with the version of Spring
Boot and other Spring dependencies (e.g. Spring Data, Spring Security) you may be using in your Spring Boot applications.</p>
</div>
<div class="paragraph">
<p>Still, there may be times when you want, or even need to override the version of some 3rd-party Java libraries used by
your Spring Boot applications, that are specifically managed by Spring Boot. In cases where you know that using a
different version of a managed dependency is safe to do so, then you have a few options for how to override
the dependency version:</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Use caution when overriding dependencies since they may not be compatible with other dependencies managed by
Spring Boot for which you may have declared on your application classpath, for example, by adding a starter. It is
common for multiple Java libraries to share the same transitive dependencies but use different versions of the Java
library (e.g. logging). This will often lead to Exceptions thrown at runtime due to API differences. Keep in mind that
Java resolves classes on the classpath from the first class definition that is found in the order that JARs or paths
have been defined on the classpath. Finally, Spring does not support dependency versions that have been overridden
and do not match the versions declared and managed by Spring Boot.
See <a href="https://docs.spring.io/spring-boot/docs/current/reference/html/#appendix.dependency-versions.coordinates">documentation</a>.
</td>
</tr>
</table>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#sbdg-dependency-version-overrides-property">Version Property Override</a></p>
</li>
<li>
<p><a href="#sbdg-dependency-version-overrides-dependencymanagement">Override with Dependency Management</a></p>
</li>
</ul>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
You should refer to Spring Boot&#8217;s documentation on
<a href="https://docs.spring.io/spring-boot/docs/current/reference/html/using.html#using.build-systems.dependency-management">Dependency Management</a> for more details.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="sbdg-dependency-version-overrides-property">4.1.1. Version Property Override</h4>
<div class="paragraph">
<p>Perhaps the easiest option to change the version of a Spring Boot managed dependency is to set the version property
used by Spring Boot to control the dependency&#8217;s version to the desired Java library version.</p>
</div>
<div class="paragraph">
<p>For example, if you want to use a different version of <strong>Log4j</strong> than what is currently set and determined by
Spring Boot, then you would do:</p>
</div>
<div class="listingblock java">
<div class="title">Maven dependency version property override</div>
<div class="content">
<pre class="prettyprint highlight"><code>&lt;properties&gt;
  &lt;log4j2.version&gt;2.17.2&lt;/log4j2.version&gt;
&lt;/properties&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Gradle dependency version property override</div>
<div class="content">
<pre>ext['log4j2.version'] = '2.17.2'</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The Log4j version number used in the Maven and Gradle examples shown above is arbitrary. You must set
the <code>log4j2.version</code> property to a valid Log4j version that would be resolvable by Maven or Gradle when given
the fully qualified artifact: <code>org.apache.logging.log4j:log4j:2.17.2</code>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The version property name must precisely match the version property declared in the <code>spring-boot-dependencies</code>
Maven POM.</p>
</div>
<div class="paragraph">
<p>See Spring Boot&#8217;s documentation on <a href="https://docs.spring.io/spring-boot/docs/current/reference/html/#appendix.dependency-versions.properties">version properties</a>.</p>
</div>
<div class="paragraph">
<p>Additional details can be found in the Spring Boot Maven Plugin
<a href="https://docs.spring.io/spring-boot/docs/current/maven-plugin/reference/htmlsingle/#using.parent-pom">documentation</a>
as well as the Spring Boot Gradle Plugin
<a href="https://docs.spring.io/spring-boot/docs/current/gradle-plugin/reference/htmlsingle/#managing-dependencies">documentation</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="sbdg-dependency-version-overrides-dependencymanagement">4.1.2. Override with Dependency Management</h4>
<div class="paragraph">
<p>This option is not specific to Spring in general, or Spring Boot in particular, but applies to Maven and Gradle,
which both have intrinsic dependency management features and capabilities.</p>
</div>
<div class="paragraph">
<p>This approach is useful to not only control the versions of the dependencies managed by Spring Boot directly, but also
control the versions of dependencies that may be transitively pulled in by the dependencies that are managed by
Spring Boot. Additionally, this approach is more universal since it is handled by Maven or Gradle itself.</p>
</div>
<div class="paragraph">
<p>For example, when you declare the <code>org.springframework.boot:spring-boot-starter-test</code> dependency in your Spring Boot
application Maven POM or Gradle build file for testing purposes, you will see a dependency tree similar to:</p>
</div>
<div class="listingblock">
<div class="title"><code>$gradlew dependencies</code> OR <code>$mvn dependency:tree</code></div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="text">...
[INFO] +- org.springframework.boot:spring-boot-starter-test:jar:2.6.4:test
[INFO] |  +- org.springframework.boot:spring-boot-test:jar:2.6.4:test
[INFO] |  +- org.springframework.boot:spring-boot-test-autoconfigure:jar:2.6.4:test
[INFO] |  +- com.jayway.jsonpath:json-path:jar:2.6.0:test
[INFO] |  |  +- net.minidev:json-smart:jar:2.4.8:test
[INFO] |  |  |  \- net.minidev:accessors-smart:jar:2.4.8:test
[INFO] |  |  |     \- org.ow2.asm:asm:jar:9.1:test
[INFO] |  |  \- org.slf4j:slf4j-api:jar:1.7.36:compile
[INFO] |  +- jakarta.xml.bind:jakarta.xml.bind-api:jar:2.3.3:test
[INFO] |  |  \- jakarta.activation:jakarta.activation-api:jar:1.2.2:test
[INFO] |  +- org.assertj:assertj-core:jar:3.21.0:compile
[INFO] |  +- org.hamcrest:hamcrest:jar:2.2:compile
[INFO] |  +- org.junit.jupiter:junit-jupiter:jar:5.8.2:test
[INFO] |  |  +- org.junit.jupiter:junit-jupiter-api:jar:5.8.2:test
[INFO] |  |  |  +- org.opentest4j:opentest4j:jar:1.2.0:test
[INFO] |  |  |  +- org.junit.platform:junit-platform-commons:jar:1.8.2:test
[INFO] |  |  |  \- org.apiguardian:apiguardian-api:jar:1.1.2:test
[INFO] |  |  +- org.junit.jupiter:junit-jupiter-params:jar:5.8.2:test
[INFO] |  |  \- org.junit.jupiter:junit-jupiter-engine:jar:5.8.2:test
[INFO] |  |     \- org.junit.platform:junit-platform-engine:jar:1.8.2:test
...</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you wanted to override and control the version of the <code>opentest4j</code> transitive dependency, for whatever reason,
perhaps because you are using the <code>opentest4j</code> API directly in your application tests, then you could add dependency
management in either Maven or Gradle to control the <code>opentest4j</code> dependency version.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <code>opentest4j</code> dependency is pulled in by JUnit and is not a dependency that Spring Boot specifically manages.
Of course, Maven or Gradle&#8217;s dependency management capabilities can be used to override dependencies that are managed
by Spring Boot as well.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Using the <code>opentest4j</code> dependency as an example, you can override the dependency version by doing the following:</p>
</div>
<div class="listingblock">
<div class="title">Maven dependency version override</div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;project&gt;

    &lt;dependencyManagement&gt;
        &lt;dependencies&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;org.opentest4j&lt;/groupId&gt;
                &lt;artifactId&gt;opentest4j&lt;/artifactId&gt;
                &lt;version&gt;1.0.0&lt;/version&gt;
            &lt;/dependency&gt;
        &lt;/dependencies&gt;
    &lt;/dependencyManagement&gt;

&lt;/project&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Gradle dependency version override</div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="grooy">plugins {
	id 'org.springframework.boot' version '{spring-boot-version}'
}

apply plugin:  'io.spring.dependency-management'

dependencyManagement {
  dependencies {
    dependency 'org.opentest4j:openttest4j:1.0.0'
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>After applying Maven or Gradle dependency management configuration, you will then see:</p>
</div>
<div class="listingblock">
<div class="title"><code>$gradlew dependencies</code> OR <code>$mvn dependency:tree</code></div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="text">...
[INFO] +- org.springframework.boot:spring-boot-starter-test:jar:2.6.4:test
...
[INFO] |  |  |  +- org.opentest4j:opentest4j:jar:1.0.0:test
...</code></pre>
</div>
</div>
<div class="paragraph">
<p>For more details on Maven dependency management, refer to
the <a href="https://maven.apache.org/guides/introduction/introduction-to-dependency-mechanism.html">documentation</a>.</p>
</div>
<div class="paragraph">
<p>For more details on Gradle dependency management, please refer to
the <a href="https://docs.gradle.org/current/userguide/core_dependency_management.html">documentation</a></p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sbdg-dependency-exclusions">4.2. Excluding Dependencies</h3>
<div class="paragraph">
<p>Sometimes, though rarely, it may be necessary to exclude a (transitive) dependency included by a Spring Boot,
or Spring Boot for Apache Geode, starter.</p>
</div>
<div class="paragraph">
<p>Perhaps a transitive dependency, such as Apache Log4j or Jackson, is pulled in by an underlying data store dependency,
such as Apache Geode or Redis, when using a starter (for example: <code>spring-boot-starter-data-redis</code>, or <code>spring-geode-starter</code>),
that could cause a conflict with your Spring Boot application. Or, maybe the transitive dependency currently contains
a serious bug or CVE.</p>
</div>
<div class="paragraph">
<p>Either way, you have concluded that it is safe to exclude this (transitive) dependency without adversely affecting
the runtime behavior and correctness of your Spring Boot application.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
You should be absolutely certain that removing the (transitive) dependency, rather than <a href="#sbdg-dependency-version-overrides">overridding</a>
the (transitive) dependency is the correct course of action.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For example, when you include the <code>spring-geode-starter</code> (the base starter of Spring Boot for Apache Geode), you notice
that Apache Lucene is transitively included by <code>org.apache.geode:geode-lucene</code>:</p>
</div>
<div class="listingblock">
<div class="title">Analyzing Dependencies using Gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="text">$ gradlew :spring-geode-starter:dependencies

...
compileClasspath - Compile classpath for source set 'main'.
+--- org.springframework.boot:spring-boot-starter -&gt; 3.0.0-M5
|    +--- org.springframework.boot:spring-boot:3.0.0-M5
|    |    +--- org.springframework:spring-core:6.0.0-M6
...
+--- project :spring-geode
|    +--- project :apache-geode-extensions
|    |    +--- org.apache.geode:geode-core:1.15.0
|    |    |    +--- antlr:antlr:2.7.7
...
|    |    +--- org.apache.geode:geode-lucene:1.15.0
|    |    |    +--- org.apache.geode:geode-core:1.15.0 (*)
|    |    |    \--- org.apache.lucene:lucene-core:6.6.6
...
|    |    \--- org.apache.geode:geode-wan:1.15.0
...</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Analyzing Dependencies using Maven</div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="txt">$ mvn dependency:tree

...
[INFO] --- maven-dependency-plugin:3.3.0:tree (default-cli) @ spring-geode-app ---
[INFO] org.example.app:spring-geode-app:jar:0.0.1-SNAPSHOT
[INFO] +- org.springframework.geode:spring-geode-starter:jar:1.7.4:compile
[INFO] |  +- org.springframework.boot:spring-boot-starter:jar:2.7.1:compile
[INFO] |  |  +- org.springframework.boot:spring-boot:jar:2.7.1:compile
...
[INFO] |  +- org.springframework.geode:spring-geode:jar:1.7.4:compile
[INFO] |  |  +- org.springframework.data:spring-data-geode:jar:2.7.1:compile
[INFO] |  |  |  +- org.apache.geode:geode-core:jar:1.14.4:compile
...
[INFO] |  |  |  +- org.apache.geode:geode-lucene:jar:1.14.4:compile
[INFO] |  |  |  |  +- org.apache.lucene:lucene-core:jar:6.6.6:compile
[INFO] |  |  |  |  +- org.apache.geode:geode-gfsh:jar:1.14.4:runtime
[INFO] |  |  |  |  +- org.apache.lucene:lucene-analyzers-common:jar:6.6.6:runtime
[INFO] |  |  |  |  +- org.apache.lucene:lucene-queryparser:jar:6.6.6:runtime
[INFO] |  |  |  |  |  \- org.apache.lucene:lucene-queries:jar:6.6.6:runtime
[INFO] |  |  |  |  +- mx4j:mx4j:jar:3.0.2:runtime
[INFO] |  |  |  |  \- org.apache.lucene:lucene-analyzers-phonetic:jar:6.6.6:runtime
[INFO] |  |  |  |     \- commons-codec:commons-codec:jar:1.15:runtime
...
[INFO] |  |  |  +- org.apache.geode:geode-wan:jar:1.14.4:compile</code></pre>
</div>
</div>
<div class="paragraph">
<p>However, you do not have any "search" use cases in your Spring Boot application that would require Apache Geode&#8217;s
integration with Apache Lucene.</p>
</div>
<div class="paragraph">
<p>Using your build tool, such as Gradle or Maven, you can add an exclusion on the <code>org.apache.geode:geode-lucene</code>
transitive dependency pulled in and included by Spring Boot for Apache Geode&#8217;s <code>spring-geode-starter</code>, like so:</p>
</div>
<div class="listingblock">
<div class="title">Declaring Exclusions with Gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="groovy">implementation("org.springframework.geode:spring-geode-starter:{version}") {
  exclude group: "org.apache.geode", module: "geode-lucene"
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Declaring Exclusions with Maven</div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;pom&gt;
  &lt;dependencies&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;org.springframework.geode&lt;/groupId&gt;
      &lt;artifactId&gt;spring-geode-starter&lt;/artifactId&gt;
      &lt;version&gt;{version}&lt;/version&gt;
      &lt;exclusions&gt;
        &lt;exclusion&gt;
          &lt;groupId&gt;org.apache.geode&lt;/groupId&gt;
          &lt;artifactId&gt;geode-lucene&lt;/artifactId&gt;
        &lt;/exclusion&gt;
      &lt;/exclusions&gt;
    &lt;/dependency&gt;
  &lt;/dependencies&gt;
&lt;/pom&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>After the appropriate exclusion is declared, the resulting dependencies (or dependency tree) should look like
the following:</p>
</div>
<div class="listingblock">
<div class="title">Analyzing Dependencies using Gradle after Exclusions</div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="text">$ gradlew :spring-geode-starter:dependencies

...
compileClasspath - Compile classpath for source set 'main'.
+--- org.springframework.boot:spring-boot-starter -&gt; 3.0.0-M5
|    +--- org.springframework.boot:spring-boot:3.0.0-M5
|    |    +--- org.springframework:spring-core:6.0.0-M6
...
+--- project :spring-geode
|    +--- project :apache-geode-extensions
|    |    +--- org.apache.geode:geode-core:1.15.0
|    |    |    +--- antlr:antlr:2.7.7
...
|    |    \--- org.apache.geode:geode-wan:1.15.0
...</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Analyzing Dependencies using Maven</div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="txt">$ mvn dependency:tree

...
[INFO] --- maven-dependency-plugin:3.3.0:tree (default-cli) @ spring-geode-app ---
[INFO] org.example.app:spring-geode-app:jar:0.0.1-SNAPSHOT
[INFO] +- org.springframework.geode:spring-geode-starter:jar:1.7.4:compile
[INFO] |  +- org.springframework.boot:spring-boot-starter:jar:2.7.1:compile
[INFO] |  |  +- org.springframework.boot:spring-boot:jar:2.7.1:compile
...
[INFO] |  +- org.springframework.geode:spring-geode:jar:1.7.4:compile
[INFO] |  |  +- org.springframework.data:spring-data-geode:jar:2.7.1:compile
[INFO] |  |  |  +- org.apache.geode:geode-core:jar:1.14.4:compile
...
[INFO] |  |  |  +- org.apache.geode:geode-wan:jar:1.14.4:compile</code></pre>
</div>
</div>
<div class="paragraph">
<p>Again, it cannot be overstated the importance of being careful when declaring exclusions.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Please refer to the appropriate documentation in
<a href="https://maven.apache.org/guides/introduction/introduction-to-optional-and-excludes-dependencies.html">Maven</a>
and <a href="https://docs.gradle.org/current/userguide/dependency_downgrade_and_exclude.html">Gradle</a> to declare exclusions.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="geode-clientcache-applications">5. Building <code>ClientCache</code> Applications</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The first opinionated option provided to you by Spring Boot for Apache Geode (SBDG) is a
<a href="https://geode.apache.org/releases/latest/javadoc/org/apache/geode/cache/client/ClientCache.html"><code>ClientCache</code></a> instance
that you get by declaring Spring Boot for Apache Geode on your application classpath.</p>
</div>
<div class="paragraph">
<p>It is assumed that most application developers who use Spring Boot to build applications backed by Apache Geode
are building cache client applications deployed in an Apache Geode
<a href="https://geode.apache.org/docs/guide/{apache-geode-doc-version}/topologies_and_comm/cs_configuration/chapter_overview.html">Client/Server Topology</a>.
The client/server topology is the most common and traditional architecture employed by enterprise applications
that use Apache Geode.</p>
</div>
<div class="paragraph">
<p>For example, you can begin building a Spring Boot Apache Geode <code>ClientCache</code> application by declaring the
<code>spring-geode-starter</code> on your application&#8217;s classpath:</p>
</div>
<div class="exampleblock">
<div class="title">Example 8. Spring Boot for Apache Geode on the application classpath</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.springframework.geode&lt;/groupId&gt;
  &lt;artifactId&gt;spring-geode-starter&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Then you configure and bootstrap your Spring Boot, Apache Geode <code>ClientCache</code> application with the following
main application class:</p>
</div>
<div class="exampleblock">
<div class="title">Example 9. Spring Boot, Apache Geode <code>ClientCache</code> Application</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@SpringBootApplication
public class SpringBootApacheGeodeClientCacheApplication {

    public static void main(String[] args) {
        SpringApplication.run(SpringBootApacheGeodeClientCacheApplication.class, args);
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Your application now has a <code>ClientCache</code> instance that can connect to an Apache Geode server running on <code>localhost</code>
and listening on the default <code>CacheServer</code> port, <code>40404</code>.</p>
</div>
<div class="paragraph">
<p>By default, an Apache Geode server (that is, <code>CacheServer</code>) must be running for the application to use the <code>ClientCache</code>
instance. However, it is perfectly valid to create a <code>ClientCache</code> instance and perform data access operations by using
<code>LOCAL</code> Regions. This is useful during development.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
To develop with <code>LOCAL</code> Regions, configure your cache Regions with the
<a href="https://geode.apache.org/releases/latest/javadoc/org/apache/geode/cache/client/ClientRegionShortcut.html#LOCAL"><code>ClientRegionShortcut.LOCAL</code></a>
data management policy.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When you are ready to switch from your local development environment (IDE) to a client/server architecture in a managed
environment, change the data management policy of the client Region from <code>LOCAL</code> back to the default (<code>PROXY</code>)
or even a <code>CACHING_PROXY</code>, which causes the data to be sent to and received from one or more servers.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Compare and contrast the preceding configuration with the Spring Data for Apache Geode
<a href="https://docs.spring.io/spring-data/geode/docs/current/reference/html/#bootstrap-annotation-config-geode-applications">approach</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>It is uncommon to ever need a direct reference to the <code>ClientCache</code> instance provided by SBDG injected into your
application components (for example, <code>@Service</code> or <code>@Repository</code> beans defined in a Spring <code>ApplicationContext</code>),
whether you are configuring additional Apache Geode objects (Regions, Indexes, and so on) or are using those objects
indirectly in your applications. However, it is possible to do so if and when needed.</p>
</div>
<div class="paragraph">
<p>For example, perhaps you want to perform some additional <code>ClientCache</code> initialization in a Spring Boot
<a href="https://docs.spring.io/spring-boot/docs/current/api/org/springframework/boot/ApplicationRunner.html"><code>ApplicationRunner</code></a> on startup:</p>
</div>
<div class="exampleblock">
<div class="title">Example 10. Injecting a <code>GemFireCache</code> reference</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@SpringBootApplication
public class SpringBootApacheGeodeClientCacheApplication {

    public static void main(String[] args) {
        SpringApplication.run(SpringBootApacheGeodeClientCacheApplication.class, args);
    }

    @Bean
    ApplicationRunner runAdditionalClientCacheInitialization(GemFireCache gemfireCache) {

        return args -&gt; {

            ClientCache clientCache = (ClientCache) gemfireCache;

            // perform additional ClientCache initialization as needed
        };
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="geode-peercache-applications">5.1. Building Embedded (Peer &amp; Server) Cache Applications</h3>
<div class="paragraph">
<p>What if you want to build an embedded peer <code>Cache</code> application instead?</p>
</div>
<div class="paragraph">
<p>Perhaps you need an actual peer cache member, configured and bootstrapped with Spring Boot, along with the ability
to join this member to an existing cluster (of data servers) as a peer node.</p>
</div>
<div class="paragraph">
<p>Remember the second goal in Spring Boot&#8217;s <a href="https://docs.spring.io/spring-boot/docs/current/reference/html/#getting-started-introducing-spring-boot">documentation</a>:</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Be opinionated out of the box but get out of the way quickly as requirements start to diverge from the defaults.</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>Here, we focus on the second part of the goal: "<em>get out of the way quickly as requirements start to diverge
from the defaults</em>".</p>
</div>
<div class="paragraph">
<p>If your application requirements demand you use Spring Boot to configure and bootstrap an embedded peer <code>Cache</code> instance,
declare your intention with either SDG&#8217;s
<a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/PeerCacheApplication.html"><code>@PeerCacheApplication</code></a> annotation,
or, if you also need to enable connections from <code>ClientCache</code> applications, use SDG&#8217;s
<a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/CacheServerApplication.html"><code>@CacheServerApplication</code></a> annotation:</p>
</div>
<div class="exampleblock">
<div class="title">Example 11. Spring Boot, Apache Geode <code>CacheServer</code> Application</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@SpringBootApplication
@CacheServerApplication(name = "SpringBootApacheGeodeCacheServerApplication")
public class SpringBootApacheGeodeCacheServerApplication {

    public static void main(String[] args) {
        SpringApplication.run(SpringBootApacheGeodeCacheServerApplication.class, args);
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
An Apache Geode server is not necessarily a <code>CacheServer</code> capable of serving cache clients. It is merely a peer
member node in an Apache Geode cluster (that is, a distributed system) that stores and manages data.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>By explicitly declaring the <code>@CacheServerApplication</code> annotation, you tell Spring Boot that you do not want the default
<code>ClientCache</code> instance but rather want an embedded peer <code>Cache</code> instance with a <code>CacheServer</code> component, which enables
connections from <code>ClientCache</code> applications.</p>
</div>
<div class="paragraph">
<p>You can also enable two other Apache Geode services:
* An embedded <em>Locator</em>, which allows clients or even other peers to locate servers in the cluster.
* An embedded <em>Manager</em>, which allows the Apache Geode application process to be managed and monitored by using
<a href="https://geode.apache.org/docs/guide/{apache-geode-doc-version}/tools_modules/gfsh/chapter_overview.html">Gfsh</a>, Apache Geode&#8217;s command-line shell tool:</p>
</div>
<div class="exampleblock">
<div class="title">Example 12. Spring Boot Apache Geode <code>CacheServer</code> Application with <em>Locator</em> and <em>Manager</em> services enabled</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@SpringBootApplication
@CacheServerApplication(name = "SpringBootApacheGeodeCacheServerApplication")
@EnableLocator
@EnableManager
public class SpringBootApacheGeodeCacheServerApplication {

    public static void main(String[] args) {
        SpringApplication.run(SpringBootApacheGeodeCacheServerApplication.class, args);
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Then you can use Gfsh to connect to and manage this server:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="text">$ echo $GEMFIRE
/Users/jblum/pivdev/apache-geode-1.2.1

$ gfsh
    _________________________     __
   / _____/ ______/ ______/ /____/ /
  / /  __/ /___  /_____  / _____  /
 / /__/ / ____/  _____/ / /    / /
/______/_/      /______/_/    /_/    1.2.1

Monitor and Manage Apache Geode

gfsh&gt;connect
Connecting to Locator at [host=localhost, port=10334] ..
Connecting to Manager at [host=10.0.0.121, port=1099] ..
Successfully connected to: [host=10.0.0.121, port=1099]


gfsh&gt;list members
                   Name                     | Id
------------------------------------------- | --------------------------------------------------------------------------
SpringBootApacheGeodeCacheServerApplication | 10.0.0.121(SpringBootApacheGeodeCacheServerApplication:29798)&lt;ec&gt;&lt;v0&gt;:1024


gfsh&gt;describe member --name=SpringBootApacheGeodeCacheServerApplication
Name        : SpringBootApacheGeodeCacheServerApplication
Id          : 10.0.0.121(SpringBootApacheGeodeCacheServerApplication:29798)&lt;ec&gt;&lt;v0&gt;:1024
Host        : 10.0.0.121
Regions     :
PID         : 29798
Groups      :
Used Heap   : 168M
Max Heap    : 3641M
Working Dir : /Users/jblum/pivdev/spring-boot-data-geode/spring-geode-docs/build
Log file    : /Users/jblum/pivdev/spring-boot-data-geode/spring-geode-docs/build
Locators    : localhost[10334]

Cache Server Information
Server Bind              :
Server Port              : 40404
Running                  : true
Client Connections       : 0</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>You can even start additional servers in Gfsh. These additional servers connect to your Spring Boot configured
and bootstrapped  Apache Geode <code>CacheServer</code> application. These additional servers started in Gfsh know about
the Spring Boot, Apache Geode server because of the embedded Locator service, which is running on <code>localhost</code>
and listening on the default Locator port, <code>10334</code>:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="text">gfsh&gt;start server --name=GfshServer --log-level=config --disable-default-server
Starting a Geode Server in /Users/jblum/pivdev/lab/GfshServer...
...
Server in /Users/jblum/pivdev/lab/GfshServer on 10.0.0.121 as GfshServer is currently online.
Process ID: 30031
Uptime: 3 seconds
Geode Version: 1.2.1
Java Version: 1.8.0_152
Log File: /Users/jblum/pivdev/lab/GfshServer/GfshServer.log
JVM Arguments: -Dgemfire.default.locators=10.0.0.121:127.0.0.1[10334] -Dgemfire.use-cluster-configuration=true -Dgemfire.start-dev-rest-api=false -Dgemfire.log-level=config -XX:OnOutOfMemoryError=kill -KILL %p -Dgemfire.launcher.registerSignalHandlers=true -Djava.awt.headless=true -Dsun.rmi.dgc.server.gcInterval=9223372036854775806
Class-Path: /Users/jblum/pivdev/apache-geode-1.2.1/lib/geode-core-1.2.1.jar:/Users/jblum/pivdev/apache-geode-1.2.1/lib/geode-dependencies.jar


gfsh&gt;list members
                   Name                     | Id
------------------------------------------- | --------------------------------------------------------------------------
SpringBootApacheGeodeCacheServerApplication | 10.0.0.121(SpringBootApacheGeodeCacheServerApplication:29798)&lt;ec&gt;&lt;v0&gt;:1024
GfshServer                                  | 10.0.0.121(GfshServer:30031)&lt;v1&gt;:1025</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Perhaps you want to start the other way around. You may need to connect a Spring Boot configured and bootstrapped
Apache Geode server application to an existing cluster. You can start the cluster in Gfsh with the following commands
(shown with partial typical output):</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="text">gfsh&gt;start locator --name=GfshLocator --port=11235 --log-level=config
Starting a Geode Locator in /Users/jblum/pivdev/lab/GfshLocator...
...
Locator in /Users/jblum/pivdev/lab/GfshLocator on 10.0.0.121[11235] as GfshLocator is currently online.
Process ID: 30245
Uptime: 3 seconds
Geode Version: 1.2.1
Java Version: 1.8.0_152
Log File: /Users/jblum/pivdev/lab/GfshLocator/GfshLocator.log
JVM Arguments: -Dgemfire.log-level=config -Dgemfire.enable-cluster-configuration=true -Dgemfire.load-cluster-configuration-from-dir=false -Dgemfire.launcher.registerSignalHandlers=true -Djava.awt.headless=true -Dsun.rmi.dgc.server.gcInterval=9223372036854775806
Class-Path: /Users/jblum/pivdev/apache-geode-1.2.1/lib/geode-core-1.2.1.jar:/Users/jblum/pivdev/apache-geode-1.2.1/lib/geode-dependencies.jar

Successfully connected to: JMX Manager [host=10.0.0.121, port=1099]

Cluster configuration service is up and running.


gfsh&gt;start server --name=GfshServer --log-level=config --disable-default-server
Starting a Geode Server in /Users/jblum/pivdev/lab/GfshServer...
....
Server in /Users/jblum/pivdev/lab/GfshServer on 10.0.0.121 as GfshServer is currently online.
Process ID: 30270
Uptime: 4 seconds
Geode Version: 1.2.1
Java Version: 1.8.0_152
Log File: /Users/jblum/pivdev/lab/GfshServer/GfshServer.log
JVM Arguments: -Dgemfire.default.locators=10.0.0.121[11235] -Dgemfire.use-cluster-configuration=true -Dgemfire.start-dev-rest-api=false -Dgemfire.log-level=config -XX:OnOutOfMemoryError=kill -KILL %p -Dgemfire.launcher.registerSignalHandlers=true -Djava.awt.headless=true -Dsun.rmi.dgc.server.gcInterval=9223372036854775806
Class-Path: /Users/jblum/pivdev/apache-geode-1.2.1/lib/geode-core-1.2.1.jar:/Users/jblum/pivdev/apache-geode-1.2.1/lib/geode-dependencies.jar


gfsh&gt;list members
   Name     | Id
----------- | --------------------------------------------------
GfshLocator | 10.0.0.121(GfshLocator:30245:locator)&lt;ec&gt;&lt;v0&gt;:1024
GfshServer  | 10.0.0.121(GfshServer:30270)&lt;v1&gt;:1025</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Then modify the <code>SpringBootApacheGeodeCacheServerApplication</code> class to connect to the existing cluster:</p>
</div>
<div class="exampleblock">
<div class="title">Example 13. Spring Boot Apache Geode <code>CacheServer</code> Application connecting to an external cluster</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@SpringBootApplication
@CacheServerApplication(name = "SpringBootApacheGeodeCacheServerApplication", locators = "localhost[11235]")
public class SpringBootApacheGeodeCacheServerApplication {

    public static void main(String[] args) {
        SpringApplication.run(SpringBootApacheGeodeClientCacheApplication.class, args);
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Notice that the <code>SpringBootApacheGeodeCacheServerApplication</code> class, <code>@CacheServerApplication</code> annotation&#8217;s
<code>locators</code> property are configured with the host and port (<code>localhost[11235]</code>), on which the Locator was started
by using Gfsh.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>After running your Spring Boot Apache Geode <code>CacheServer</code> application again and executing the <code>list members</code> command
in Gfsh again, you should see output similar to the following:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="text">gfsh&gt;list members
                   Name                     | Id
------------------------------------------- | ----------------------------------------------------------------------
GfshLocator                                 | 10.0.0.121(GfshLocator:30245:locator)&lt;ec&gt;&lt;v0&gt;:1024
GfshServer                                  | 10.0.0.121(GfshServer:30270)&lt;v1&gt;:1025
SpringBootApacheGeodeCacheServerApplication | 10.0.0.121(SpringBootApacheGeodeCacheServerApplication:30279)&lt;v2&gt;:1026


gfsh&gt;describe member --name=SpringBootApacheGeodeCacheServerApplication
Name        : SpringBootApacheGeodeCacheServerApplication
Id          : 10.0.0.121(SpringBootApacheGeodeCacheServerApplication:30279)&lt;v2&gt;:1026
Host        : 10.0.0.121
Regions     :
PID         : 30279
Groups      :
Used Heap   : 165M
Max Heap    : 3641M
Working Dir : /Users/jblum/pivdev/spring-boot-data-geode/spring-geode-docs/build
Log file    : /Users/jblum/pivdev/spring-boot-data-geode/spring-geode-docs/build
Locators    : localhost[11235]

Cache Server Information
Server Bind              :
Server Port              : 40404
Running                  : true
Client Connections       : 0</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>In both scenarios, the Spring Boot configured and bootstrapped Apache Geode server, the Gfsh Locator and Gfsh server
formed a cluster.</p>
</div>
<div class="paragraph">
<p>While you can use either approach and Spring does not care, it is far more convenient to use Spring Boot and your IDE
to form a small cluster while developing. Spring profiles make it far simpler and much faster to configure and start
a small cluster.</p>
</div>
<div class="paragraph">
<p>Also, this approach enables rapidly prototyping, testing, and debugging your entire end-to-end application
and system architecture right from the comfort and familiarity of your IDE. No additional tooling (such as Gfsh)
or knowledge is required to get started quickly and easily. Just build and run.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Be careful to vary your port numbers for the embedded services, like the <code>CacheServer</code>, Locators, and the Manager,
especially if you start multiple instances on the same machine. Otherwise, you are likely to run into
a <code>java.net.BindException</code> caused by port conflicts.
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
See the <a href="#geode-cluster-configuration-bootstrapping">Running an Apache Geode cluster with Spring Boot from your IDE</a> appendix for more details.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="geode-locator-applications">5.2. Building Locator Applications</h3>
<div class="paragraph">
<p>In addition to <code>ClientCache</code>, <code>CacheServer</code>, and peer <code>Cache</code> applications, SDG, and by extension SBDG, now supports
Spring Boot Apache Geode Locator applications.</p>
</div>
<div class="paragraph">
<p>An Apache Geode Locator is a location-based service or, more typically, a standalone process that lets clients locate
a cluster of Apache Geode servers to manage data. Many cache clients can connect to the same cluster to share data.
Running multiple clients is common in a Microservices architecture where you need to scale-up the number of application
instances to satisfy the demand.</p>
</div>
<div class="paragraph">
<p>An Apache Geode Locator is also used by joining members of an existing cluster to scale-out and increase capacity of
the logically pooled system resources (memory, CPU, network and disk). A Locator maintains metadata that is sent to
the clients to enable such capabilities as single-hop data access to route data access operations to the data node
in the cluster maintaining the data of interests. A Locator also maintains load information for servers in the cluster,
which enables the load to be uniformly distributed across the cluster while also providing fail-over services to a
redundant member if the primary fails. A Locator provides many more benefits, and we encourage you to read the
<a href="https://geode.apache.org/docs/guide/{apache-geode-doc-version}/configuring/running/running_the_locator.html">documentation</a> for more details.</p>
</div>
<div class="paragraph">
<p>As shown earlier, you can embed a Locator service within either a Spring Boot peer <code>Cache</code> or a <code>CacheServer</code>
application by using the SDG <code>@EnableLocator</code> annotation:</p>
</div>
<div class="exampleblock">
<div class="title">Example 14. Embedded Locator Service</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@SpringBootApplication
@CacheServerApplication
@EnableLocator
class SpringBootCacheServerWithEmbeddedLocatorApplication {
	// ...
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>However, it is more common to start standalone Locator JVM processes. This is useful when you want to increase the
resiliency of your cluster in the face of network and process failures, which are bound to happen. If a Locator JVM
process crashes or gets severed from the cluster due to a network failure or partition, having multiple Locators
provides a higher degree of availability (HA) through redundancy.</p>
</div>
<div class="paragraph">
<p>Even if all Locators in the cluster go down, the cluster still remains intact. You cannot add more peer members
(that is, scale-up the number of data nodes in the cluster) or connect any more clients, but the cluster is fine.
If all the locators in the cluster go down, it is safe to restart them only after a thorough diagnosis.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Once a client receives metadata about the cluster of servers, all data-access operations are sent directly to
servers in the cluster, not a Locator. Therefore, existing, connected clients remain connected and operable.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To configure and bootstrap Spring Boot Apache Geode Locator applications as standalone JVM processes, use the following
configuration:</p>
</div>
<div class="exampleblock">
<div class="title">Example 15. Standalone Locator Process</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@SpringBootApplication
@LocatorApplication
class SpringBootApacheGeodeLocatorApplication {
	// ...
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Instead of using the <code>@EnableLocator</code> annotation, you now use the <code>@LocatorApplication</code> annotation.</p>
</div>
<div class="paragraph">
<p>The <code>@LocatorApplication</code> annotation works in the same way as the <code>@PeerCacheApplication</code> and <code>@CacheServerApplication</code>
annotations, bootstrapping an Apache Geode process and overriding the default <code>ClientCache</code> instance provided by SBDG.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If your <code>@SpringBootApplication</code> class is annotated with <code>@LocatorApplication</code>, it must be a <code>Locator</code> and not
a <code>ClientCache</code>, <code>CacheServer</code>, or peer <code>Cache</code> application.  If you need the application to function as a peer <code>Cache</code>,
perhaps with embedded <code>CacheServer</code> components and an embedded Locator, you need to follow the approach shown earlier:
using the <code>@EnableLocator</code> annotation with either the <code>@PeerCacheApplication</code> or <code>@CacheServerApplication</code> annotation.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>With our Spring Boot Apache Geode Locator application, we can connect both Spring Boot configured and bootstrapped
peer members (peer <code>Cache</code>, <code>CacheServer</code> and <code>Locator</code> applications) as well as Gfsh started Locators and servers.</p>
</div>
<div class="paragraph">
<p>First, we need to start two Locators by using our Spring Boot Apache Geode Locator application class:</p>
</div>
<div class="exampleblock">
<div class="title">Example 16. SpringBootApacheGeodeLocatorApplication class</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@UseLocators
@SpringBootApplication
@LocatorApplication(name = "SpringBootApacheGeodeLocatorApplication")
public class SpringBootApacheGeodeLocatorApplication {

	public static void main(String[] args) {

		new SpringApplicationBuilder(SpringBootApacheGeodeLocatorApplication.class)
			.web(WebApplicationType.NONE)
			.build()
			.run(args);

		System.err.println("Press &lt;enter&gt; to exit!");

		new Scanner(System.in).nextLine();
	}

	@Configuration
	@EnableManager(start = true)
	@Profile("manager")
	@SuppressWarnings("unused")
	static class ManagerConfiguration { }

}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>We also need to vary the configuration for each Locator application instance.</p>
</div>
<div class="paragraph">
<p>Apache Geode requires each peer member in the cluster to be uniquely named. We can set the name of the Locator by using
the <code>spring.data.gemfire.locator.name</code> SDG property set as a JVM System Property in your IDE&#8217;s run configuration profile
for the main application class: <code>-Dspring.data.gemfire.locator.name=SpringLocatorOne</code>. We name the second Locator
application instance <code>SpringLocatorTwo</code>.</p>
</div>
<div class="paragraph">
<p>Additionally, we must vary the port numbers that the Locators use to listen for connections. By default, an Apache Geode
Locator listens on port <code>10334</code>. We can set the Locator port by using the <code>spring.data.gemfire.locator.port</code>
SDG property.</p>
</div>
<div class="paragraph">
<p>For our first Locator application instance (<code>SpringLocatorOne</code>), we also enable the "manager" profile so that
we can connect to the Locator by using Gfsh.</p>
</div>
<div class="paragraph">
<p>Our IDE run configuration profile for our first Locator application instance appears as:</p>
</div>
<div class="paragraph">
<p><code>-server -ea -Dspring.profiles.active=manager -Dspring.data.gemfire.locator.name=SpringLocatorOne -Dlogback.log.level=INFO</code></p>
</div>
<div class="paragraph">
<p>And our IDE run configuration profile for our second Locator application instance appears as:</p>
</div>
<div class="paragraph">
<p><code>-server -ea -Dspring.profiles.active= -Dspring.data.gemfire.locator.name=SpringLocatorTwo -Dspring.data.gemfire.locator.port=11235 -Dlogback.log.level=INFO</code></p>
</div>
<div class="paragraph">
<p>You should see log output similar to the following when you start a Locator application instance:</p>
</div>
<div class="exampleblock">
<div class="title">Example 17. Spring Boot Apache Geode Locator log output</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="txt">  .   ____          _            __ _ _
 /\\ / ___'_ __ _ _(_)_ __  __ _ \ \ \ \
( ( )\___ | '_ | '_| | '_ \/ _` | \ \ \ \
 \\/  ___)| |_)| | | | | || (_| |  ) ) ) )
  '  |____| .__|_| |_|_| |_\__, | / / / /
 =========|_|==============|___/=/_/_/_/
 :: Spring Boot ::  (v2.2.0.BUILD-SNAPSHOT)

2019-09-01 11:02:48,707  INFO .SpringBootApacheGeodeLocatorApplication:  55 - Starting SpringBootApacheGeodeLocatorApplication on jblum-mbpro-2.local with PID 30077 (/Users/jblum/pivdev/spring-boot-data-geode/spring-geode-docs/out/production/classes started by jblum in /Users/jblum/pivdev/spring-boot-data-geode/spring-geode-docs/build)
2019-09-01 11:02:48,711  INFO .SpringBootApacheGeodeLocatorApplication: 651 - No active profile set, falling back to default profiles: default
2019-09-01 11:02:49,374  INFO xt.annotation.ConfigurationClassEnhancer: 355 - @Bean method LocatorApplicationConfiguration.exclusiveLocatorApplicationBeanFactoryPostProcessor is non-static and returns an object assignable to Spring's BeanFactoryPostProcessor interface. This will result in a failure to process annotations such as @Autowired, @Resource and @PostConstruct within the method's declaring @Configuration class. Add the 'static' modifier to this method to avoid these container lifecycle issues; see @Bean javadoc for complete details.
2019-09-01 11:02:49,919  INFO ode.distributed.internal.InternalLocator: 530 - Starting peer location for Distribution Locator on 10.99.199.24[11235]
2019-09-01 11:02:49,925  INFO ode.distributed.internal.InternalLocator: 498 - Starting Distribution Locator on 10.99.199.24[11235]
2019-09-01 11:02:49,926  INFO distributed.internal.tcpserver.TcpServer: 242 - Locator was created at Sun Sep 01 11:02:49 PDT 2019
2019-09-01 11:02:49,927  INFO distributed.internal.tcpserver.TcpServer: 243 - Listening on port 11235 bound on address 0.0.0.0/0.0.0.0
2019-09-01 11:02:49,928  INFO ternal.membership.gms.locator.GMSLocator: 162 - GemFire peer location service starting.  Other locators: localhost[10334]  Locators preferred as coordinators: true  Network partition detection enabled: true  View persistence file: /Users/jblum/pivdev/spring-boot-data-geode/spring-geode-docs/build/locator11235view.dat
2019-09-01 11:02:49,928  INFO ternal.membership.gms.locator.GMSLocator: 416 - Peer locator attempting to recover from localhost/127.0.0.1:10334
2019-09-01 11:02:49,963  INFO ternal.membership.gms.locator.GMSLocator: 422 - Peer locator recovered initial membership of View[10.99.199.24(SpringLocatorOne:30043:locator)&lt;ec&gt;&lt;v0&gt;:41000|0] members: [10.99.199.24(SpringLocatorOne:30043:locator)&lt;ec&gt;&lt;v0&gt;:41000]
2019-09-01 11:02:49,963  INFO ternal.membership.gms.locator.GMSLocator: 407 - Peer locator recovered state from LocatorAddress [socketInetAddress=localhost/127.0.0.1:10334, hostname=localhost, isIpString=false]
2019-09-01 11:02:49,965  INFO ode.distributed.internal.InternalLocator: 644 - Starting distributed system
2019-09-01 11:02:50,007  INFO he.geode.internal.logging.LoggingSession:  82 -
---------------------------------------------------------------------------

  Licensed to the Apache Software Foundation (ASF) under one or more
  contributor license agreements.  See the NOTICE file distributed with this
  work for additional information regarding copyright ownership.

  The ASF licenses this file to You under the Apache License, Version 2.0
  (the "License"); you may not use this file except in compliance with the
  License.  You may obtain a copy of the License at

  https://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
  WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.  See the
  License for the specific language governing permissions and limitations
  under the License.

---------------------------------------------------------------------------
Build-Date: 2019-04-19 11:49:13 -0700
Build-Id: onichols 0
Build-Java-Version: 1.8.0_192
Build-Platform: Mac OS X 10.14.4 x86_64
Product-Name: Apache Geode
Product-Version: 1.9.0
Source-Date: 2019-04-19 11:11:31 -0700
Source-Repository: release/1.9.0
Source-Revision: c0a73d1cb84986d432003bd12e70175520e63597
Native version: native code unavailable
Running on: 10.99.199.24/10.99.199.24, 8 cpu(s), x86_64 Mac OS X 10.13.6
Communications version: 100
Process ID: 30077
User: jblum
Current dir: /Users/jblum/pivdev/spring-boot-data-geode/spring-geode-docs/build
Home dir: /Users/jblum
Command Line Parameters:
  -ea
  -Dspring.profiles.active=
  -Dspring.data.gemfire.locator.name=SpringLocatorTwo
  -Dspring.data.gemfire.locator.port=11235
  -Dlogback.log.level=INFO
  -javaagent:/Applications/IntelliJ IDEA 19 CE.app/Contents/lib/idea_rt.jar=51961:/Applications/IntelliJ IDEA 19 CE.app/Contents/bin
  -Dfile.encoding=UTF-8
Class Path:
...
..
.
2019-09-01 11:02:54,112  INFO ode.distributed.internal.InternalLocator: 661 - Locator started on 10.99.199.24[11235]
2019-09-01 11:02:54,113  INFO ode.distributed.internal.InternalLocator: 769 - Starting server location for Distribution Locator on 10.99.199.24[11235]
2019-09-01 11:02:54,134  INFO nt.internal.locator.wan.LocatorDiscovery: 138 - Locator discovery task exchanged locator information 10.99.199.24[11235] with localhost[10334]: {-1=[10.99.199.24[10334]]}.
2019-09-01 11:02:54,242  INFO .SpringBootApacheGeodeLocatorApplication:  61 - Started SpringBootApacheGeodeLocatorApplication in 6.137470354 seconds (JVM running for 6.667)
Press &lt;enter&gt; to exit!</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Next, start up the second Locator application instance (you should see log output similar to the preceding list).
Then connect to the cluster of Locators by using Gfsh:</p>
</div>
<div class="exampleblock">
<div class="title">Example 18. Cluster of Locators</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="txt">$ echo $GEMFIRE
/Users/jblum/pivdev/apache-geode-1.9.0

$ gfsh
    _________________________     __
   / _____/ ______/ ______/ /____/ /
  / /  __/ /___  /_____  / _____  /
 / /__/ / ____/  _____/ / /    / /
/______/_/      /______/_/    /_/    1.9.0

Monitor and Manage Apache Geode

gfsh&gt;connect
Connecting to Locator at [host=localhost, port=10334] ..
Connecting to Manager at [host=10.99.199.24, port=1099] ..
Successfully connected to: [host=10.99.199.24, port=1099]

gfsh&gt;list members
      Name       | Id
---------------- | ------------------------------------------------------------------------
SpringLocatorOne | 10.99.199.24(SpringLocatorOne:30043:locator)&lt;ec&gt;&lt;v0&gt;:41000 [Coordinator]
SpringLocatorTwo | 10.99.199.24(SpringLocatorTwo:30077:locator)&lt;ec&gt;&lt;v1&gt;:41001</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>By using our <code>SpringBootApacheGeodeCacheServerApplication</code> main class from the previous section, we can configure
and bootstrap an Apache Geode <code>CacheServer</code> application with Spring Boot and connect it to our cluster of Locators:</p>
</div>
<div class="exampleblock">
<div class="title">Example 19. SpringBootApacheGeodeCacheServerApplication class</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@SpringBootApplication
@CacheServerApplication(name = "SpringBootApacheGeodeCacheServerApplication")
@SuppressWarnings("unused")
public class SpringBootApacheGeodeCacheServerApplication {

	public static void main(String[] args) {

		new SpringApplicationBuilder(SpringBootApacheGeodeCacheServerApplication.class)
			.web(WebApplicationType.NONE)
			.build()
			.run(args);
	}

	@Configuration
	@UseLocators
	@Profile("clustered")
	static class ClusteredConfiguration { }

	@Configuration
	@EnableLocator
	@EnableManager(start = true)
	@Profile("!clustered")
	static class LonerConfiguration { }

}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>To do so, enable the "clustered" profile by using an IDE run profile configuration similar to:</p>
</div>
<div class="paragraph">
<p><code>-server -ea -Dspring.profiles.active=clustered -Dspring.data.gemfire.name=SpringServer -Dspring.data.gemfire.cache.server.port=41414 -Dlogback.log.level=INFO</code></p>
</div>
<div class="paragraph">
<p>After the server starts up, you should see the new peer member in the cluster:</p>
</div>
<div class="exampleblock">
<div class="title">Example 20. Cluster with Spring Boot configured and bootstrapped Apache Geode <code>CacheServer</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="txt">gfsh&gt;list members
      Name       | Id
---------------- | ------------------------------------------------------------------------
SpringLocatorOne | 10.99.199.24(SpringLocatorOne:30043:locator)&lt;ec&gt;&lt;v0&gt;:41000 [Coordinator]
SpringLocatorTwo | 10.99.199.24(SpringLocatorTwo:30077:locator)&lt;ec&gt;&lt;v1&gt;:41001
SpringServer     | 10.99.199.24(SpringServer:30216)&lt;v2&gt;:41002</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Finally, we can even start additional Locators and servers connected to this cluster by using Gfsh:</p>
</div>
<div class="exampleblock">
<div class="title">Example 21. Gfsh started Locators and Servers</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="txt">gfsh&gt;start locator --name=GfshLocator --port=12345 --log-level=config
Starting a Geode Locator in /Users/jblum/pivdev/lab/GfshLocator...
......
Locator in /Users/jblum/pivdev/lab/GfshLocator on 10.99.199.24[12345] as GfshLocator is currently online.
Process ID: 30259
Uptime: 5 seconds
Geode Version: 1.9.0
Java Version: 1.8.0_192
Log File: /Users/jblum/pivdev/lab/GfshLocator/GfshLocator.log
JVM Arguments: -Dgemfire.default.locators=10.99.199.24[11235],10.99.199.24[10334] -Dgemfire.enable-cluster-configuration=true -Dgemfire.load-cluster-configuration-from-dir=false -Dgemfire.log-level=config -Dgemfire.launcher.registerSignalHandlers=true -Djava.awt.headless=true -Dsun.rmi.dgc.server.gcInterval=9223372036854775806
Class-Path: /Users/jblum/pivdev/apache-geode-1.9.0/lib/geode-core-1.9.0.jar:/Users/jblum/pivdev/apache-geode-1.9.0/lib/geode-dependencies.jar

gfsh&gt;start server --name=GfshServer --server-port=45454 --log-level=config
Starting a Geode Server in /Users/jblum/pivdev/lab/GfshServer...
...
Server in /Users/jblum/pivdev/lab/GfshServer on 10.99.199.24[45454] as GfshServer is currently online.
Process ID: 30295
Uptime: 2 seconds
Geode Version: 1.9.0
Java Version: 1.8.0_192
Log File: /Users/jblum/pivdev/lab/GfshServer/GfshServer.log
JVM Arguments: -Dgemfire.default.locators=10.99.199.24[11235],10.99.199.24[12345],10.99.199.24[10334] -Dgemfire.start-dev-rest-api=false -Dgemfire.use-cluster-configuration=true -Dgemfire.log-level=config -XX:OnOutOfMemoryError=kill -KILL %p -Dgemfire.launcher.registerSignalHandlers=true -Djava.awt.headless=true -Dsun.rmi.dgc.server.gcInterval=9223372036854775806
Class-Path: /Users/jblum/pivdev/apache-geode-1.9.0/lib/geode-core-1.9.0.jar:/Users/jblum/pivdev/apache-geode-1.9.0/lib/geode-dependencies.jar

gfsh&gt;list members
      Name       | Id
---------------- | ------------------------------------------------------------------------
SpringLocatorOne | 10.99.199.24(SpringLocatorOne:30043:locator)&lt;ec&gt;&lt;v0&gt;:41000 [Coordinator]
SpringLocatorTwo | 10.99.199.24(SpringLocatorTwo:30077:locator)&lt;ec&gt;&lt;v1&gt;:41001
SpringServer     | 10.99.199.24(SpringServer:30216)&lt;v2&gt;:41002
GfshLocator      | 10.99.199.24(GfshLocator:30259:locator)&lt;ec&gt;&lt;v3&gt;:41003
GfshServer       | 10.99.199.24(GfshServer:30295)&lt;v4&gt;:41004</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>You must be careful to vary the ports and name of your peer members appropriately. Spring, and Spring Boot
for Apache Geode (SBDG) in particular, make doing so easy.</p>
</div>
</div>
<div class="sect2">
<h3 id="geode-manager-applications">5.3. Building Manager Applications</h3>
<div class="paragraph">
<p>As discussed in the previous sections, you can enable a Spring Boot configured and bootstrapped Apache Geode
peer member node in the cluster to function as a Manager.</p>
</div>
<div class="paragraph">
<p>An Apache Geode Manager is a peer member node in the cluster that runs the management service, letting the cluster
be managed and monitored with JMX-based tools, such as Gfsh, JConsole, or JVisualVM. Any tool using the JMX API
can connect to and manage an Apache Geode cluster for whatever purpose.</p>
</div>
<div class="paragraph">
<p>Like Locators, the cluster may have more than one Manager for redundancy.  Only server-side, peer member nodes
in the cluster may function Managers.  Therefore, a <code>ClientCache</code> application cannot be a Manager.</p>
</div>
<div class="paragraph">
<p>To create a Manager, use the SDG <code>@EnableManager</code> annotation.</p>
</div>
<div class="paragraph">
<p>The three primary uses of the <code>@EnableManager</code> annotation to create a Manager are:</p>
</div>
<div class="paragraph">
<p>1 - CacheServer Manager Application</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@SpringBootApplication
@CacheServerApplication(name = "CacheServerManagerApplication")
@EnableManager(start = true)
class CacheServerManagerApplication {
	// ...
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>2 - Peer Cache Manager Application</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@SpringBootApplication
@PeerCacheApplication(name = "PeerCacheManagerApplication")
@EnableManager(start = "true")
class PeerCacheManagerApplication {
	// ...
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>3 - Locator Manager Application</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@SpringBootApplication
@LocatorApplication(name = "LocatorManagerApplication")
@EnableManager(start = true)
class LocatorManagerApplication {
	// ...
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>#1 creates a peer <code>Cache</code> instance with a <code>CacheServer</code> component that accepts client connections along with
an embedded Manager that lets JMX clients connect.</p>
</div>
<div class="paragraph">
<p>#2 creates only a peer <code>Cache</code> instance along with an embedded Manager. As a peer <code>Cache</code> with no <code>CacheServer</code>
component, clients are not able to connect to this node. It is merely a server managing data.</p>
</div>
<div class="paragraph">
<p>#3 creates a Locator instance with an embedded Manager.</p>
</div>
<div class="paragraph">
<p>In all configuration arrangements, the Manager is configured to start immediately.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
See the Javadoc for the
<a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnableManager.html"><code>@EnableManager</code> annotation</a>
for additional configuration options.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>As of Apache Geode 1.11.0, you must include additional Apache Geode dependencies on your Spring Boot application
classpath to make your application a proper Apache Geode Manager in the cluster, particularly if you also enable
the embedded HTTP service in the Manager.</p>
</div>
<div class="paragraph">
<p>The required dependencies are:</p>
</div>
<div class="exampleblock">
<div class="title">Example 22. Additional Manager dependencies expressed in Gradle</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="groovy">runtime "org.apache.geode:geode-http-service"
runtime "org.apache.geode:geode-web"
runtime "org.springframework.boot:spring-boot-starter-jetty"</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The embedded HTTP service (implemented with the Eclipse Jetty Servlet Container), runs the Management (Admin) REST API,
which is used by Apache Geode tooling, such as Gfsh, to connect to an Apache Geode cluster over HTTP. In addition, it
also enables the Apache Geode <a href="https://geode.apache.org/docs/guide/{apache-geode-doc-version}/tools_modules/pulse/pulse-overview.html">Pulse</a> Monitoring Tool
(and Web application) to run.</p>
</div>
<div class="paragraph">
<p>Even if you do not start the embedded HTTP service, a Manager still requires the <code>geode-http-service</code>, <code>geode-web</code>
and <code>spring-boot-starter-jetty</code> dependencies.</p>
</div>
<div class="paragraph">
<p>Optionally, you may also include the <code>geode-pulse</code> dependency, as follows:</p>
</div>
<div class="exampleblock">
<div class="title">Example 23. Additional, optional Manager depdendencies expressed in Gradle</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="groovy">runtime "org.apache.geode:geode-pulse"</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The <code>geode-pulse</code> dependency is only required if you want the Manager to automatically start
the Apache Geode <a href="https://geode.apache.org/docs/guide/{apache-geode-doc-version}/tools_modules/pulse/pulse-overview.html">Pulse</a> Monitoring Tool. Pulse enables you
to view the nodes of your Apache Geode cluster and monitor them in realtime.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="geode-configuration-auto">6. Auto-configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following Spring Framework, Spring Data for Apache Geode (SDG) and Spring Session for Apache Geode (SSDG)
annotations are implicitly declared by Spring Boot for Apache Geode&#8217;s (SBDG) auto-configuration.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>@ClientCacheApplication</code></p>
</li>
<li>
<p><code>@EnableGemfireCaching</code> (alternatively, Spring Framework&#8217;s <code>@EnableCaching</code>)</p>
</li>
<li>
<p><code>@EnableContinuousQueries</code></p>
</li>
<li>
<p><code>@EnableGemfireFunctions</code></p>
</li>
<li>
<p><code>@EnableGemfireFunctionExecutions</code></p>
</li>
<li>
<p><code>@EnableGemfireRepositories</code></p>
</li>
<li>
<p><code>@EnableLogging</code></p>
</li>
<li>
<p><code>@EnablePdx</code></p>
</li>
<li>
<p><code>@EnableSecurity</code></p>
</li>
<li>
<p><code>@EnableSsl</code></p>
</li>
<li>
<p><code>@EnableGemFireHttpSession</code></p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This means that you need not explicitly declare any of these annotations on your <code>@SpringBootApplication</code> class,
since they are provided by SBDG already. The only reason you would explicitly declare any of these annotations is to
override Spring Boot&#8217;s, and in particular, SBDG&#8217;s auto-configuration. Otherwise, doing so is unnecessary.
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
You should read the chapter in Spring Boot&#8217;s reference documentation on
<a href="https://docs.spring.io/spring-boot/docs/current/reference/html/#using-boot-auto-configuration">auto-configuration</a>.
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
You should review the chapter in Spring Data for Apache Geode&#8217;s (SDG) reference documentation
on <a href="https://docs.spring.io/spring-data/geode/docs/current/reference/html/#bootstrap-annotation-config">annotation-based configuration</a>. For a quick reference
and overview of annotation-based configuration, see the
<a href="https://docs.spring.io/spring-data/geode/docs/current/reference/html/#bootstap-annotations-quickstart">annotations quickstart</a>.
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
See the corresponding sample <a href="guides/boot-configuration.html">guide</a> and {github-samples-url}/boot/configuration[code]
to see Spring Boot auto-configuration for Apache Geode in action.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="geode-configuration-auto-customizing">6.1. Customizing Auto-configuration</h3>
<div class="paragraph">
<p>You might ask, &#8220;How do I customize the auto-configuration provided by SBDG if I do not explicitly declare
the annotation?&#8221;</p>
</div>
<div class="paragraph">
<p>For example, you may want to customize the member&#8217;s name.  You know that the
<a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/ClientCacheApplication.html"><code>@ClientCacheApplication</code></a> annotation
provides the <a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnableGemFireProperties.html#name--"><code>name</code></a> attribute
so that you can set the client member&#8217;s name. However, SBDG has already implicitly declared the <code>@ClientCacheApplication</code>
annotation through auto-configuration on your behalf. What do you do?</p>
</div>
<div class="paragraph">
<p>In this case, SBDG supplies a few additional annotations.</p>
</div>
<div class="paragraph">
<p>For example, to set the (client or peer) member&#8217;s name, you can use the <code>@UseMemberName</code> annotation:</p>
</div>
<div class="exampleblock">
<div class="title">Example 24. Setting the member&#8217;s name using <code>@UseMemberName</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@SpringBootApplication
@UseMemberName("MyMemberName")
class SpringBootApacheGeodeClientCacheApplication {
	//...
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Alternatively, you could set the <code>spring.application.name</code> or the <code>spring.data.gemfire.name</code> property in Spring Boot
<code>application.properties</code>:</p>
</div>
<div class="exampleblock">
<div class="title">Example 25. Setting the member&#8217;s name using the <code>spring.application.name</code> property</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="txt"># Spring Boot application.properties

spring.application.name = MyMemberName</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 26. Setting the member&#8217;s name using the <code>spring.data.gemfire.cache.name</code> property</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="txt"># Spring Boot application.properties

spring.data.gemfire.cache.name = MyMemberName</code></pre>
</div>
</div>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <code>spring.data.gemfire.cache.name</code> property is an alias for the <code>spring.data.gemfire.name</code> property. Both
properties do the same thing (set the name of the client or peer member node).
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In general, there are three ways to customize configuration, even in the context of SBDG&#8217;s auto-configuration:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Using <a href="https://docs.spring.io/spring-boot-data-geode-build/current/api//org/springframework/geode/config/annotation/package-summary.html">annotations</a>
provided by SBDG for common and popular concerns (such as naming client or peer members with the <code>@UseMemberName</code>
annotation or enabling durable clients with the <code>@EnableDurableClient</code> annotation).</p>
</li>
<li>
<p>Using well-known and documented <a href="https://docs.spring.io/spring-data/geode/docs/current/reference/html/#bootstrap-annotation-config-properties">properties</a>
(such as <code>spring.application.name</code>, or <code>spring.data.gemfire.name</code>, or <code>spring.data.gemfire.cache.name</code>).</p>
</li>
<li>
<p>Using <a href="https://docs.spring.io/spring-data/geode/docs/current/reference/html/#bootstrap-annotation-config-configurers">configurers</a>
(such as <a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/ClientCacheConfigurer.html"><code>ClientCacheConfigurer</code></a>).</p>
</li>
</ul>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
For the complete list of documented properties, see <a href="#geode-configuration-metadata">Configuration Metadata Reference</a>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="geode-configuration-auto-disabling">6.2. Disabling Auto-configuration</h3>
<div class="paragraph">
<p>Spring Boot&#8217;s reference documentation explains how to
<a href="https://docs.spring.io/spring-boot/docs/current/reference/html/#using-boot-disabling-specific-auto-configuration">disable Spring Boot auto-configuration</a>.</p>
</div>
<div class="paragraph">
<p><a href="#geode-auto-configuration-disable">Disabling Auto-configuration</a> also explains how to disable SBDG auto-configuration.</p>
</div>
<div class="paragraph">
<p>In a nutshell, if you want to disable any auto-configuration provided by either Spring Boot or SBDG, declare your intent
in the <code>@SpringBootApplication</code> annotation:</p>
</div>
<div class="exampleblock">
<div class="title">Example 27. Disabling Specific Auto-configuration Classes</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@SpringBootApplication(
  exclude = { DataSourceAutoConfiguration.class, PdxAutoConfiguration.class }
)
class SpringBootApacheGeodeClientCacheApplication {
	// ...
}</code></pre>
</div>
</div>
</div>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
Make sure you understand what you are doing when you disable auto-configuration.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="geode-configuration-auto-overriding">6.3. Overriding Auto-configuration</h3>
<div class="paragraph">
<p><a href="#geode-autoconfiguration-annotations-overriding">Overriding</a> explains how to override SBDG auto-configuration.</p>
</div>
<div class="paragraph">
<p>In a nutshell, if you want to override the default auto-configuration provided by SBDG, you must annotate your
<code>@SpringBootApplication</code> class with your intent.</p>
</div>
<div class="paragraph">
<p>For example, suppose you want to configure and bootstrap an Apache Geode <code>CacheServer</code> application
(a peer, not a client):</p>
</div>
<div class="exampleblock">
<div class="title">Example 28. Overriding the default <code>ClientCache</code> <em>Auto-Configuration</em> by configuring &amp; bootstrapping a <code>CacheServer</code> application</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@SpringBootApplication
@CacheServerApplication
class SpringBootApacheGeodeCacheServerApplication {
	// ...
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>You can also explicitly declare the <code>@ClientCacheApplication</code> annotation on your <code>@SpringBootApplication</code> class:</p>
</div>
<div class="exampleblock">
<div class="title">Example 29. Overriding by explicitly declaring <code>@ClientCacheApplication</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@SpringBootApplication
@ClientCacheApplication
class SpringBootApacheGeodeClientCacheApplication {
	// ...
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>You are overriding SBDG&#8217;s auto-configuration of the <code>ClientCache</code> instance. As a result, you have now also implicitly
consented to being responsible for other aspects of the configuration (such as security).</p>
</div>
<div class="paragraph">
<p>Why does that happen?</p>
</div>
<div class="paragraph">
<p>It happens because, in certain cases, such as security, certain aspects of security configuration (such as SSL) must be
configured before the cache instance is created. Also, Spring Boot always applies user configuration before
auto-configuration partially to determine what needs to be auto-configured in the first place.</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
Make sure you understand what you are doing when you override auto-configuration.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="geode-configuration-auto-replacing">6.4. Replacing Auto-configuration</h3>
<div class="paragraph">
<p>See the Spring Boot reference documentation on
<a href="https://docs.spring.io/spring-boot/docs/current/reference/html/#using-boot-replacing-auto-configuration">replacing auto-configuration</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="geode-configuration-auto-explained">6.5. Understanding Auto-configuration</h3>
<div class="paragraph">
<p>This section covers the SBDG provided auto-configuration classes that correspond to the SDG annotations in more detail.</p>
</div>
<div class="paragraph">
<p>To review the complete list of SBDG auto-confiugration classes, see <a href="#geode-auto-configuration-disable-classes">Complete Set of Auto-configuration Classes</a>.</p>
</div>
<div class="sect3">
<h4 id="geode-configuration-declarative-auto-configuration-clientcacheapplication">6.5.1. <code>@ClientCacheApplication</code></h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The SBDG <a href="https://docs.spring.io/spring-boot-data-geode-build/current/api//org/springframework/geode/boot/autoconfigure/ClientCacheAutoConfiguration.html"><code>ClientCacheAutoConfiguration</code></a> class
corresponds to the SDG <a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/ClientCacheApplication.html"><code>@ClientCacheApplication</code></a> annotation.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>As explained in <a href="#getting-started">Getting Started</a> SBDG starts with the opinion that application developers primarily build Apache Geode
<a href="#geode-clientcache-applications">client applications</a> by using Spring Boot.</p>
</div>
<div class="paragraph">
<p>Technically, this means building Spring Boot applications with an Apache Geode <code>ClientCache</code> instance connected to
a dedicated cluster of Apache Geode servers that manage the data as part of a
<a href="https://geode.apache.org/docs/guide/{apache-geode-doc-version}/topologies_and_comm/cs_configuration/chapter_overview.html">client/server</a> topology.</p>
</div>
<div class="paragraph">
<p>By way of example, this means that you need not explicitly declare and annotate your <code>@SpringBootApplication</code> class
with SDG&#8217;s <code>@ClientCacheApplication</code> annotation, as the following example shows:</p>
</div>
<div class="exampleblock">
<div class="title">Example 30. Do Not Do This</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@SpringBootApplication
@ClientCacheApplication
class SpringBootApacheGeodeClientCacheApplication {
	// ...
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>SBDG&#8217;s provided auto-configuration class is already meta-annotated with SDG&#8217;s <code>@ClientCacheApplication</code> annotation.
Therefore, you need only do:</p>
</div>
<div class="exampleblock">
<div class="title">Example 31. Do This</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@SpringBootApplication
class SpringBootApacheGeodeClientCacheApplication {
	// ...
}</code></pre>
</div>
</div>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
See SDG&#8217;s reference documentation for more details on Apache Geode
<a href="https://docs.spring.io/spring-data/geode/docs/current/reference/html/#bootstrap-annotation-config-geode-applications">cache applications</a>
and <a href="https://docs.spring.io/spring-data/geode/docs/current/reference/html/#bootstrap-annotation-config-client-server-applications">client/server applications</a>
in particular.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="geode-configuration-declarative-auto-configuration-enablecaching">6.5.2. <code>@EnableGemfireCaching</code></h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The SBDG <a href="https://docs.spring.io/spring-boot-data-geode-build/current/api//org/springframework/geode/boot/autoconfigure/CachingProviderAutoConfiguration.html"><code>CachingProviderAutoConfiguration</code></a> class
corresponds to the SDG <a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/cache/config/EnableGemfireCaching.html"><code>@EnableGemfireCaching</code></a> annotation.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If you used the core Spring Framework to configure Apache Geode as a caching provider in
<a href="https://docs.spring.io/spring/docs/current/spring-framework-reference/integration.html#cache">Spring&#8217;s Cache Abstraction</a>, you need to:</p>
</div>
<div class="exampleblock">
<div class="title">Example 32. Configuring caching using the Spring Framework</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@SpringBootApplication
@EnableCaching
class CachingUsingApacheGeodeConfiguration {

    @Bean
    GemfireCacheManager cacheManager(GemFireCache cache) {

        GemfireCacheManager cacheManager = new GemfireCacheManager();

        cacheManager.setCache(cache);

        return cacheManager;
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>If you use Spring Data for Apache Geode&#8217;s <code>@EnableGemfireCaching</code> annotation, you can simplify the preceding
configuration:</p>
</div>
<div class="exampleblock">
<div class="title">Example 33. Configuring caching using Spring Data for Apache Geode</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@SpringBootApplication
@EnableGemfireCaching
class CachingUsingApacheGeodeConfiguration {

}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Also, if you use SBDG, you need only do:</p>
</div>
<div class="exampleblock">
<div class="title">Example 34. Configuring caching using Spring Boot for Apache Geode</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@SpringBootApplication
class CachingUsingApacheGeodeConfiguration {

}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>This lets you focus on the areas in your application that would benefit from caching without having to enable the
plumbing. You can then demarcate the service methods in your application that are good candidates for caching:</p>
</div>
<div class="exampleblock">
<div class="title">Example 35. Using caching in your application</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Service
class CustomerService {

    @Caching("CustomersByName")
    Customer findBy(String name) {
        // ...
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
See <a href="#geode-caching-provider">documentation on caching</a> for more details.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="geode-configuration-declarative-auto-configuration-enableautocontinuousqueies">6.5.3. <code>@EnableContinuousQueries</code></h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The SBDG <a href="https://docs.spring.io/spring-boot-data-geode-build/current/api//org/springframework/geode/boot/autoconfigure/ContinuousQueryAutoConfiguration.html"><code>ContinuousQueryAutoConfiguration</code></a> class
corresponds to the SDG <a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnableContinuousQueries.html"><code>@EnableContinuousQueries</code></a> annotation.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Without having to enable anything, you can annotate your application (POJO) component method(s) with the SDG
<a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/listener/annotation/ContinuousQuery.html"><code>@ContinuousQuery</code></a>
annotation to register a CQ and start receiving events. The method acts as a <code>CqEvent</code> handler or, in Apache Geode&#8217;s
terminology, the method is an implementation of the
<a href="https://geode.apache.org/releases/latest/javadoc/org/apache/geode/cache/query/CqListener.html"><code>CqListener</code></a> interface.</p>
</div>
<div class="exampleblock">
<div class="title">Example 36. Declare application CQs</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Component
class MyCustomerApplicationContinuousQueries {

    @ContinuousQuery("SELECT customer.* "
        + " FROM /Customers customers"
        + " WHERE customer.getSentiment().name().equalsIgnoreCase('UNHAPPY')")
    public void handleUnhappyCustomers(CqEvent event) {
        // ...
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>As the preceding example shows, you can define the events you are interested in receiving by using an OQL query with a
finely tuned query predicate that describes the events of interests and implements the handler method to process the
events (such as applying a credit to the customer&#8217;s account and following up in email).</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
See <a href="#geode-continuous-query">Continuous Query</a> for more details.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="geode-configuration-declarative-auto-configuration-enablefunctions">6.5.4. <code>@EnableGemfireFunctionExecutions</code> &amp; <code>@EnableGemfireFunctions</code></h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The SBDG <a href="https://docs.spring.io/spring-boot-data-geode-build/current/api//org/springframework/geode/boot/autoconfigure/FunctionExecutionAutoConfiguration.html"><code>FunctionExecutionAutoConfiguration</code></a> class
corresponds to both the SDG <a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/function/config/EnableGemfireFunctionExecutions.html"><code>@EnableGemfireFunctionExecutions</code></a>
and SDG <a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/function/config/EnableGemfireFunctions.html"><code>@EnableGemfireFunctions</code></a> annotations.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Whether you need to <a href="https://docs.spring.io/spring-data/geode/docs/current/reference/html/#function-execution">execute</a>
or <a href="https://docs.spring.io/spring-data/geode/docs/current/reference/html/#function-implementation">implement</a> a <code>Function</code>, SBDG detects the Function definition
and auto-configures it appropriately for use in your Spring Boot application. You need only define the Function
execution or implementation in a package below the main <code>@SpringBootApplication</code> class:</p>
</div>
<div class="exampleblock">
<div class="title">Example 37. Declare a Function Execution</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">package example.app.functions;

@OnRegion("Accounts")
interface MyCustomerApplicationFunctions {

    void applyCredit(Customer customer);

}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Then you can inject the Function execution into any application component and use it:</p>
</div>
<div class="exampleblock">
<div class="title">Example 38. Use the Function</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">package example.app.service;

@Service
class CustomerService {

    @Autowired
    private MyCustomerApplicationFunctions customerFunctions;

    void analyzeCustomerSentiment(Customer customer) {

        // ...

        this.customerFunctions.applyCredit(customer);

        // ...
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The same pattern basically applies to Function implementations, except in the implementation case, SBDG registers
the Function implementation for use (that is, to be called by a Function execution).</p>
</div>
<div class="paragraph">
<p>Doing so lets you focus on defining the logic required by your application and not worry about how Functions
are registered, called, and so on. SBDG handles this concern for you.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Function implementations are typically defined and registered on the server-side.
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
See <a href="#geode-functions">Function Implementations &amp; Executions</a> for more details.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="geode-configuration-declarative-auto-configuration-enablerepositories">6.5.5. <code>@EnableGemfireRepositories</code></h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The SBDG <a href="https://docs.spring.io/spring-boot-data-geode-build/current/api//org/springframework/geode/boot/autoconfigure/GemFireRepositoriesAutoConfigurationRegistrar.html"><code>GemFireRepositoriesAutoConfigurationRegistrar</code></a> class
corresponds to the SDG <a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/repository/config/EnableGemfireRepositories.html"><code>@EnableGemfireRepositories</code></a> annotation.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>As with Functions, you need concern yourself only with the data access operations (such as basic CRUD and simple queries)
required by your application to carry out its operation, not with how to create and perform them (for example,
<code>Region.get(key)</code> and <code>Region.put(key, obj)</code>) or execute them (for example, <code>Query.execute(arguments)</code>).</p>
</div>
<div class="paragraph">
<p>Start by defining your Spring Data Repository:</p>
</div>
<div class="exampleblock">
<div class="title">Example 39. Define an application-specific Repository</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">package example.app.repo;

interface CustomerRepository extends CrudRepository&lt;Customer, Long&gt; {

    List&lt;Customer&gt; findBySentimentEqualTo(Sentiment sentiment);

}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Then you can inject the Repository into an application component and use it:</p>
</div>
<div class="exampleblock">
<div class="title">Example 40. Using the application-specific Repository</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">package example.app.sevice;

@Service
class CustomerService {

    @Autowired
    private CustomerRepository repository;

    public void processCustomersWithSentiment(Sentiment sentiment) {

        this.repository.findBySentimentEqualTo(sentiment)
            .forEach(customer -&gt; { /* ... */ });

        // ...
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Your application-specific Repository simply needs to be declared in a package below the main <code>@SpringBootApplication</code>
class. Again, you are focusing only on the data access operations and queries required to carry out the operatinons
of your application, nothing more.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
See <a href="#geode-repositories">Spring Data Repositories</a> for more details.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="geode-configuration-declarative-auto-configuration-enablelogging">6.5.6. <code>@EnableLogging</code></h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The SBDG <a href="https://docs.spring.io/spring-boot-data-geode-build/current/api//org/springframework/geode/boot/autoconfigure/LoggingAutoConfiguration.html"><code>LoggingAutoConfiguration</code></a> class
corresponds to the SDG <a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnableLogging.html"><code>@EnableLogging</code></a> annotation.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Logging is an essential application concern to understand what is happening in the system along with when and where
the events occurred. By default, SBDG auto-configures logging for Apache Geode with the default log-level, &#8220;config&#8221;.</p>
</div>
<div class="paragraph">
<p>You can change any aspect of logging, such as the log-level, in Spring Boot <code>application.properties</code>:</p>
</div>
<div class="exampleblock">
<div class="title">Example 41. Change the log-level for Apache Geode</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="txt"># Spring Boot application.properites.

spring.data.gemfire.cache.log-level=debug</code></pre>
</div>
</div>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The 'spring.data.gemfire.logging.level' property is an alias for <code>spring.data.gemfire.cache.log-level</code>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can also configure other aspects, such as the log file size and disk space limits for the filesystem location used
to store the Apache Geode log files at runtime.</p>
</div>
<div class="paragraph">
<p>Under the hood, Apache Geode&#8217;s logging is based on Log4j. Therefore, you can configure Apache Geode logging to use any
logging provider (such as Logback) and configuration metadata appropriate for that logging provider so long as you
supply the necessary adapter between Log4j and whatever logging system you use. For instance, if you include
<code>org.springframework.boot:spring-boot-starter-logging</code>, you are using Logback and you will need the
<code>org.apache.logging.log4j:log4j-to-slf4j</code> adapter.</p>
</div>
</div>
<div class="sect3">
<h4 id="geode-configuration-declarative-auto-configuration-enablepdx">6.5.7. <code>@EnablePdx</code></h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The SBDG <a href="https://docs.spring.io/spring-boot-data-geode-build/current/api//org/springframework/geode/boot/autoconfigure/PdxSerializationAutoConfiguration.html"><code>PdxSerializationAutoConfiguration</code></a> class
corresponds to the SDG <a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnablePdx.html"><code>@EnablePdx</code></a> annotation.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Any time you need to send an object over the network or overflow or persist an object to disk, your application domain
model object must be serializable. It would be painful to have to implement <code>java.io.Serializable</code> in every one of your
application domain model objects (such as <code>Customer</code>) that would potentially need to be serialized.</p>
</div>
<div class="paragraph">
<p>Furthermore, using Java Serialization may not be ideal (it may not be the most portable or efficient solution) in all
cases or even possible in other cases (such as when you use a third party library over which you have no control).</p>
</div>
<div class="paragraph">
<p>In these situations, you need to be able to send your object anywhere, anytime without unduly requiring the class type
to be serializable and exist on the classpath in every place it is sent. Indeed, the final destination may not even be
a Java application. This is where Apache Geode
<a href="https://geode.apache.org/docs/guide/{apache-geode-doc-version}/developing/data_serialization/gemfire_pdx_serialization.html">PDX Serialization</a> steps in to help.</p>
</div>
<div class="paragraph">
<p>However, you need not figure out how to configure PDX to identify the application class types that needs to be
serialized. Instead, you can define your class type as follows:</p>
</div>
<div class="exampleblock">
<div class="title">Example 42. Customer class</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Region("Customers")
class Customer {

    @Id
    private Long id;

    @Indexed
    private String name;

    // ...
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>SBDG&#8217;s auto-configuration handles the rest.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
See <a href="#geode-data-serialization">Data Serialization with PDX</a> for more details.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="geode-configuration-declarative-auto-configuration-enablesecurity">6.5.8. <code>@EnableSecurity</code></h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The SBDG <a href="https://docs.spring.io/spring-boot-data-geode-build/current/api//org/springframework/geode/boot/autoconfigure/ClientSecurityAutoConfiguration.html"><code>ClientSecurityAutoConfiguration</code></a> class
and <a href="https://docs.spring.io/spring-boot-data-geode-build/current/api//org/springframework/geode/boot/autoconfigure/PeerSecurityAutoConfiguration.html"><code>PeerSecurityAutoConfiguration</code></a> class
correspond to the SDG <a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnableSecurity.html"><code>@EnableSecurity</code></a> annotation,
but they apply security (specifically, authentication and authorization (auth) configuration) for both clients
and servers.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Configuring your Spring Boot, Apache Geode <code>ClientCache</code> application to properly authenticate with a cluster of secure
Apache Geode servers is as simple as setting a username and a password in Spring Boot <code>application.properties</code>:</p>
</div>
<div class="exampleblock">
<div class="title">Example 43. Supplying Authentication Credentials</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="txt"># Spring Boot application.properties

spring.data.gemfire.security.username=Batman
spring.data.gemfire.security.password=r0b!n5ucks</code></pre>
</div>
</div>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Authentication is even easier to configure in a managed environment, such as PCF when using PCC. You need not do
anything.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Authorization is configured on the server-side and is made simple with SBDG and the help of
<a href="https://shiro.apache.org/">Apache Shiro</a>.
Of course, this assumes you use SBDG to configure and bootstrap your Apache Geode cluster in the first place, which is
even easier with SBDG. See <a href="#geode-cluster-configuration-bootstrapping">Running an Apache Geode cluster with Spring Boot from your IDE</a>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
See <a href="#geode-security">Security</a> for more details.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="geode-configuration-declarative-auto-configuration-enablessl">6.5.9. <code>@EnableSsl</code></h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The SBDG <a href="https://docs.spring.io/spring-boot-data-geode-build/current/api//org/springframework/geode/boot/autoconfigure/SslAutoConfiguration.html"><code>SslAutoConfiguration</code></a> class
corresponds to the SDG <a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnableSsl.html"><code>@EnableSsl</code></a> annotation.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Configuring SSL for secure transport (TLS) between your Spring Boot, Apache Geode <code>ClientCache</code> application and an
Apache Geode cluster can be a real problem, especially to get right from the start. So, it is something that SBDG
makes as simple as possible.</p>
</div>
<div class="paragraph">
<p>You can supply a <code>trusted.keystore</code> file containing the certificates in a well-known location (such as the root of your
application classpath), and SBDG&#8217;s auto-configuration steps in to handle the rest.</p>
</div>
<div class="paragraph">
<p>This is useful during development, but we highly recommend using a more secure procedure (such as integrating with a
secure credential store like LDAP, CredHub or Vault) when deploying your Spring Boot application to production.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
See <a href="#geode-security-ssl">Transport Layer Security using SSL</a> for more details.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="geode-configuration-declarative-auto-configuration-enablespringsession">6.5.10. <code>@EnableGemFireHttpSession</code></h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The SBDG <a href="https://docs.spring.io/spring-boot-data-geode-build/current/api//org/springframework/geode/boot/autoconfigure/SpringSessionAutoConfiguration.html"><code>SpringSessionAutoConfiguration</code></a> class
corresponds to the SSDG <a href="https://docs.spring.io/autorepo/docs/spring-session-data-geode-build/{spring-session-data-geode-version}/api/org/springframework/session/data/gemfire/config/annotation/EnableGemFireHttpSession.html"><code>@EnableGemFireHttpSession</code></a> annotation.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Configuring Apache Geode to serve as the (HTTP) session state caching provider by using Spring Session requires that
you only include the correct starter, that is <code>spring-geode-starter-session</code>:</p>
</div>
<div class="exampleblock">
<div class="title">Example 44. Using Spring Session</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre>&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.geode&lt;/groupId&gt;
    &lt;artifactId&gt;spring-geode-starter-session&lt;/artifactId&gt;
    &lt;version&gt;{version}&lt;/version&gt;
&lt;/dependency&gt;</pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>With Spring Session&#8201;&#8212;&#8201;and specifically Spring Session for Apache Geode (SSDG)&#8201;&#8212;&#8201;on the classpath of your Spring Boot,
Apache Geode <code>ClientCache</code> Web application, you can manage your (HTTP) session state with Apache Geode. No further
configuration is needed. SBDG auto-configuration detects Spring Session on the application classpath and does the rest.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
See <a href="#geode-session">Spring Session</a> for more details.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="geode-configuration-declarative-auto-configuration-regiontemplates">6.5.11. RegionTemplateAutoConfiguration</h4>
<div class="paragraph">
<p>The SBDG <a href="https://docs.spring.io/spring-boot-data-geode-build/current/api//org/springframework/geode/boot/autoconfigure/RegionTemplateAutoConfiguration.html"><code>RegionTemplateAutoConfiguration</code></a> class
has no corresponding SDG annotation. However, the auto-configuration of a <code>GemfireTemplate</code> for every Apache Geode
<code>Region</code> defined and declared in your Spring Boot application is still supplied by SBDG.</p>
</div>
<div class="paragraph">
<p>For example, you can define a Region by using:</p>
</div>
<div class="exampleblock">
<div class="title">Example 45. Region definition using JavaConfig</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Configuration
class GeodeConfiguration {

    @Bean("Customers")
    ClientRegionFactoryBean&lt;Long, Customer&gt; customersRegion(GemFireCache cache) {

        ClientRegionFactoryBean&lt;Long, Customer&gt; customersRegion =
            new ClientRegionFactoryBean&lt;&gt;();

        customersRegion.setCache(cache);
        customersRegion.setShortcut(ClientRegionShortcut.PROXY);

        return customersRegion;
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Alternatively, you can define the <code>Customers</code> Region by using <code>@EnableEntityDefinedRegions</code>:</p>
</div>
<div class="exampleblock">
<div class="title">Example 46. Region definition using <code>@EnableEntityDefinedRegions</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Configuration
@EnableEntityDefinedRegion(basePackageClasses = Customer.class)
class GeodeConfiguration {

}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Then SBDG supplies a <code>GemfireTemplate</code> instance that you can use to perform low-level data-access operations
(indirectly) on the <code>Customers</code> Region:</p>
</div>
<div class="exampleblock">
<div class="title">Example 47. Use the <code>GemfireTemplate</code> to access the "Customers" Region</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Repository
class CustomersDao {

    @Autowired
    @Qualifier("customersTemplate")
    private GemfireTemplate customersTemplate;

    Customer findById(Long id) {
        return this.customerTemplate.get(id);
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>You need not explicitly configure <code>GemfireTemplates</code> for each Region to which you need low-level data access (such as
when you are not using the Spring Data Repository abstraction).</p>
</div>
<div class="paragraph">
<p>Be careful to qualify the <code>GemfireTemplate</code> for the Region to which you need data access, especially given that you
probably have more than one Region defined in your Spring Boot application.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
See <a href="#geode-data-access-region-templates">Data Access with GemfireTemplate</a> for more details.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="geode-configuration-declarative">7. Declarative Configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The primary purpose of any software development framework is to help you be productive as quickly and as easily as
possible and to do so in a reliable manner.</p>
</div>
<div class="paragraph">
<p>As application developers, we want a framework to provide constructs that are both intuitive and familiar so that their
behaviors are predictable. This provided convenience not only helps you hit the ground running in the right direction
sooner but increases your focus on the application domain so that you can better understand the problem you are trying
to solve in the first place. Once the problem domain is well understood, you are more apt to make informed decisions
about the design, which leads to better outcomes, faster.</p>
</div>
<div class="paragraph">
<p>This is exactly what Spring Boot&#8217;s auto-configuration provides for you. It enables features, functionality, services
and supporting infrastructure for Spring applications in a loosely integrated way by using conventions (such as the
classpath) that ultimately help you keep your attention and focus on solving the problem at hand and not on the plumbing.</p>
</div>
<div class="paragraph">
<p>For example, if you are building a web application, you can include the <code>org.springframework.boot:spring-boot-starter-web</code>
dependency on your application classpath. Not only does Spring Boot enable you to build Spring Web MVC Controllers
appropriate to your application UC (your responsibility), but it also bootstraps your web application in an embedded
Servlet container on startup (Spring Boot&#8217;s responsibility).</p>
</div>
<div class="paragraph">
<p>This saves you from having to handle many low-level, repetitive, and tedious development tasks that are error-prone and
easy to get wrong when you are trying to solve problems. You need not care how the plumbing works until you need to
customize something. And, when you do, you are better informed and prepared to do so.</p>
</div>
<div class="paragraph">
<p>It is also equally essential that frameworks, such as Spring Boot, get out of the way quickly when application
requirements diverge from the provided defaults. This is the beautiful and powerful thing about Spring Boot and why
it is second to none in its class.</p>
</div>
<div class="paragraph">
<p>Still, auto-configuration does not solve every problem all the time. Therefore, you need to use declarative
configuration in some cases, whether expressed as bean definitions, in properties, or by some other means.  This is so
that frameworks do not leave things to chance, especially when things are ambiguous. The framework gives you choice.</p>
</div>
<div class="paragraph">
<p>Keeping our goals in mind, this chapter:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Refers you to the SDG annotations covered by SBDG&#8217;s auto-configuration.</p>
</li>
<li>
<p>Lists all SDG annotations not covered by SBDG&#8217;s auto-configuration.</p>
</li>
<li>
<p>Covers the SBDG, SSDG and SDG annotations that you must explicitly declare and that provide the most value
and productivity when getting started with Apache Geode in Spring [Boot] applications.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
SDG refers to <a href="https://spring.io/projects/spring-data-geode">Spring Data for Apache Geode</a>. SSDG refers to
<a href="https://spring.io/projects/spring-session-data-geode">Spring Session for Apache Geode</a>. SBDG refers to
Spring Boot for Apache Geode (this project).
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
The list of SDG annotations covered by SBDG&#8217;s auto-configuration is discussed in detail in the <a href="#appendix">Appendix</a>,
in the <a href="#geode-auto-configuration-annotations">Auto-configuration vs. Annotation-based configuration</a> section.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To be absolutely clear about which SDG annotations we are referring to, we mean the SDG annotations in the
<a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/package-summary.html"><code>org.springframework.data.gemfire.config.annotation</code></a>
package.</p>
</div>
<div class="paragraph">
<p>In subsequent sections, we also cover which annotations are added by SBDG.</p>
</div>
<div class="sect2">
<h3 id="geode-configuration-declarative-auto-configuration">7.1. Auto-configuration</h3>
<div class="paragraph">
<p>We explained auto-configuration in detail in the <a href="#geode-configuration-auto">Auto-configuration</a> chapter.</p>
</div>
</div>
<div class="sect2">
<h3 id="geode-configuration-declarative-annotations">7.2. Annotations Not Covered by Auto-configuration</h3>
<div class="paragraph">
<p>The following SDG annotations are not implicitly applied by SBDG&#8217;s auto-configuration:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>@EnableAutoRegionLookup</code></p>
</li>
<li>
<p><code>@EnableBeanFactoryLocator</code></p>
</li>
<li>
<p><code>@EnableCacheServer(s)</code></p>
</li>
<li>
<p><code>@EnableCachingDefinedRegions</code></p>
</li>
<li>
<p><code>@EnableClusterConfiguration</code></p>
</li>
<li>
<p><code>@EnableClusterDefinedRegions</code></p>
</li>
<li>
<p><code>@EnableCompression</code></p>
</li>
<li>
<p><code>@EnableDiskStore(s)</code></p>
</li>
<li>
<p><code>@EnableEntityDefinedRegions</code></p>
</li>
<li>
<p><code>@EnableEviction</code></p>
</li>
<li>
<p><code>@EnableExpiration</code></p>
</li>
<li>
<p><code>@EnableGatewayReceiver</code></p>
</li>
<li>
<p><code>@EnableGatewaySender(s)</code></p>
</li>
<li>
<p><code>@EnableGemFireAsLastResource</code></p>
</li>
<li>
<p><code>@EnableGemFireMockObjects</code></p>
</li>
<li>
<p><code>@EnableHttpService</code></p>
</li>
<li>
<p><code>@EnableIndexing</code></p>
</li>
<li>
<p><code>@EnableOffHeap</code></p>
</li>
<li>
<p><code>@EnableLocator</code></p>
</li>
<li>
<p><code>@EnableManager</code></p>
</li>
<li>
<p><code>@EnableMemcachedServer</code></p>
</li>
<li>
<p><code>@EnablePool(s)</code></p>
</li>
<li>
<p><code>@EnableRedisServer</code></p>
</li>
<li>
<p><code>@EnableStatistics</code></p>
</li>
<li>
<p><code>@UseGemFireProperties</code></p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This content was also covered in <a href="#geode-autoconfiguration-annotations-explicit">Explicit Configuration</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>One reason SBDG does not provide auto-configuration for several of the annotations is because the annotations
are server-specific:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>@EnableCacheServer(s)</code></p>
</li>
<li>
<p><code>@EnableGatewayReceiver</code></p>
</li>
<li>
<p><code>@EnableGatewaySender(s)</code>.</p>
</li>
<li>
<p><code>@EnableHttpService</code></p>
</li>
<li>
<p><code>@EnableLocator</code></p>
</li>
<li>
<p><code>@EnableManager</code></p>
</li>
<li>
<p><code>@EnableMemcachedServer</code></p>
</li>
<li>
<p><code>@EnableRedisServer</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Also, we <a href="#geode-clientcache-applications">already stated</a> that SBDG is opinionated about providing a <code>ClientCache</code>
instance.</p>
</div>
<div class="paragraph">
<p>Other annotations are driven by need, including:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>@EnableAutoRegionLookup</code> and <code>@EnableBeanFactoryLocator</code>: Really useful only when mixing configuration metadata
formats, such as Spring config with Apache Geode <code>cache.xml</code>. This is usually the case only if you have legacy
<code>cache.xml</code> config to begin with. Otherwise, you should not use these annotations.</p>
</li>
<li>
<p><code>@EnableCompression</code>: Requires the Snappy Compression Library to be on your application classpath.</p>
</li>
<li>
<p><code>@EnableDiskStore(s)</code> Used only for overflow and persistence.</p>
</li>
<li>
<p><code>@EnableOffHeap</code>: Enables data to be stored in main memory, which is useful only when your application data (that is,
objects stored in Apache Geode) are generally uniform in size.</p>
</li>
<li>
<p><code>@EnableGemFireAsLastResource</code>: Needed only in the context of JTA Transactions.</p>
</li>
<li>
<p><code>@EnableStatistics</code>: Useful if you need runtime metrics. However, enabling statistics gathering does consume
considerable system resources (CPU &amp; Memory).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Still other annotations require more careful planning:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>@EnableEviction</code></p>
</li>
<li>
<p><code>@EnableExpiration</code></p>
</li>
<li>
<p><code>@EnableIndexing</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>One annotation is used exclusively for unit testing:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>@EnableGemFireMockObjects</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The bottom-line is that a framework should not auto-configure every possible feature, especially when the features
consume additional system resources or require more careful planning (as determined by the use case).</p>
</div>
<div class="paragraph">
<p>However, all of these annotations are available for the application developer to use when needed.</p>
</div>
</div>
<div class="sect2">
<h3 id="geode-configuration-declarative-annotations-productivity">7.3. Productivity Annotations</h3>
<div class="paragraph">
<p>This section calls out the annotations we believe to be most beneficial for your application development purposes when
using Apache Geode in Spring [Boot] applications.</p>
</div>
<div class="sect3">
<h4 id="geode-configuration-declarative-annotations-productivity-enableclusteraware">7.3.1. <code>@EnableClusterAware</code> (SBDG)</h4>
<div class="paragraph">
<p>The <code>@EnableClusterAware</code> annotation is arguably the most powerful and valuable annotation.</p>
</div>
<div class="exampleblock">
<div class="title">Example 48. Declaring <code>@EnableClusterAware</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@SpringBootApplication
@EnableClusterAware
class SpringBootApacheGeodeClientCacheApplication {  }</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>When you annotate your main <code>@SpringBootApplication</code> class with <code>@EnableClusterAware</code>, your Spring Boot, Apache Geode
<code>ClientCache</code> application is able to seamlessly switch between client/server and local-only topologies with no code
or configuration changes, regardless of the runtime environment (such as local/standalone versus cloud-managed
environments).</p>
</div>
<div class="paragraph">
<p>When a cluster of Apache Geode servers is detected, the client application sends and receives data to and from the
Apache Geode cluster. If a cluster is not available, the client automatically switches to storing data locally on the
client by using <code>LOCAL</code> Regions.</p>
</div>
<div class="paragraph">
<p>Additionally, the <code>@EnableClusterAware</code> annotation is meta-annotated with SDG&#8217;s
<a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnableClusterConfiguration.html"><code>@EnableClusterConfiguration</code></a>
annotation.</p>
</div>
<div class="paragraph">
<p>The <code>@EnableClusterConfiguration</code> annotation lets configuration metadata defined on the client (such as Region and Index
definitions, as needed by the application based on requirements and use cases) be sent to the cluster of servers. If
those schema objects are not already present, they are created by the servers in the cluster in such a way that the
servers remember the configuration on restart as well as provide the configuration to new servers that join the cluster
when it is scaled out. This feature is careful not to stomp on any existing Region or Index objects already defined on
the servers, particularly since you may already have critical data stored in the Regions.</p>
</div>
<div class="paragraph">
<p>The primary motivation for the <code>@EnableClusterAware</code> annotation is to let you switch environments with minimal effort.
It is a common development practice to debug and test your application locally (in your IDE) and then push up to a
production-like (staging) environment for more rigorous integration testing.</p>
</div>
<div class="paragraph">
<p>By default, the configuration metadata is sent to the cluster by using a non-secure HTTP connection. However, you can
configure HTTPS, change the host and port, and configure the data management policy used by the servers when creating
Regions.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
See the section in the SDG reference documentation on
<a href="https://docs.spring.io/spring-data/geode/docs/current/reference/html/#bootstrap-annotation-config-cluster">Configuring Cluster Configuration Push</a>
for more details.
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="geode-configuration-declarative-annotations-productivity-enableclusteraware-strictmatch">@EnableClusterAware, strictMatch</h5>
<div class="paragraph">
<p>The <code>strictMatch</code> attribute has been added to the <code>@EnableClusterAware</code> annotation to enable fail-fast behavior.
<code>strictMatch</code> is set to <code>false</code> by default.</p>
</div>
<div class="paragraph">
<p>Essentially, when you set <code>strictMatch</code> to <code>true</code>, your Spring Boot, Apache Geode <code>ClientCache</code> application requires
an Apache Geode cluster to exist. That is, the application requires a client/server topology to operate, and the
application should fail to start if a cluster is not present. The application should not startup in a local-only
capacity.</p>
</div>
<div class="paragraph">
<p>When <code>strictMatch</code> is set to <code>true</code> and an Apache Geode cluster is not available, your Spring Boot, Apache Geode
<code>ClientCache</code> application fails to start with a <code>ClusterNotFoundException</code>. The application does not attempt to
start in a local-only capacity.</p>
</div>
<div class="paragraph">
<p>You can explicitly set the <code>strictMatch</code> attribute programmatically by using the <code>@EnableClusterAware</code> annotation:</p>
</div>
<div class="exampleblock">
<div class="title">Example 49. Set <code>@EnableClusterAware.strictMatch</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@SpringBootApplication
@EnableClusterAware(strictMatch = true)
class SpringBootApacheGeodeClientCacheApplication {  }</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Alternatively, you can set <code>strictMatch</code> attribute by using the corresponding property
in Spring Boot <code>application.properties</code>:</p>
</div>
<div class="exampleblock">
<div class="title">Example 50. Set <code>strictMatch</code> using a property</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="properties"># Spring Boot application.properties

spring.boot.data.gemfire.cluster.condition.match.strict=true</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>This is convenient when you need to apply this configuration setting conditionally, based on a Spring profile.</p>
</div>
<div class="paragraph">
<p>When you adjust the log level of the <code>org.springframework.geode.config.annotation.ClusterAwareConfiguration</code> logger
to <code>INFO</code>, you get more details from the <code>@EnableClusterAware</code> functionality when applying the logic to determine
the presence of an Apache Geode cluster, such as which explicitly or implicitly configured connections were successful.</p>
</div>
<div class="paragraph">
<p>The following example shows typical output:</p>
</div>
<div class="exampleblock">
<div class="title">Example 51. <code>@EnableClusterAware</code> INFO log output</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="txt">2021-01-20 14:02:28,740  INFO fig.annotation.ClusterAwareConfiguration: 476 - Failed to connect to localhost[40404]
2021-01-20 14:02:28,745  INFO fig.annotation.ClusterAwareConfiguration: 476 - Failed to connect to localhost[10334]
2021-01-20 14:02:28,746  INFO fig.annotation.ClusterAwareConfiguration: 470 - Successfully connected to localhost[57649]
2021-01-20 14:02:28,746  INFO fig.annotation.ClusterAwareConfiguration: 576 - Cluster was found; Auto-configuration made [1] successful connection(s);
2021-01-20 14:02:28,746  INFO fig.annotation.ClusterAwareConfiguration: 586 - Spring Boot application is running in a client/server topology, using a standalone Apache Geode-based cluster</code></pre>
</div>
</div>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
An attempt is always made to connect to <code>localhost</code> on the default <code>Locator</code> port, <code>10334</code>, and the default
<code>CacheServer</code> port, <code>40404</code>.
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
You can force a successful match by setting the <code>spring.boot.data.gemfire.cluster.condition.match</code> property
to <code>true</code> in Spring Boot <code>application.properties</code>. This is sometimes useful for testing purposes.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="geode-configuration-declarative-annotations-productivity-regions">7.3.2. <code>@EnableCachingDefinedRegions</code>, <code>@EnableClusterDefinedRegions</code> and <code>@EnableEntityDefinedRegions</code> (SDG)</h4>
<div class="paragraph">
<p>These annotations are used to create Regions in the cache to manage your application data.</p>
</div>
<div class="paragraph">
<p>You can create Regions by using Java configuration and the Spring API as follows:</p>
</div>
<div class="exampleblock">
<div class="title">Example 52. Creating a Region with Spring JavaConfig</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Configuration
class GeodeConfiguration {

    @Bean("Customers")
    ClientRegionFactoryBean&lt;Long, Customer&gt; customersRegion(GemFireCache cache) {

        ClientRegionFactoryBean&lt;Long, Customer&gt; customers =
            new ClientRegionFactoryBean&lt;&gt;();

        customers.setCache(cache);
        customers.setShortcut(ClientRegionShortcut.PROXY);

        return customers;
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>You can do the same in XML:</p>
</div>
<div class="exampleblock">
<div class="title">Example 53. Creating a client Region using Spring XML</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;gfe:client-region id="Customers" shorcut="PROXY"/&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>However, using the provided annotations is far easier, especially during development, when the complete Region
configuration may be unknown and you want only to create a Region to persist your application data and move on.</p>
</div>
<div class="sect4">
<h5 id="geode-configuration-declarative-annotations-productivity-regions-enablecachingdefined"><code>@EnableCachingDefinedRegions</code></h5>
<div class="paragraph">
<p>The <code>@EnableCachingDefinedRegions</code> annotation is used when you have application components registered in the Spring
container that are annotated with Spring or JSR-107 JCache
<a href="https://docs.spring.io/spring/docs/current/spring-framework-reference/integration.html#cache-jsr-107">annotations</a>.</p>
</div>
<div class="paragraph">
<p>Caches that are identified by name in the caching annotations are used to create Regions that hold the data
you want cached.</p>
</div>
<div class="paragraph">
<p>Consider the following example:</p>
</div>
<div class="exampleblock">
<div class="title">Example 54. Defining Regions based on Spring or JSR-107 JCache Annotations</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Service
class CustomerService {

    @Cacheable(cacheNames = "CustomersByAccountNumber", key = "#account.number")
    Customer findBy(Account account) {
        // ...
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Further consider the following example, in which the main <code>@SpringBootApplication</code> class is annotated with
<code>@EnableCachingDefinedRegions</code>:</p>
</div>
<div class="exampleblock">
<div class="title">Example 55. Using <code>@EnableCachingDefinedRegions</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@SpringBootApplication
@EnableCachingDefineRegions
class SpringBootApacheGeodeClientCacheApplication {  }</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>With this setup, SBDG would create a client <code>PROXY</code> Region (or <code>PARTITION_REGION</code> if your application were a peer member
of the Apache Geode cluster) with a name of &#8220;CustomersByAccountNumber&#8221;, as though you created the Region by using
either the Java configuration or XML approaches shown earlier.</p>
</div>
<div class="paragraph">
<p>You can use the <code>clientRegionShortcut</code> or <code>serverRegionShortcut</code> attribute to change the data management policy of
the Regions created on the client or servers, respectively.</p>
</div>
<div class="paragraph">
<p>For client Regions, you can also set the <code>poolName</code> attribute to assign a specific <code>Pool</code> of connections to be used by
the client <code>*PROXY</code> Regions to send data to the cluster.</p>
</div>
</div>
<div class="sect4">
<h5 id="geode-configuration-declarative-annotations-productivity-regions-enableentitydefined"><code>@EnableEntityDefinedRegions</code></h5>
<div class="paragraph">
<p>As with <code>@EnableCachingDefinedRegions</code>, <code>@EnableEntityDefinedRegions</code> lets you create Regions based on the entity
classes you have defined in your application domain model.</p>
</div>
<div class="paragraph">
<p>For instance, consider an entity class annotated with SDG&#8217;s
<a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/mapping/annotation/Region.html"><code>@Region</code></a>
mapping annotation:</p>
</div>
<div class="exampleblock">
<div class="title">Example 56. Customer entity class annotated with <code>@Region</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Region("Customers")
class Customer {

    @Id
    private Long id;

    @Indexed
    private String name;

}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>For this class, SBDG creates Regions from the name specified in the <code>@Region</code> mapping annotation on the entity class.
In this case, the <code>Customer</code> application-defined entity class results in the creation of a Region named &#8220;Customers&#8221;
when the main <code>@SpringBootApplication</code> class is annotated with <code>@EnableEntityDefinedRegions</code>:</p>
</div>
<div class="exampleblock">
<div class="title">Example 57. Using <code>@EnableEntityDefinedRegions</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@SpringBootApplication
@EnableEntityDefinedRegions(basePackageClasses = Customer.class,
    clientRegionShortcut = ClientRegionShortcut.CACHING_PROXY)
class SpringBootApacheGeodeClientCacheApplication {  }</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>As with the <code>@EnableCachingDefinedRegions</code> annotation, you can set the client and server Region data management policy
by using the <code>clientRegionShortcut</code> and <code>serverRegionShortcut</code> attributes, respectively, and set a dedicated <code>Pool</code>
of connections used by client Regions with the <code>poolName</code> attribute.</p>
</div>
<div class="paragraph">
<p>However, unlike the <code>@EnableCachingDefinedRegions</code> annotation, you must specify either the <code>basePackage</code> attribute
or the type-safe <code>basePackageClasses</code> attribute (recommended) when you use the <code>@EnableEntityDefinedRegions</code> annotation.</p>
</div>
<div class="paragraph">
<p>Part of the reason for this is that <code>@EnableEntityDefinedRegions</code> performs a component scan for the entity classes
defined by your application. The component scan loads each class to inspect the annotation metadata for that class.
This is not unlike the JPA entity scan when working with JPA providers, such as Hibernate.</p>
</div>
<div class="paragraph">
<p>Therefore, it is customary to limit the scope of the scan. Otherwise, you end up potentially loading many classes
unnecessarily. After all, the JVM uses dynamic linking to load classes only when needed.</p>
</div>
<div class="paragraph">
<p>Both the <code>basePackages</code> and <code>basePackageClasses</code> attributes accept an array of values. With <code>basePackageClasses</code>, you
need only refer to a single class type in that package and every class in that package as well as classes in the
sub-packages are scanned to determine if the class type represents an entity. A class type is an entity if it is
annotated with the <code>@Region</code> mapping annotation. Otherwise, it is not considered to be an entity.</p>
</div>
<div class="paragraph">
<p>For example, suppose you had the following structure:</p>
</div>
<div class="exampleblock">
<div class="title">Example 58. Entity Scan</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="txt">- example.app.crm.model
 |- Customer.class
 |- NonEntity.class
 |- contact
   |- Address.class
   |- PhoneNumber.class
   |- AnotherNonEntity.class
- example.app.accounts.model
 |- Account.class
...
..
.</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Then you could configure the <code>@EnableEntityDefinedRegions</code> as follows:</p>
</div>
<div class="exampleblock">
<div class="title">Example 59. Targeting with <code>@EnableEntityDefinedRegions</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@SpringBootApplication
@EnableEntityDefinedRegions(basePackageClasses = { NonEntity.class, Account.class } )
class SpringBootApacheGeodeClientCacheApplication {  }</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>If <code>Customer</code>, <code>Address</code>, <code>PhoneNumber</code> and <code>Account</code> were all entity classes properly annotated with <code>@Region</code>,
the component scan would pick up all these classes and create Regions for them. The <code>NonEntity</code> class serves only as
a marker in this case, to point to where (that is, which package) the scan should begin.</p>
</div>
<div class="paragraph">
<p>Additionally, the <code>@EnableEntityDefinedRegions</code> annotation provides include and exclude filters, the same as
the core Spring Frameworks <code>@ComponentScan</code> annotation.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
See the SDG reference documentation on
<a href="https://docs.spring.io/spring-data/geode/docs/current/reference/html/#bootstrap-annotation-config-regions">Configuring Regions</a>
for more details.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="geode-configuration-declarative-annotations-productivity-regions-enableclusterdefined"><code>@EnableClusterDefinedRegions</code></h5>
<div class="paragraph">
<p>Sometimes, it is ideal or even necessary to pull configuration from the cluster (rather than push configuration to the
cluster). That is, you want the Regions defined on the servers to be created on the client and used by your application.</p>
</div>
<div class="paragraph">
<p>To do so, annotate your main <code>@SpringBootApplication</code> class with <code>@EnableClusterDefinedRegions</code>:</p>
</div>
<div class="exampleblock">
<div class="title">Example 60. Using <code>@EnableClusterDefinedRegions</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@SpringBootApplication
@EnableClusterDefinedRegions
class SpringBootApacheGeodeClientCacheApplication {  }</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Every Region that exists on the servers in the Apache Geode cluster will have a corresponding <code>PROXY</code> Region defined
and created on the client as a bean in your Spring Boot application.</p>
</div>
<div class="paragraph">
<p>If the cluster of servers defines a Region called &#8220;ServerRegion&#8221;, you can inject a client <code>PROXY</code> Region with
the same name (&#8220;ServerRegion&#8221;) into your Spring Boot application:</p>
</div>
<div class="exampleblock">
<div class="title">Example 61. Using a server-side Region on the client</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Component
class SomeApplicationComponent {

    @Resource(name = "ServerRegion")
    private Region&lt;Integer, EntityType&gt; serverRegion;

    public void someMethod() {

        EntityType entity = new EntityType();

        this.serverRegion.put(1, entity);

        // ...
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>SBDG auto-configures a <code>GemfireTemplate</code> for the &#8220;ServerRegion&#8221; Region
(see <a href="#geode-configuration-declarative-auto-configuration-regiontemplates">RegionTemplateAutoConfiguration</a>),
so a better way to interact with the client <code>PROXY</code> Region that corresponds to the &#8220;ServerRegion&#8221; Region on the server
is to inject the template:</p>
</div>
<div class="exampleblock">
<div class="title">Example 62. Using a server-side Region on the client with a template</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Component
class SomeApplicationComponent {

    @Autowired
    @Qualifier("serverRegionTemplate")
    private GemfireTemplate serverRegionTemplate;

    public void someMethod() {

        EntityType entity = new EntityType();

        this.serverRegionTemplate.put(1, entity);

        //...
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
See the SDG reference documentation on
<a href="https://docs.spring.io/spring-data/geode/docs/current/reference/html/#bootstrap-annotation-config-region-cluster-defined">Configuring Cluster-defined Regions</a>
for more details.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="geode-configuration-declarative-annotations-productivity-enableindexing">7.3.3. <code>@EnableIndexing</code> (SDG)</h4>
<div class="paragraph">
<p>You can also use the <code>@EnableIndexing</code> annotation&#8201;&#8212;&#8201;but only when you use <code>@EnableEntityDefinedRegions</code>. This is
because <code>@EnableIndexing</code> requires the entities to be scanned and analyzed for mapping metadata (defined on the class
type of the entity). This includes annotations such as the Spring Data Commons <code>@Id</code> annotation and the annotations
provided by SDG, such as <code>@Indexed</code> and <code>@LuceneIndexed</code>.</p>
</div>
<div class="paragraph">
<p>The <code>@Id</code> annotation identifies the (primary) key of the entity. The <code>@Indexed</code> annotation defines OQL indexes on object
fields, which can be used in the predicates of your OQL queries. The <code>@LuceneIndexed</code> annotation is used to define the
Apache Lucene Indexes required for searches.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Lucene Indexes can only be created on <code>PARTITION</code> Regions, and <code>PARTITION</code> Regions can only be defined on
the server side.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You may have noticed that the <code>Customer</code> entity class&#8217;s <code>name</code> field was annotated with <code>@Indexed</code>.</p>
</div>
<div class="paragraph">
<p>Consider the following listing:</p>
</div>
<div class="exampleblock">
<div class="title">Example 63. Customer entity class with <code>@Indexed</code> annotated <code>name</code> field</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Region("Customers")
class Customer {

    @Id
    private Long id;

    @Indexed
    private String name;

}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>As a result, when our main <code>@SpringBootApplication</code> class is annotated with <code>@EnableIndexing</code>, an Apache Geode OQL Index
for the <code>Customer.name</code> field is created, allowing OQL queries on customers by name to use this Index:</p>
</div>
<div class="exampleblock">
<div class="title">Example 64. Using <code>@EnableIndexing</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@SpringBootApplication
@EnableEntityDefinedRegions(basePackageClasses = Customer.class)
@EnableIndexing
class SpringBootApacheGeodeClientCacheApplication {  }</code></pre>
</div>
</div>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Keep in mind that OQL Indexes are not persistent between restarts (that is, Apache Geode maintains Indexes
in memory only). An OQL Index is always rebuilt when the node is restarted.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When you combine <code>@EnableIndexing</code> with either <code>@EnableClusterConfiguration</code> or <code>@EnableClusterAware</code>, the Index
definitions are pushed to the server-side Regions where OQL queries are generally executed.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
See the SDG reference documentation on
<a href="https://docs.spring.io/spring-data/geode/docs/current/reference/html/#bootstrap-annotation-config-region-indexes">Configuring Indexes</a>
for more details.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="geode-configuration-declarative-annotations-productivity-enableexpiration">7.3.4. <code>@EnableExpiration</code> (SDG)</h4>
<div class="paragraph">
<p>It is often useful to define both eviction and expiration policies, particularly with a system like Apache Geode,
because it primarily keeps data in memory (on the JVM Heap). Your data volume size may far exceed the amount of
available JVM Heap memory, and keeping too much data on the JVM Heap can cause Garbage Collection (GC) issues.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
You can enable off-heap (or main memory usage) capabilities by declaring SDG&#8217;s <code>@EnableOffHeap</code> annotation.
See the SDG reference documentation on
<a href="https://docs.spring.io/spring-data/geode/docs/current/reference/html/#bootstrap-annotation-config-region-off-heap">Configuring Off-Heap Memory</a>
for more details.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Defining eviction and expiration policies lets you limit what is kept in memory and for how long.</p>
</div>
<div class="paragraph">
<p>While <a href="https://docs.spring.io/spring-data/geode/docs/current/reference/html/#bootstrap-annotation-config-region-eviction">configuring eviction</a> is easy with SDG,
we particularly want to call out expiration since
<a href="https://docs.spring.io/spring-data/geode/docs/current/reference/html/#bootstrap-annotation-config-region-expiration">configuring expiration</a> has special support
in SDG.</p>
</div>
<div class="paragraph">
<p>With SDG, you can define the expiration policies associated with a particular application class type on the class type
itself, by using the <a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/expiration/Expiration.html"><code>@Expiration</code></a>,
<a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/expiration/IdleTimeoutExpiration.html"><code>@IdleTimeoutExpiration</code></a>
and <a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/expiration/TimeToLiveExpiration.html"><code>@TimeToLiveExpiration</code></a>
annotations.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
See the Apache Geode <a href="https://geode.apache.org/docs/guide/{apache-geode-doc-version}/developing/expiration/how_expiration_works.html">User Guide</a>
for more details on the different expiration types&#8201;&#8212;&#8201;that is <em>Idle Timeout</em> (TTI) versus <em>Time-to-Live</em> (TTL).
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For example, suppose we want to limit the number of <code>Customers</code> maintained in memory for a period of time (measured in
seconds) based on the last time a <code>Customer</code> was accessed (for example, the last time a <code>Customer</code> was read). To do so,
we can define an idle timeout expiration (TTI) policy on our <code>Customer</code> class type:</p>
</div>
<div class="exampleblock">
<div class="title">Example 65. Customer entity class with Idle Timeout Expiration (TTI)</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Region("Customers")
@IdleTimeoutExpiration(action = "INVALIDATE", timeout = "300")
class Customer {

    @Id
    private Long id;

    @Indexed
    private String name;

}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The <code>Customer</code> entry in the <code>Customers</code> Region is <code>invalidated</code> after 300 seconds (5 minutes).</p>
</div>
<div class="paragraph">
<p>To enable annotation-based expiration policies, we need to annotate our main <code>@SpringBootApplication</code> class
with <code>@EnableExpiration</code>:</p>
</div>
<div class="exampleblock">
<div class="title">Example 66. Enabling Expiration</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@SpringBootApplication
@EnableExpiration
class SpringBootApacheGeodeApplication {  }</code></pre>
</div>
</div>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Technically, this entity-class-specific annotation-based expiration policy is implemented by using Apache Geode&#8217;s
<a href="https://geode.apache.org/releases/latest/javadoc/org/apache/geode/cache/CustomExpiry.html"><code>CustomExpiry</code></a> interface.
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
See the SDG reference doccumentation for more details on
<a href="https://docs.spring.io/spring-data/geode/docs/current/reference/html/#bootstrap-annotation-config-region-expiration">configuring expiration</a>, along with
<a href="https://docs.spring.io/spring-data/geode/docs/current/reference/html/#bootstrap:region:expiration:annotation">annotation-based data expiration</a> in particular.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="geode-configuration-declarative-annotations-productivity-enablemockobjects">7.3.5. <code>@EnableGemFireMockObjects</code> (STDG)</h4>
<div class="paragraph">
<p>Software testing in general and unit testing in particular are a very important development tasks to ensure the quality
of your Spring Boot applications.</p>
</div>
<div class="paragraph">
<p>Apache Geode can make testing difficult in some cases, especially when tests have to be written as integration tests
to assert the correct behavior. This can be very costly and lengthens the feedback cycle. Fortunately, you can write
unit tests as well.</p>
</div>
<div class="paragraph">
<p>Spring provides a framework for testing Spring Boot applications that use Apache Geode. This is where the
<a href="https://github.com/spring-projects/spring-test-data-geode#spring-test-framework-for-apache-geode&#8212;&#8203;vmware-tanzu-gemfire">Spring Test for Apache Geode (STDG)</a> project can help, particularly with
unit testing.</p>
</div>
<div class="paragraph">
<p>For example, if you do not care what Apache Geode would actually do in certain cases and only care about the &#8220;contract&#8221;,
which is what mocking a collaborator is all about, you could effectively mock Apache Geode objects to isolate the SUT,
or &#8220;Subject Under Test&#8221;, and focus on the interactions or outcomes you expect to happen.</p>
</div>
<div class="paragraph">
<p>With STDG, you need not change a bit of configuration to enable mock objects in the unit tests for your Spring Boot
applications. You need only annotate the test class with <code>@EnableGemFireMockObjects</code>:</p>
</div>
<div class="exampleblock">
<div class="title">Example 67. Using Mock Apache Geode Objects</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@RunWith(SpringRunner.class)
@SpringBootTest
class MyApplicationTestClass {

    @Test
    public void someTestCase() {
        // ...
    }

    @Configuration
    @EnableGemFireMockObjects
    static class GeodeConfiguration { }

}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Your Spring Boot configuration of Apache Geode returns mock objects for all Apache Geode objects, such as Regions.</p>
</div>
<div class="paragraph">
<p>Mocking Apache Geode objects even works for objects created from the productivity annotations discussed in the previous
sections.</p>
</div>
<div class="paragraph">
<p>For example, consider the following Spring Boot, Apache Geode <code>ClientCache</code> application class:</p>
</div>
<div class="exampleblock">
<div class="title">Example 68. Main <code>@SpringBootApplication</code> class under test</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@SpringBootApplication
@EnableEntityDefinedRegions(basePackageClasses = Customer.class)
class SpringBootApacheGeodeClientCacheApplication {  }</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>In the preceding example, the <code>"Customers`" Region defined by the `Customer</code> entity class and created by
the <code>@EnableEntityDefinedRegions</code> annotation would be a mock Region and not an actual Region. You can still inject
the Region in your test and assert interactions on the Region based on your application workflows:</p>
</div>
<div class="exampleblock">
<div class="title">Example 69. Using Mock Apache Geode Objects</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@RunWith(SpringRunner.class)
@SpringBootTest
class MyApplicationTestClass {

    @Resource(name = "Customers")
    private Region&lt;Long, Customer&gt; customers;

    @Test
    public void someTestCase() {

        Customer jonDoe = new Customer(1, "Jon Doe");

        // Use the application in some way and test the interaction on the "Customers" Region

        assertThat(this.customers).containsValue(jonDoe);

        // ...
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>There are many more things that STDG can do for you in both unit testing and integration testing.</p>
</div>
<div class="paragraph">
<p>See the <a href="https://github.com/spring-projects/spring-test-data-geode#unit-testing-with-stdg">documentation on unit testing</a>
for more details.</p>
</div>
<div class="paragraph">
<p>You can <a href="https://github.com/spring-projects/spring-test-data-geode#integration-testing-with-stdg">write integration tests</a>
that use STDG as well. Writing integration tests is an essential concern when you need to assert whether your
application OQL queries are well-formed, for instance. There are many other valid cases where integration testing
is also applicable.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="geode-configuration-externalized">8. Externalized Configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Like Spring Boot itself (see <a href="https://docs.spring.io/spring-boot/docs/current/reference/html/boot-features-external-config.html">Spring Boot&#8217;s documentation</a>),
Spring Boot for Apache Geode (SBDG) supports externalized configuration.</p>
</div>
<div class="paragraph">
<p>By externalized configuration, we mean configuration metadata stored in Spring Boot
<a href="https://docs.spring.io/spring-boot/docs/current/reference/html/boot-features-external-config.html#boot-features-external-config-application-property-files"><code>application.properties</code></a>.
You can even separate concerns by addressing each concern in an individual properties file. Optionally, you could also
enable any given property file for only a specific <a href="https://docs.spring.io/spring-boot/docs/current/reference/html/boot-features-external-config.html#boot-features-external-config-profile-specific-properties">profile</a>.</p>
</div>
<div class="paragraph">
<p>You can do many other powerful things, such as (but not limited to) using
<a href="https://docs.spring.io/spring-boot/docs/current/reference/html/boot-features-external-config.html#boot-features-external-config-placeholders-in-properties">placeholders</a>
in properties, <a href="https://docs.spring.io/spring-boot/docs/current/reference/html/boot-features-external-config.html#boot-features-encrypting-properties">encrypting</a>
properties, and so on. In this section, we focus particularly on
<a href="https://docs.spring.io/spring-boot/docs/current/reference/html/boot-features-external-config.html#boot-features-external-config-typesafe-configuration-properties">type safety</a>.</p>
</div>
<div class="paragraph">
<p>Like Spring Boot, Spring Boot for Apache Geode provides a hierarchy of classes that captures configuration for several
Apache Geode features in an associated <code>@ConfigurationProperties</code> annotated class. Again, the configuration metadata is
specified as well-known, documented properties in one or more Spring Boot <code>application.properties</code> files.</p>
</div>
<div class="paragraph">
<p>For instance, a Spring Boot, Apache Geode <code>ClientCache</code> application might be configured as follows:</p>
</div>
<div class="exampleblock">
<div class="title">Example 70. Spring Boot <code>application.properties</code> containing Spring Data properties for Apache Geode</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="properties"># Spring Boot application.properties used to configure {geode-name}

spring.data.gemfire.name=MySpringBootApacheGeodeApplication

# Configure general cache properties
spring.data.gemfire.cache.copy-on-read=true
spring.data.gemfire.cache.log-level=debug

# Configure ClientCache specific properties
spring.data.gemfire.cache.client.durable-client-id=123
spring.data.gemfire.cache.client.keep-alive=true

# Configure a log file
spring.data.gemfire.logging.log-file=/path/to/geode.log

# Configure the client's connection Pool to the servers in the cluster
spring.data.gemfire.pool.locators=10.105.120.16[11235],boombox[10334]</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>You can use many other properties to externalize the configuration of your Spring Boot, Apache Geode applications.
See the <a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/package-frame.html">Javadoc</a>
for specific configuration properties. Specifically, review the <code>enabling</code> annotation attributes.</p>
</div>
<div class="paragraph">
<p>You may sometimes require access to the configuration metadata (specified in properties) in your Spring Boot
applications themselves, perhaps to further inspect or act on a particular configuration setting. You can access any
property by using Spring&#8217;s <a href="https://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/core/env/Environment.html"><code>Environment</code></a>
abstraction:</p>
</div>
<div class="exampleblock">
<div class="title">Example 71. Using the Spring <code>Environment</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Configuration
class GeodeConfiguration {

    void readConfigurationFromEnvironment(Environment environment) {
        boolean copyOnRead = environment.getProperty("spring.data.gemfire.cache.copy-on-read",
            Boolean.TYPE, false);
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>While using <code>Environment</code> is a nice approach, you might need access to additional properties or want to access
the property values in a type-safe manner. Therefore, you can now, thanks to SBDG&#8217;s auto-configured configuration
processor, access the configuration metadata by using <code>@ConfigurationProperties</code> classes.</p>
</div>
<div class="paragraph">
<p>To add to the preceding example, you can now do the following:</p>
</div>
<div class="exampleblock">
<div class="title">Example 72. Using <code>GemFireProperties</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Component
class MyApplicationComponent {

    @Autowired
    private GemFireProperties gemfireProperties;

    public void someMethodUsingGemFireProperties() {

        boolean copyOnRead = this.gemfireProperties.getCache().isCopyOnRead();

        // do something with `copyOnRead`
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Given a handle to <a href="https://docs.spring.io/spring-boot-data-geode-build/current/api//org/springframework/geode/boot/autoconfigure/configuration/GemFireProperties.html"><code>GemFireProperties</code></a>,
you can access any of the configuration properties that are used to configure Apache Geode in a Spring context. You need
only autowire an instance of <code>GemFireProperties</code> into your application component.</p>
</div>
<div class="paragraph">
<p>See the complete reference for the
<a href="https://docs.spring.io/spring-boot-data-geode-build/current/api//org/springframework/geode/boot/autoconfigure/configuration/package-frame.html">SBDG <code>@ConfigurationProperties</code> classes and supporting classes</a>.</p>
</div>
<div class="sect2">
<h3 id="geode-configuration-externalized-session">8.1. Externalized Configuration of Spring Session</h3>
<div class="paragraph">
<p>You can access the externalized configuration of Spring Session when you use Apache Geode as your (HTTP) session state
caching provider.</p>
</div>
<div class="paragraph">
<p>In this case, you need only acquire a reference to an instance of the
<a href="https://docs.spring.io/spring-boot-data-geode-build/current/api//org/springframework/geode/boot/autoconfigure/configuration/SpringSessionProperties.html"><code>SpringSessionProperties</code></a>
class.</p>
</div>
<div class="paragraph">
<p>As shown earlier in this chapter, you can specify Spring Session for Apache Geode (SSDG) properties as follows:</p>
</div>
<div class="exampleblock">
<div class="title">Example 73. Spring Boot <code>application.properties</code> for Spring Session using Apache Geode as the (HTTP) session state caching provider</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="properties"># Spring Boot application.properties used to configure {geode-name} as a (HTTP) session state caching provider
# in Spring Session

spring.session.data.gemfire.session.expiration.max-inactive-interval-seconds=300
spring.session.data.gemfire.session.region.name=UserSessions</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Then, in your application, you can do something similar to the following example:</p>
</div>
<div class="exampleblock">
<div class="title">Example 74. Using <code>SpringSessionProperties</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Component
class MyApplicationComponent {

    @Autowired
    private SpringSessionProperties springSessionProperties;

    public void someMethodUsingSpringSessionProperties() {

        String sessionRegionName = this.springSessionProperties
            .getSession().getRegion().getName();

        // do something with `sessionRegionName`
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="geode-configuration-gemfire-properties">9. Using Geode Properties</h2>
<div class="sectionbody">
<div class="paragraph">
<p>As of Spring Boot for Apache Geode (SBDG) 1.3, you can declare Apache Geode properties from <code>gemfire.properties</code>
in Spring Boot <code>application.properties</code>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
See the <a href="https://geode.apache.org/docs/guide/{apache-geode-doc-version}/reference/topics/gemfire_properties.html">User Guide</a> for a complete list
of valid Apache Geode properties.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Note that you can declare only valid Geode properties in <code>gemfire.properties</code> or, alternatively,
<code>gfsecurity.properties</code>.</p>
</div>
<div class="paragraph">
<p>The following example shows how to declare properties in <code>gemfire.properties</code>:</p>
</div>
<div class="exampleblock">
<div class="title">Example 75. Valid <code>gemfire.properties</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="properties"># Geode Properties in gemfire.properties

name=ExampleCacheName
log-level=TRACE
enable-time-statistics=true
durable-client-id=123
# ...</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>All of the properties declared in the preceding example correspond to valid Geode properties. It is illegal to declare
properties in <code>gemfire.properties</code> that are not valid Geode properties, even if those properties are prefixed with a
different qualifier (such as <code>spring.*</code>). Apache Geode throws an <code>IllegalArgumentException</code> for invalid properties.</p>
</div>
<div class="paragraph">
<p>Consider the following <code>gemfire.properties</code> file with an <code>invalid-property</code>:</p>
</div>
<div class="exampleblock">
<div class="title">Example 76. Invalid <code>gemfire.properties</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="properties"># Geode Properties in gemfire.properties

name=ExampleCacheName
invalid-property=TEST</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Apache Geode throws an <code>IllegalArgumentException</code>:</p>
</div>
<div class="exampleblock">
<div class="title">Example 77. <code>IllegalArgumentException</code> thrown by Apache Geode for Invalid Property (Full Text Omitted)</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="txt">Exception in thread "main" java.lang.IllegalArgumentException: Unknown configuration attribute name invalid-property.
Valid attribute names are: ack-severe-alert-threshold ack-wait-threshold archive-disk-space-limit ...
	at o.a.g.internal.AbstractConfig.checkAttributeName(AbstractConfig.java:333)
	at o.a.g.distributed.internal.AbstractDistributionConfig.checkAttributeName(AbstractDistributionConfig.java:725)
	at o.a.g.distributed.internal.AbstractDistributionConfig.getAttributeType(AbstractDistributionConfig.java:887)
	at o.a.g.internal.AbstractConfig.setAttribute(AbstractConfig.java:222)
	at o.a.g.distributed.internal.DistributionConfigImpl.initialize(DistributionConfigImpl.java:1632)
	at o.a.g.distributed.internal.DistributionConfigImpl.&lt;init&gt;(DistributionConfigImpl.java:994)
	at o.a.g.distributed.internal.DistributionConfigImpl.&lt;init&gt;(DistributionConfigImpl.java:903)
	at o.a.g.distributed.internal.ConnectionConfigImpl.lambda$new$2(ConnectionConfigImpl.java:37)
	at o.a.g.distributed.internal.ConnectionConfigImpl.convert(ConnectionConfigImpl.java:73)
	at o.a.g.distributed.internal.ConnectionConfigImpl.&lt;init&gt;(ConnectionConfigImpl.java:36)
	at o.a.g.distributed.internal.InternalDistributedSystem$Builder.build(InternalDistributedSystem.java:3004)
	at o.a.g.distributed.internal.InternalDistributedSystem.connectInternal(InternalDistributedSystem.java:269)
	at o.a.g.cache.client.ClientCacheFactory.connectInternalDistributedSystem(ClientCacheFactory.java:280)
	at o.a.g.cache.client.ClientCacheFactory.basicCreate(ClientCacheFactory.java:250)
	at o.a.g.cache.client.ClientCacheFactory.create(ClientCacheFactory.java:216)
	at org.example.app.ApacheGeodeClientCacheApplication.main(...)</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>It is inconvenient to have to separate Apache Geode properties from other application properties, or to have to declare
only Apache Geode properties in a <code>gemfire.properties</code> file and application properties in a separate properties file,
such as Spring Boot <code>application.properties</code>.</p>
</div>
<div class="paragraph">
<p>Additionally, because of Apache Geode&#8217;s constraint on properties, you cannot use the full power of Spring Boot when you
compose <code>application.properties</code>.</p>
</div>
<div class="paragraph">
<p>You can include certain properties based on a Spring profile while excluding other properties. This is essential when
properties are environment- or context-specific.</p>
</div>
<div class="paragraph">
<p>Spring Data for Apache Geode already provides a wide range of properties mapping to Apache Geode properties.</p>
</div>
<div class="paragraph">
<p>For example, the SDG <code>spring.data.gemfire.locators</code> property maps to the <code>gemfire.locators</code> property
(<code>locators</code> in <code>gemfire.properties</code>) from Apache Geode. Likewise, there are a full set of SDG properties that map to
the corresponding Apache Geode properties in the <a href="#geode-configuration-metadata-springdata">Appendix</a>.</p>
</div>
<div class="paragraph">
<p>You can express the Geode properties shown earlier as SDG properties in Spring Boot <code>application.properties</code>,
as follows:</p>
</div>
<div class="exampleblock">
<div class="title">Example 78. Configuring Geode Properties using SDG Properties</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="properties"># Spring Data for {geode-name} properties in application.properties

spring.data.gemfire.name=ExampleCacheName
spring.data.gemfire.cache.log-level=TRACE
spring.data.gemfire.cache.client.durable-client-id=123
spring.data.gemfire.stats.enable-time-statistics=true
# ...</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>However, some Apache Geode properties have no equivalent SDG property, such as <code>gemfire.groups</code> (<code>groups</code> in
<code>gemfire.properties</code>). This is partly due to the fact that many Apache Geode properties are applicable only when
configured on the server (such as <code>groups</code> or <code>enforce-unique-host</code>).</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
See the <code>@EnableGemFireProperties</code> annotation
(<a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnableGemFireProperties.html">attributes</a>)
from SDG for a complete list of Apache Geode properties with no corresponding SDG property.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Furthermore, many of the SDG properties also correspond to API calls.</p>
</div>
<div class="paragraph">
<p>For example, <a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/ClientCacheApplication.html#keepAlive"><code>spring.data.gemfire.cache.client.keep-alive</code></a>
translates to the <a href="https://geode.apache.org/releases/latest/javadoc/org/apache/geode/cache/client/ClientCache.html#close-boolean"><code>ClientCache.close(boolean keepAlive)</code></a>
API call.</p>
</div>
<div class="paragraph">
<p>Still, it would be convenient to be able to declare application and Apache Geode properties together, in a single
properties file, such as Spring Boot <code>application.properties</code>. After all, it is not uncommon to declare JDBC Connection
properties in a Spring Boot <code>application.properties</code> file.</p>
</div>
<div class="paragraph">
<p>Therefore, as of SBDG 1.3, you can now declare Apache Geode properties in Spring Boot <code>application.properties</code> directly,
as follows:</p>
</div>
<div class="exampleblock">
<div class="title">Example 79. Geode Properties declared in Spring Boot <code>application.properties</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="properties"># Spring Boot application.properties

server.port=8181
spring.application.name=ExampleApp
gemfire.durable-client-id=123
gemfire.enable-time-statistics=true</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>This is convenient and ideal for several reasons:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If you already have a large number of Apache Geode properties declared as <code>gemfire.</code> properties (either in
<code>gemfire.properties</code> or <code>gfsecurity.properties</code>) or declared on the Java command-line as JVM System properties
(such as <code>-Dgemfire.name=ExampleCacheName</code>), you can reuse these property declarations.</p>
</li>
<li>
<p>If you are unfamiliar with SDG&#8217;s corresponding properties, you can declare Geode properties instead.</p>
</li>
<li>
<p>You can take advantage of Spring features, such as Spring profiles.</p>
</li>
<li>
<p>You can also use property placeholders with Geode properties (such as
<code>gemfire.log-level=${external.log-level.property}</code>).</p>
</li>
</ul>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
We encourage you to use the SDG properties, which cover more than Apache Geode properties.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>However, SBDG requires that the Geode property must have the <code>gemfire.</code> prefix in Spring Boot <code>application.properties</code>.
This indicates that the property belongs to Apache Geode. Without the <code>gemfire.</code> prefix, the property is not
appropriately applied to the Apache Geode cache instance.</p>
</div>
<div class="paragraph">
<p>It would be ambiguous if your Spring Boot applications integrated with several technologies, including Apache Geode,
and they too had matching properties, such as <code>bind-address</code> or <code>log-file</code>.</p>
</div>
<div class="paragraph">
<p>SBDG makes a best attempt to log warnings when a Geode property is invalid or is not set. For example, the following
Geode property would result in logging a warning:</p>
</div>
<div class="exampleblock">
<div class="title">Example 80. Invalid Apache Geode Property</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="properties"># Spring Boot application.properties

spring.application.name=ExampleApp
gemfire.non-existing-property=TEST</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The resulting warning in the log would read:</p>
</div>
<div class="exampleblock">
<div class="title">Example 81. Invalid Geode Property Warning Message</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="text">[gemfire.non-existing-property] is not a valid Apache Geode property</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>If a Geode Property is not properly set, the following warning is logged:</p>
</div>
<div class="exampleblock">
<div class="title">Example 82. Invalide Geode Property Value Warning Message</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="text">Apache Geode Property [gemfire.security-manager] was not set</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>With regards to the third point mentioned earlier, you can now compose and declare Geode properties based on a context
(such as your application environment) using Spring profiles.</p>
</div>
<div class="paragraph">
<p>For example, you might start with a base set of properties in Spring Boot <code>application.properties</code>:</p>
</div>
<div class="exampleblock">
<div class="title">Example 83. Base Properties</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="properties">server.port=8181
spring.application.name=ExampleApp
gemfire.durable-client-id=123
gemfire.enable-time-statistics=false</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Then you can vary the properties by environment, as the next two listings (for QA and production) show:</p>
</div>
<div class="exampleblock">
<div class="title">Example 84. QA Properties</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="properties"># Spring Boot application-qa.properties

server.port=9191
spring.application.name=TestApp
gemfire.enable-time-statistics=true
gemfire.enable-network-partition-detection=true
gemfire.groups=QA
# ...</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 85. Production Properties</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="properties"># Spring Boot application-prod.properties

server.port=80
spring.application.name=ProductionApp
gemfire.archive-disk-space-limit=1000
gemfire.archive-file-size-limit=50
gemfire.enforce-unique-host=true
gemfire.groups=PROD
# ...</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>You can then apply the appropriate set of properties by configuring the Spring profile with
<code>-Dspring.profiles.active=prod</code>. You can also enable more than one profile at a time with
<code>-Dspring.profiles.active=profile1,profile2,&#8230;&#8203;,profileN</code></p>
</div>
<div class="paragraph">
<p>If both <code>spring.data.gemfire.*</code> properties and the matching Apache Geode properties are declared in Spring Boot
<code>application.properties</code>, the SDG properties take precedence.</p>
</div>
<div class="paragraph">
<p>If a property is specified more than once, as would potentially be the case when composing multiple Spring Boot
<code>application.properties</code> files and you enable more than one Spring profile at time, the last property declaration wins.
In the example shown earlier, the value for <code>gemfire.groups</code> would be <code>PROD</code> when <code>-Dspring.profiles.active=qa,prod</code>
is configured.</p>
</div>
<div class="paragraph">
<p>Consider the following Spring Boot <code>application.properties</code>:</p>
</div>
<div class="exampleblock">
<div class="title">Example 86. Property Precedence</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="properties"># Spring Boot application.properties

gemfire.durable-client-id=123
spring.data.gemfire.cache.client.durable-client-id=987</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The <code>durable-client-id</code> is <code>987</code>. It does not matter which order the SDG or Apache Geode properties are declared in
Spring Boot <code>application.properties</code>. The matching SDG property overrides the Apache Geode property when duplicates
are found.</p>
</div>
<div class="paragraph">
<p>Finally, you cannot refer to Geode properties declared in Spring Boot <code>application.properties</code> with the SBDG
<code>GemFireProperties</code> class (see the <a href="https://docs.spring.io/spring-boot-data-geode-build/current/api//org/springframework/geode/boot/autoconfigure/configuration/GemFireProperties.html">Javadoc</a>).</p>
</div>
<div class="paragraph">
<p>Consider the following example:</p>
</div>
<div class="exampleblock">
<div class="title">Example 87. Geode Properties declared in Spring Boot <code>application.properties</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="properties"># Spring Boot application.properties

gemfire.name=TestCacheName</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Given the preceding property, the following assertion holds:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">import org.springframework.geode.boot.autoconfigure.configuration.GemFireProperties;

@RunWith(SpringRunner.class)
@SpringBootTest
class GemFirePropertiesTestSuite {

	@Autowired
    private GemFireProperties gemfireProperties;

	@Test
	public void gemfirePropertiesTestCase() {
		assertThat(this.gemfireProperties.getCache().getName()).isNotEqualTo("TestCacheName");
	}
}</code></pre>
</div>
</div>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
You can declare <code>application.properties</code> in the <code>@SpringBootTest</code> annotation. For example, you could have declared
<code>gemfire.name</code> in the annotation by setting <code>@SpringBootTest(properties = { "gemfire.name=TestCacheName" })</code>
for testing purposes instead of declaring the property in a separate Spring Boot <code>application.properties</code> file.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Only <code>spring.data.gemfire.*</code> prefixed properties are mapped to the SBDG <code>GemFireProperties</code> class hierarchy.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Prefer SDG properties over Geode properties. See the SDG properties reference
in the <a href="#geode-configuration-metadata-springdata">Appendix</a>.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="geode-caching-provider">10. Caching with Apache Geode</h2>
<div class="sectionbody">
<div class="paragraph">
<p>One of the easiest, quickest and least invasive ways to start using Apache Geode in your Spring Boot applications
is to use Apache Geode as a <a href="https://docs.spring.io/spring/docs/current/spring-framework-reference/integration.html#cache-store-configuration">caching provider</a>
in <a href="https://docs.spring.io/spring/docs/current/spring-framework-reference/integration.html#cache">Spring&#8217;s Cache Abstraction</a>. SDG
<a href="https://docs.spring.io/spring/docs/current/spring-framework-reference/integration.html#cache-store-configuration-gemfire">enables</a>
Apache Geode to function as a caching provider in Spring&#8217;s Cache Abstraction.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
See the <em>Spring Data for Apache Geode Reference Guide</em> for more details on
the <a href="https://docs.spring.io/spring-data/geode/docs/current/reference/html/#apis:spring-cache-abstraction">support</a>
and <a href="https://docs.spring.io/spring-data/geode/docs/current/reference/html/#bootstrap-annotation-config-caching">configuration</a>
of Apache Geode as a caching provider in Spring&#8217;s Cache Abstraction.
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Make sure you thoroughly understand the <a href="https://docs.spring.io/spring/docs/current/spring-framework-reference/integration.html#cache-strategies">concepts</a>
behind Spring&#8217;s Cache Abstraction before you continue.
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
See also the relevant section on <a href="https://docs.spring.io/spring-boot/docs/current/reference/html/#boot-features-caching">caching</a>
in Spring Boot&#8217;s reference documentation. Spring Boot even provides auto-configuration support for a few of the simple
<a href="https://docs.spring.io/spring-boot/docs/current/reference/html/#_supported_cache_providers">caching providers</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Indeed, caching can be an effective software design pattern to avoid the cost of invoking a potentially expensive
operation when, given the same input, the operation yields the same output, every time.</p>
</div>
<div class="paragraph">
<p>Some classic examples of caching include, but are not limited to, looking up a customer by name or account number,
looking up a book by ISBN, geocoding a physical address, and caching the calculation of a person&#8217;s credit score
when the person applies for a financial loan.</p>
</div>
<div class="paragraph">
<p>If you need the proven power of an enterprise-class caching solution, with strong consistency, high availability,
low latency, and multi-site (WAN) capabilities, then you should consider <a href="https://geode.apache.org/">Apache Geode</a>.
Alternatively, VMWare, Inc. offers a commercial solution, built on Apache Geode, called VMware Tanzu GemFire.</p>
</div>
<div class="paragraph">
<p>Spring&#8217;s <a href="https://docs.spring.io/spring/docs/current/spring-framework-reference/integration.html#cache-annotations">declarative, annotation-based caching</a> makes it
simple to get started with caching, which is as easy as annotating your application components with the appropriate
Spring cache annotations.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Spring&#8217;s declarative, annotation-based caching also
<a href="https://docs.spring.io/spring/docs/current/spring-framework-reference/integration.html#cache-jsr-107">supports</a> JSR-107 JCache annotations.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For example, suppose you want to cache the results of determining a person&#8217;s eligibility when applying for a loan. A
person&#8217;s financial status is unlikely to change in the time that the computer runs the algorithms to compute a person&#8217;s
eligibility after all the financial information for the person has been collected, submitted for review and processed.</p>
</div>
<div class="paragraph">
<p>Our application might consist of a financial loan service to process a person&#8217;s eligibility over a given period of time:</p>
</div>
<div class="exampleblock">
<div class="title">Example 88. Spring application service component applicable to caching</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Service
class FinancialLoanApplicationService {

    @Cacheable("EligibilityDecisions")
    EligibilityDecision processEligibility(Person person, Timespan timespan) {
        // ...
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Notice the <code>@Cacheable</code> annotation declared on the <code>processEligibility(:Person, :Timespan)</code> method of our service class.</p>
</div>
<div class="paragraph">
<p>When the <code>FinancialLoanApplicationService.processEligibility(..)</code> method is called, Spring&#8217;s caching infrastructure
first consults the "EligibilityDecisions" cache to determine if a decision has already been computed for the given
person within the given span of time. If the person&#8217;s eligibility in the given time frame has already been determined,
the existing decision is returned from the cache. Otherwise, the <code>processEligibility(..)</code> method is invoked
and the result of the method is cached when the method returns, before returning the decision to the caller.</p>
</div>
<div class="paragraph">
<p>Spring Boot for Apache Geode auto-configures Apache Geode as the caching provider when Apache Geode is declared on
the application classpath and when no other caching provider (such as Redis) has been configured.</p>
</div>
<div class="paragraph">
<p>If Spring Boot for Apache Geode detects that another cache provider has already been configured, then Apache Geode
will not function as the caching provider for the application. This lets you configure another store, such as
Redis, as the caching provider and perhaps use Apache Geode as your application&#8217;s persistent store.</p>
</div>
<div class="paragraph">
<p>The only other requirement to enable caching in a Spring Boot application is for the declared caches (as specified
in Spring&#8217;s or JSR-107&#8217;s caching annotations) to have been created and already exist, especially before the operation
on which caching was applied is invoked. This means the backend data store must provide the data structure that serves
as the cache. For Apache Geode, this means a cache <code>Region</code>.</p>
</div>
<div class="paragraph">
<p>To configure the necessary Regions that back the caches declared in Spring&#8217;s cache annotations, use Spring Data
for Apache Geode&#8217;s <a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnableCachingDefinedRegions.html"><code>@EnableCachingDefinedRegions</code></a>
annotation.</p>
</div>
<div class="paragraph">
<p>The following listing shows a complete Spring Boot application:</p>
</div>
<div class="exampleblock">
<div class="title">Example 89. Spring Boot cache enabled application using Apache Geode</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">package example.app;

@SpringBootApplication
@EnableCachingDefinedRegions
class FinancialLoanApplication {

    public static void main(String[] args) {
        SpringApplication.run(FinancialLoanApplication.class, args);
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
The <code>FinancialLoanApplicationService</code> is picked up by Spring&#8217;s classpath component scan, since this class
is annotated with Spring&#8217;s <code>@Service</code> stereotype annotation.
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
You can set the <code>DataPolicy</code> of the Region created through the <code>@EnableCachingDefinedRegions</code> annotation
by setting the <code>clientRegionShortcut</code> attribute to a valid enumerated value.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Spring Boot for Apache Geode does not recognize nor apply the <code>spring.cache.cache-names</code> property. Instead, you
should use SDG&#8217;s <code>@EnableCachingDefinedRegions</code> on an appropriate Spring Boot application <code>@Configuration</code> class.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="geode-caching-provider-look-aside-near-inline-multi-site">10.1. Look-Aside Caching, Near Caching, Inline Caching, and Multi-Site Caching</h3>
<div class="paragraph">
<p>Four different types of caching patterns can be applied with Spring when using Apache Geode for your application caching
needs:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Look-aside caching</p>
</li>
<li>
<p>Near caching</p>
</li>
<li>
<p>[Async] Inline caching</p>
</li>
<li>
<p>Multi-site caching</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Typically, when most users think of caching, they think of Look-aside caching. This is the default caching
pattern applied by Spring&#8217;s Cache Abstraction.</p>
</div>
<div class="paragraph">
<p>In a nutshell, Near caching keeps the data closer to where the data is used, thereby improving on performance due to
lower latencies when data is needed (no extra network hops). This also improves application throughput&#8201;&#8212;&#8201;that is,
the amount of work completed in a given period of time.</p>
</div>
<div class="paragraph">
<p>Within Inline caching_, developers have a choice between synchronous (read/write-through) and asynchronous (write-behind)
configurations depending on the application use case and requirements. Synchronous, read/write-through Inline caching
is necessary if consistency is a concern. Asynchronous, write-behind Inline caching is applicable if throughput
and low-latency are a priority.</p>
</div>
<div class="paragraph">
<p>Within Multi-site caching, there are active-active and active-passive arrangements. More details on Multi-site caching
will be presented in a later release.</p>
</div>
<div class="sect3">
<h4 id="geode-caching-provider-look-aside-caching">10.1.1. Look-Aside Caching</h4>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
See the corresponding sample <a href="guides/caching-look-aside.html">guide</a>
and {github-samples-url}/caching/look-aside[code] to see Look-aside caching with Apache Geode in action.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The caching pattern demonstrated in the preceding example is a form of
<a href="https://content.pivotal.io/blog/an-introduction-to-look-aside-vs-inline-caching-patterns">Look-aside caching</a>
(or "<em>Cache Aside</em>").</p>
</div>
<div class="paragraph">
<p>Essentially, the data of interest is searched for in the cache first, before calling a potentially expensive
operation, such as an operation that makes an IO- or network-bound request that results in either a blocking
or a latency-sensitive computation.</p>
</div>
<div class="paragraph">
<p>If the data can be found in the cache (stored in-memory to reduce latency), the data is returned without ever invoking
the expensive operation. If the data cannot be found in the cache, the operation must be invoked. However, before
returning, the result of the operation is cached for subsequent requests when the same input is requested again by
another caller, resulting in much improved response times.</p>
</div>
<div class="paragraph">
<p>The typical Look-aside caching pattern applied in your Spring application code looks similar to the following:</p>
</div>
<div class="exampleblock">
<div class="title">Example 90. Look-Aside Caching Pattern Applied</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Service
class CustomerService {

  private final CustomerRepository customerRepository;

  @Cacheable("Customers")
  Customer findByAcccount(Account account) {

    // pre-processing logic here

    Customer customer = customerRepository.findByAccoundNumber(account.getNumber());

    // post-processing logic here

    return customer;
  }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>In this design, the <code>CustomerRepository</code> is perhaps a JDBC- or JPA/Hibernate-backed implementation that accesses
the external data source (for example, an RDBMS) directly. The <code>@Cacheable</code> annotation wraps, or "decorates",
the <code>findByAccount(:Account):Customer</code> operation (method) to provide caching behavior.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This operation may be expensive because it may validate the customer&#8217;s account before looking up the customer,
pull multiple bits of information to retrieve the customer record, and so on&#8201;&#8212;&#8201;hence the need for caching.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="geode-caching-provider-near-caching">10.1.2. Near Caching</h4>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
See the corresponding sample <a href="guides/caching-near.html">guide</a> and {github-samples-url}/caching/near[code]
to see Near caching with Apache Geode in action.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Near caching is another pattern of caching where the cache is collocated with the application. This is useful when
the caching technology is configured in a client/server arrangement.</p>
</div>
<div class="paragraph">
<p>We already mentioned that Spring Boot for Apache Geode <a href="clientcache-applications.html#geode-clientcache-applications">provides</a>
an auto-configured <code>ClientCache</code> instance by default. A <code>ClientCache</code> instance is most effective when the data access
operations, including cache access, are distributed to the servers in a cluster that is accessible to the client and,
in most cases, multiple clients. This lets other cache client applications access the same data. However, this also
means the application incurs a network hop penalty to evaluate the presence of the data in the cache.</p>
</div>
<div class="paragraph">
<p>To help avoid the cost of this network hop in a client/server topology, a local cache can be established to maintain
a subset of the data in the corresponding server-side cache (that is, a Region). Therefore, the client cache contains
only the data of interest to the application. This "local" cache (that is, a client-side Region) is consulted before
forwarding the lookup request to the server.</p>
</div>
<div class="paragraph">
<p>To enable Near caching when using Apache Geode, change the Region&#8217;s (that is the <code>Cache</code> in Spring&#8217;s Cache Abstraction)
data management policy from <code>PROXY</code> (the default) to <code>CACHING_PROXY</code>:</p>
</div>
<div class="exampleblock">
<div class="title">Example 91. Enable Near Caching with Apache Geode</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@SpringBootApplication
@EnableCachingDefinedRegions(clientRegionShortcut = ClientRegionShortcut.CACHING_PROXY)
class FinancialLoanApplication {

    public static void main(String[] args) {
        SpringApplication.run(FinancialLoanApplication.class, args);
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
The default client Region data management policy is
<a href="https://geode.apache.org/releases/latest/javadoc/org/apache/geode/cache/client/ClientRegionShortcut.html#PROXY"><code>ClientRegionShortcut.PROXY</code></a>.
As a result, all data access operations are immediately forwarded to the server.
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
See also the Apache Geode documentation concerning
<a href="https://geode.apache.org/docs/guide/{apache-geode-doc-version}/developing/events/how_client_server_distribution_works.html">client/server event distribution</a>
and, specifically, &#8220;Client Interest Registration on the Server,&#8221; which applies when you use client <code>CACHING_PROXY</code>
Regions to manage state in addition to the corresponding server-side Region. This is necessary to receive updates on
entries in the Region that might have been changed by other clients that have access to the same data.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="geode-caching-provider-inline-caching">10.1.3. Inline Caching</h4>
<div class="paragraph">
<p>The next pattern of caching covered in this chapter is Inline caching.</p>
</div>
<div class="paragraph">
<p>You can apply two different configurations of Inline caching to your Spring Boot applications when you use
the Inline caching pattern: synchronous (read/write-through) and asynchronous (write-behind).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Asynchronous (currently) offers only write capabilities, from the cache to the external data source. There is no
option to asynchronously and automatically load the cache when the value becomes available in the external data source.
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="geode-caching-provider-inline-caching-synchronous">Synchronous Inline Caching</h5>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
See the corresponding sample <a href="guides/caching-inline.html">guide</a> and {github-samples-url}/caching/inline[code]
to see Inline caching with Apache Geode in action.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When employing Inline caching and a cache miss occurs, the application service method might not be invoked still, since
a cache can be configured to invoke a loader to load the missing entry from an external data source.</p>
</div>
<div class="paragraph">
<p>With Apache Geode, you can configure the cache (or, to use Apache Geode terminology, the Region) with a
<a href="https://geode.apache.org/releases/latest/javadoc/org/apache/geode/cache/CacheLoader.html"><code>CacheLoader</code></a>. A <code>CacheLoader</code> is implemented to
retrieve missing values from an external data source when a cache miss occurs. The external data source could be
an RDBMS or any other type of data store (for example, another NoSQL data store, such as Apache Cassandra, MongoDB,
or Neo4j).</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
See Apache Geode&#8217;s User Guide on
<a href="https://geode.apache.org/docs/guide/{apache-geode-doc-version}/developing/outside_data_sources/how_data_loaders_work.html">data loaders</a> for more details.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Likewise, you can also configure an Apache Geode Region with a
<a href="https://geode.apache.org/releases/latest/javadoc/org/apache/geode/cache/CacheWriter.html"><code>CacheWriter</code></a>.  A <code>CacheWriter</code> is responsible for
writing an entry that has been put into the Region to the backend data store, such as an RDBMS. This is referred to
as a write-through operation, because it is synchronous. If the backend data store fails to be updated, the entry is
not stored in the Region. This helps to ensure consistency between the backend data store and the Apache Geode Region.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
You can also implement Inline caching using asynchronous write-behind operations by registering
an <a href="https://geode.apache.org/releases/latest/javadoc/org/apache/geode/cache/asyncqueue/AsyncEventListener.html"><code>AsyncEventListener</code></a>
on an <a href="https://geode.apache.org/releases/latest/javadoc/org/apache/geode/cache/asyncqueue/AsyncEventQueue.html"><code>AsyncEventQueue</code></a> attached to
a server-side Region. See Apache Geode&#8217;s User Guide for more
<a href="https://geode.apache.org/docs/guide/{apache-geode-doc-version}/developing/events/implementing_write_behind_event_handler.html">details</a>. We cover asynchronous
write-behind Inline caching in the next section.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The typical pattern of Inline caching when applied to application code looks similar to the following:</p>
</div>
<div class="exampleblock">
<div class="title">Example 92. Inline Caching Pattern Applied</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Service
class CustomerService {

  private CustomerRepository customerRepository;

  Customer findByAccount(Account account) {

      // pre-processing logic here

      Customer customer = customerRepository.findByAccountNumber(account.getNumber());

      // post-processing logic here.

      return customer;
  }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The main difference is that no Spring or JSR-107 caching annotations are applied to the application&#8217;s service methods,
and the <code>CustomerRepository</code> accesses Apache Geode directly and the RDBMS indirectly.</p>
</div>
<div class="sect5">
<h6 id="geode-caching-provider-inline-caching-synchronous-cacheloader-cachewriter">Implementing CacheLoaders and CacheWriters for Inline Caching</h6>
<div class="paragraph">
<p>You can use Spring to configure a <code>CacheLoader</code> or <code>CacheWriter</code> as a bean in the Spring <code>ApplicationContext</code> and then
wire the loader or writer to a Region. Given that the <code>CacheLoader</code> or <code>CacheWriter</code> is a Spring bean like any other
bean in the Spring <code>ApplicationContext</code>, you can inject any <code>DataSource</code> you like into the loader or writer.</p>
</div>
<div class="paragraph">
<p>While you can configure client Regions with <code>CacheLoaders</code> and <code>CacheWriters</code>, it is more common to configure
the corresponding server-side Region:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@SpringBootApplication
@CacheServerApplication
class FinancialLoanApplicationServer {

    public static void main(String[] args) {
        SpringApplication.run(FinancialLoanApplicationServer.class, args);
    }

	@Bean("EligibilityDecisions")
	PartitionedRegionFactoryBean&lt;Object, Object&gt; eligibilityDecisionsRegion(
            GemFireCache gemfireCache, CacheLoader eligibilityDecisionLoader,
            CacheWriter eligibilityDecisionWriter) {

        PartitionedRegionFactoryBean&lt;?, EligibilityDecision&gt; eligibilityDecisionsRegion =
            new PartitionedRegionFactoryBean&lt;&gt;();

        eligibilityDecisionsRegion.setCache(gemfireCache);
        eligibilityDecisionsRegion.setCacheLoader(eligibilityDecisionLoader);
        eligibilityDecisionsRegion.setCacheWriter(eligibilityDecisionWriter);
        eligibilityDecisionsRegion.setPersistent(false);

        return eligibilityDecisionsRegion;
    }

    @Bean
    CacheLoader&lt;?, EligibilityDecision&gt; eligibilityDecisionLoader(
            DataSource dataSource) {

        return new EligibilityDecisionLoader(dataSource);
    }

    @Bean
    CacheWriter&lt;?, EligibilityDecision&gt; eligibilityDecisionWriter(
            DataSource dataSource) {

        return new EligibilityDecisionWriter(dataSource);
    }

    @Bean
    DataSource dataSource() {
      // ...
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Then you could implement the <a href="https://geode.apache.org/releases/latest/javadoc/org/apache/geode/cache/CacheLoader.html"><code>CacheLoader</code></a>
and <a href="https://geode.apache.org/releases/latest/javadoc/org/apache/geode/cache/CacheWriter.html"><code>CacheWriter</code></a> interfaces, as appropriate:</p>
</div>
<div class="exampleblock">
<div class="title">Example 93. EligibilityDecisionLoader</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">class EligibilityDecisionLoader implements CacheLoader&lt;?, EligibilityDecision&gt; {

  private final DataSource dataSource;

  EligibilityDecisionLoader(DataSource dataSource) {
    this.dataSource = dataSource;
  }

  public EligibilityDecision load(LoadHelper&lt;?, EligibilityDecision&gt; helper) {

    Object key = helper.getKey();

    // Use the configured DataSource to load the EligibilityDecision identified by the key
    // from a backend, external data store.
  }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
SBDG provides the <code>org.springframework.geode.cache.support.CacheLoaderSupport</code> <code>@FunctionalInterface</code> to
conveniently implement application <code>CacheLoaders</code>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If the configured <code>CacheLoader</code> still cannot resolve the value, the cache lookup operation results in a cache miss
and the application service method is then invoked to compute the value:</p>
</div>
<div class="exampleblock">
<div class="title">Example 94. EligibilityDecisionWriter</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">class EligibilityDecisionWriter implements CacheWriter&lt;?, EligibilityDecision&gt; {

  private final DataSource dataSource;

  EligibilityDecisionWriter(DataSource dataSource) {
    this.dataSource = dataSource;
  }

  public void beforeCreate(EntryEvent&lt;?, EligiblityDecision&gt; entryEvent) {
    // Use configured DataSource to save (e.g. INSERT) the entry value into the backend data store
  }

  public void beforeUpdate(EntryEvent&lt;?, EligiblityDecision&gt; entryEvent) {
    // Use the configured DataSource to save (e.g. UPDATE or UPSERT) the entry value into the backend data store
  }

  public void beforeDestroy(EntryEvent&lt;?, EligiblityDecision&gt; entryEvent) {
    // Use the configured DataSource to delete (i.e. DELETE) the entry value from the backend data store
  }

  // ...
}</code></pre>
</div>
</div>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
SBDG provides the <code>org.springframework.geode.cache.support.CacheWriterSupport</code> interface to conveniently implement
application <code>CacheWriters</code>.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Your <code>CacheWriter</code> implementation can use any data access technology to interface with your backend data store
(for example JDBC, Spring&#8217;s <code>JdbcTemplate</code>, JPA with Hibernate, and others). It is not limited to using only a
<code>javax.sql.DataSource</code>. In fact, we present another, more useful and convenient approach to implementing Inline caching
in the next section.
</td>
</tr>
</table>
</div>
</div>
<div class="sect5">
<h6 id="geode-caching-provider-inline-caching-synchronous-using-spring-data-repositories">Inline Caching with Spring Data Repositories</h6>
<div class="paragraph">
<p>Spring Boot for Apache Geode offers dedicated support to configure Inline caching with Spring Data Repositories.</p>
</div>
<div class="paragraph">
<p>This is powerful, because it lets you:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Access any backend data store supported by Spring Data (such as Redis for key-value or other distributed data
structures, MongoDB for documents, Neo4j for graphs, Elasticsearch for search, and so on).</p>
</li>
<li>
<p>Use complex mapping strategies (such as ORM provided by JPA with Hibernate).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>We believe that users should store data where it is most easily accessible. If you access and process documents,
then MongoDB, Couchbase, or another document store is probably going to be the most logical choice to manage
your application&#8217;s documents.</p>
</div>
<div class="paragraph">
<p>However, this does not mean that you have to give up Apache Geode in your application/system architecture. You can use
each data store for what it is good at. While MongoDB is excellent at handling documents, Apache Geode is a valuable
choice for consistency, high-availability/low-latency, high-throughput, multi-site, scale-out application use cases.</p>
</div>
<div class="paragraph">
<p>As such, using Apache Geode&#8217;s <code>CacheLoader</code> and <code>CacheWriter</code> provides a nice integration point between itself and other
data stores to best serve your application&#8217;s use case and requirements.</p>
</div>
<div class="paragraph">
<p>Suppose you use JPA and Hibernate to access data managed in an Oracle database. Then, you can configure Apache Geode to
read/write-through to the backend Oracle database when performing cache (Region) operations by delegating to a
Spring Data JPA Repository.</p>
</div>
<div class="paragraph">
<p>The configuration might look something like:</p>
</div>
<div class="exampleblock">
<div class="title">Example 95. Inline caching configuration using SBDG</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@SpringBootApplication
@EntityScan(basePackageClasses = Customer.class)
@EnableEntityDefinedRegions(basePackageClasses = Customer.class)
@EnableJpaRepositories(basePackageClasses = CustomerRepository.class)
class SpringBootOracleDatabaseApacheGeodeApplication {

  @Bean
  InlineCachingRegionConfigurer&lt;Customer, Long&gt; inlineCachingForCustomersRegionConfigurer(
      CustomerRepository customerRepository) {

    return new InlineCachingRegionConfigurer&lt;&gt;(customerRepository, Predicate.isEqual("Customers"));
  }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>SBDG provides the <code>InlineCachingRegionConfigurer&lt;ENTITY, ID&gt;</code> interface.</p>
</div>
<div class="paragraph">
<p>Given a <code>Predicate</code> to express the criteria used to match the target Region by name and a Spring Data <code>CrudRepository</code>,
the <code>InlineCachingRegionConfigurer</code> configures and adapts the Spring Data <code>CrudRepository</code> as a <code>CacheLoader</code>
and <code>CacheWriter</code> registered on the Region (for example, "Customers") to enable Inline caching functionality.</p>
</div>
<div class="paragraph">
<p>You need only declare <code>InlineCachingRegionConfigurer</code> as a bean in the Spring <code>ApplicationContext</code> and make
the association between the Region (by name) and the appropriate Spring Data <code>CrudRepository</code>.</p>
</div>
<div class="paragraph">
<p>In this example, we used JPA and Spring Data JPA to store and retrieve data stored in the cache (Region) to and from
a backend database. However, you can inject any Spring Data Repository for any data store (Redis, MongoDB, and others)
that supports the Spring Data Repository abstraction.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
If you want only to support one-way data access operations when you use Inline caching, you can use either
the <code>RepositoryCacheLoaderRegionConfigurer</code> for reads or the <code>RepositoryCacheWriterRegionConfigurer</code> for writes,
instead of the <code>InlineCachingRegionConfigurer</code>, which supports both reads and writes.
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
To see a similar implementation of Inline caching with a database (an in-memory HSQLDB database) in action, see the
<a href="https://github.com/spring-projects/spring-boot-data-geode/blob/master/spring-geode/src/test/java/org/springframework/geode/cache/inline/database/InlineCachingWithDatabaseIntegrationTests.java"><code>InlineCachingWithDatabaseIntegrationTests</code></a>
test class from the SBDG test suite. A dedicated sample will be provided in a future release.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect4">
<h5 id="geode-caching-provider-inline-caching-asynchronous">Asynchronous Inline Caching</h5>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
See the corresponding sample <a href="guides/caching-inline-async.html">guide</a>
and {github-samples-url}/caching/inline-async[code] to see asynchronous Inline caching with Apache Geode in action.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If consistency between the cache and your external data source is not a concern, and you need only write from the cache
to the backend data store periodically, you can employ asynchronous (write-behind) Inline caching.</p>
</div>
<div class="paragraph">
<p>As the term, "write-behind", implies, a write to the backend data store is asynchronous and not strictly tied to the
cache operation. As a result, the backend data store is in an "eventually consistent" state, since the cache is
primarily used by the application at runtime to access and manage data. In this case, the backend data store is used
to persist the state of the cache (and that of the application) at periodic intervals.</p>
</div>
<div class="paragraph">
<p>If multiple applications are updating the backend data store concurrently, you could combine a <code>CacheLoader</code>
to synchronously read through to the backend data store and keep the cache up-to-date as well as asynchronously
write behind from the cache to the backend data store when the cache is updated to eventually inform other interested
applications of data changes. In this capacity, the backend data store is still the primary System of Record (SoR).</p>
</div>
<div class="paragraph">
<p>If data processing is not time sensitive, you can gain a performance advantage from quantity-based or time-based
batch updates.</p>
</div>
<div class="sect5">
<h6 id="geode-caching-provider-inline-caching-asynchronous-asynceventlistener">Implementing an AsyncEventListener for Inline Caching</h6>
<div class="paragraph">
<p>If you were to configure asynchronous, write-behind Inline caching by hand, you would need to do the following yourself:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Implement an <code>AsyncEventListener</code> to write to an external data source on cache events.</p>
</li>
<li>
<p>Configure and register the listener with an <code>AsyncEventQueue</code> (AEQ).</p>
</li>
<li>
<p>Create a Region to serve as the source of cache events and attach the AEQ to the Region.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The advantage of this approach is that you have access to and control over low-level configuration details.
The disadvantage is that with more moving parts, it is easier to make errors.</p>
</div>
<div class="paragraph">
<p>Following on from our synchronous, read/write-through, Inline caching examples from the prior sections,
our <code>AsyncEventListener</code> implementation might appear as follows:</p>
</div>
<div class="exampleblock">
<div class="title">Example 96. Example <code>AsyncEventListener</code> for Asynchronous, Write-Behind Inline Caching</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Component
class ExampleAsyncEventListener implements AsyncEventListener {

	private final DataSource dataSource;

	ExampleAsyncEventListener(DataSoruce dataSource) {
		this.dataSource = dataSource;
	}

	@Override
	public boolean processEvents(List&lt;AsyncEvent&gt; events) {

        // Iterate over the ordered AsyncEvents and use the configured DataSource
        // to write to the external, backend DataSource

	}
}</code></pre>
</div>
</div>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Instead of directly injecting a <code>DataSource</code> into your <code>AsyncEventListener</code>, you could use JDBC, Spring&#8217;s
<code>JdbcTemplate</code>, JPA and Hibernate, or another data access API or framework. Later in this chapter, we show how SBDG
simplifies the <code>AsyncEventListener</code> implementation by using Spring Data Repositories.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Then we need to register this listener with an <code>AsyncEventQueue</code> (step 2 from the procedure shown earlier) and attach it
to the target Region that will be the source of the cache events we want to persist asynchronously (step 3):</p>
</div>
<div class="exampleblock">
<div class="title">Example 97. Create and Configure an <code>AsyncEventQueue</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Configuration
@PeerCacheApplication
class GeodeConfiguration {

	@Bean
    DataSource exampleDataSource() {
		// Construct and configure a data store specific DataSource
    }

	@Bean
    ExampleAsyncEventListener exampleAsyncEventListener(DataSource dataSource) {
		return new ExampleAsyncEventListener(dataSource);
    }

	@Bean
    AsyncEventQueueFactoryBean exampleAsyncEventQueue(Cache peerCache, ExampleAsyncEventListener listener) {

		AsyncEventQueueFactoryBean asyncEventQueue = new AsyncEventQueueFactoryBean(peerCache, listener);

		asyncEventQueue.setBatchConflationEnabled(true);
		asyncEventQueue.setBatchSize(50);
		asyncEventQueue.setBatchTimeInterval(15000); // 15 seconds
        asyncEventQueue.setMaximumQueueMemory(64); // 64 MB
        // ...

		return asyncEventQueue;
    }

    @Bean("Example")
    PartitionedRegionFactoryBean&lt;?, ?&gt; exampleRegion(Cache peerCache, AsyncEventQueue queue) {

        PartitionedRegionFactoryBean&lt;?, ?&gt; exampleRegion = new PartitionedRegionFactoryBean&lt;&gt;();

        exampleRegion.setAsyncEventQueues(ArrayUtils.asArray(queue));
        exampleRegion.setCache(peerCache);
        // ...

        return exampleRegion;
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>While this approach affords you a lot of control over the low-level configuration, in addition to
your <code>AsyncEventListener</code> implementation, this is a lot of boilerplate code.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
See the Javadoc for SDG&#8217;s
<a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/wan/AsyncEventQueueFactoryBean.html"><code>AsyncEventQueueFactoryBean</code></a>
for more detail on the configuration of the AEQ.
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
See Apache Geode&#8217;s <a href="https://geode.apache.org/docs/guide/{apache-geode-doc-version}/developing/events/implementing_write_behind_event_handler.html">User Guide</a>
for more details on AEQs and listeners.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Fortunately, with SBDG, there is a better way.</p>
</div>
</div>
<div class="sect5">
<h6 id="geode-caching-provider-inline-caching-asynchronous-using-spring-data-repositories">Asynchronous Inline Caching with Spring Data Repositories</h6>
<div class="paragraph">
<p>The implementation and configuration of the <code>AsyncEventListener</code> as well as the AEQ shown in
the <a href="#geode-caching-provider-inline-caching-asynchronous-asynceventlistener">preceding section</a>
can be simplified as follows:</p>
</div>
<div class="exampleblock">
<div class="title">Example 98. Using SBDG to configure Asynchronous, Write-Behind Inline Caching</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@SpringBootApplication
@EntityScan(basePackageClasses = ExampleEntity.class)
@EnableJpaRepositories(basePackageClasses = ExampleRepository.class)
@EnableEntityDefinedRegions(basePackageClasses = ExampleEnity.class)
class ExampleSpringBootApacheGeodeAsyncInlineCachingApplication {

	@Bean
    AsyncInlineCachingRegionConfigurer asyncInlineCachingRegionConfigurer(
    	    CrudRepository&lt;ExampleEntity, Long&gt; repository) {

		return AsyncInlineCachingRegionConfigurer.create(repository, "Example")
            .withQueueBatchConflationEnabled()
            .withQueueBatchSize(50)
            .withQueueBatchTimeInterval(Duration.ofSeconds(15))
            .withQueueMaxMemory(64);
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The <code>AsyncInlineCachingRegionConfigurer.create(..)</code> method is overloaded to accept a <code>Predicate</code> in place of the <code>String</code>
to programmatically express more powerful matching logic and identify the target Region (by name) on which to configure
asynchronous Inline caching functionality.</p>
</div>
<div class="paragraph">
<p>The <code>AsyncInlineCachingRegionConfigurer</code> uses the <a href="https://en.wikipedia.org/wiki/Builder_pattern">Builder software design pattern</a>
and <code>withQueue*(..)</code> builder methods to configure the underlying <code>AsyncEventQueue</code> (AEQ) when the queue&#8217;s configuration
deviates from the defaults, as specified by Apache Geode.</p>
</div>
<div class="paragraph">
<p>Under the hood, the <code>AsyncInlineCachingRegionConfigurer</code> constructs a new instance of the <code>RepositoryAsyncEventListener</code>
class initialized with the given Spring Data <code>CrudRepository</code>. The <code>RegionConfigurer</code> then registers the listener with
the AEQ and attaches it to the target <code>Region</code>.</p>
</div>
<div class="paragraph">
<p>With the power of Spring Boot auto-configuration and SBDG, the configuration is much more concise and intuitive.</p>
</div>
</div>
<div class="sect5">
<h6 id="geode-caching-provider-inline-caching-asynchronous-listener">About <code>RepositoryAsyncEventListener</code></h6>
<div class="paragraph">
<p>The SBDG <code>RepositoryAsyncEventListener</code> class is the magic ingredient behind the integration of the cache with
an external data source.</p>
</div>
<div class="paragraph">
<p>The listener is a specialized <a href="https://en.wikipedia.org/wiki/Adapter_pattern">adapter</a> that processes <code>AsyncEvents</code> by
invoking an appropriate <code>CrudRepository</code> method based on the cache operation. The listener requires an instance of
<code>CrudRepository</code>. The listener supports any external data source supported by Spring Data&#8217;s Repository abstraction.</p>
</div>
<div class="paragraph">
<p>Backend data store, data access operations (such as INSERT, UPDATE, DELETE, and so on) triggered by cache events
are performed asynchronously from the cache operation. This means the state of the cache and backend data store
will be "eventually consistent".</p>
</div>
<div class="paragraph">
<p>Given the complex nature of "eventually consistent" systems and asynchronous concurrent processing, the
<code>RepositoryAsyncEventListener</code> lets you register a custom <code>AsyncEventErrorHandler</code> to handle the errors that occur
during processing of <code>AsyncEvents</code>, perhaps due to a faulty backend data store data access operation (such as
<code>OptimisticLockingFailureException</code>), in an application-relevant way.</p>
</div>
<div class="paragraph">
<p>The <code>AsyncEventErrorHandler</code> interface is a <code>java.util.function.Function</code> implementation and <code>@FunctionalInterface</code>
defined as:</p>
</div>
<div class="exampleblock">
<div class="title">Example 99. AsyncEventErrorHandler interface definition</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@FunctionalInterface
interface AsyncEventErrorHandler implements Function&lt;AsyncEventError, Boolean&gt; { }</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The <code>AsyncEventError</code> class encapsulates <code>AsyncEvent</code> along with the <code>Throwable</code> that was thrown while processing
the <code>AsyncEvent</code>.</p>
</div>
<div class="paragraph">
<p>Since the <code>AsyncEventErrorHandler</code> interface implements <code>Function</code>, you should override the <code>apply(:AsyncEventError)</code>
method to handle the error with application-specific actions. The handler returns a <code>Boolean</code> to indicate whether it
was able to handle the error or not:</p>
</div>
<div class="exampleblock">
<div class="title">Example 100. Custom <code>AsyncEventErrorHandler</code> implementation</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">class CustomAsyncEventErrorHandler implements AsyncEventErrorHandler {

	@Override
    public Boolean apply(AsyncEventError error) {

		if (error.getCause() instanceof OptimisticLockingFailureException) {
			// handle optimistic locking failure if you can
            return true; // if error was successfully handled
		}
		else if (error.getCause() instanceof IncorrectResultSizeDataAccessException) {
			// handle no row or too many row update if you can
            return true; // if error was successfully handled
		}
		else {
			// ...
		}

		return false;
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>You can configure the <code>RepositoryAsyncEventListener</code> with your custom <code>AsyncEventErrorHandler</code> by using the
<code>AsyncInlineCachingRegionConfigurer</code>:</p>
</div>
<div class="exampleblock">
<div class="title">Example 101. Configuring a custom <code>AsyncEventErrorHandler</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Configuration
class GeodeConfiguration {

	@Bean
	CustomAsyncEventErrorHandler customAsyncEventErrorHandler() {
		return new CustomAsyncEventErrorHandler();
	}

	@Bean
    AsyncInlineCachingRegionConfigurer asyncInlineCachingRegionConfigurer(
    	    CrudRepository&lt;?, ?&gt; repository,
            CustomAsyncEventErrorHandler errorHandler) {

		return AsyncInlineCachingRegionConfigurer.create(repository, "Example")
            .withAsyncEventErrorHandler(errorHandler);
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Also, since <code>AsyncEventErrorHandler</code> implements <code>Function</code>, you can <a href="https://en.wikipedia.org/wiki/Composite_pattern">compose</a>
multiple error handlers by using <a href="https://docs.oracle.com/en/java/javase/17/docs/api//java/util/function/Function.html#andThen-java.util.function.Function-"><code>Function.andThen(:Function)</code></a>.</p>
</div>
<div class="paragraph">
<p>By default, the <code>RepositoryAsyncEventListener</code> handles <code>CREATE</code>, <code>UPDATE</code>, and <code>REMOVE</code> cache event, entry operations.</p>
</div>
<div class="paragraph">
<p><code>CREATE</code> and <code>UPDATE</code> translate to <code>CrudRepository.save(entity)</code>. The <code>entity</code> is derived from
<code>AsyncEvent.getDeserializedValue()</code>.</p>
</div>
<div class="paragraph">
<p><code>REMOVE</code> translates to <code>CrudRepository.delete(entity)</code>. The <code>entity</code> is derived from
<code>AsyncEvent.getDeserializedValue()</code>.</p>
</div>
<div class="paragraph">
<p>The cache <a href="https://geode.apache.org/releases/latest/javadoc/org/apache/geode/cache/Operation.html"><code>Operation</code></a> to <code>CrudRepository</code> method is
supported by the <code>AsyncEventOperationRepositoryFunction</code> interface, which implements <code>java.util.function.Function</code>
and is a <code>@FunctionalInterface</code>.</p>
</div>
<div class="paragraph">
<p>This interface becomes useful if and when you want to implement <code>CrudRepository</code> method invocations for other
<code>AsyncEvent</code> <code>Operations</code> not handled by SBDG&#8217;s <code>RepositoryAsyncEventListener</code>.</p>
</div>
<div class="paragraph">
<p>The <code>AsyncEventOperationRepositoryFunction</code> interface is defined as follows:</p>
</div>
<div class="exampleblock">
<div class="title">Example 102. AsyncEventOperationRepositoryFunction interface definition</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@FunctionalInterface
interface AsyncEventOperationRepositoryFunction&lt;T, ID&gt; implements Function&lt;AsyncEvent&lt;ID, T&gt;,  Boolean&gt; {

	default boolean canProcess(AsyncEvent&lt;ID, T&gt; event) {
		return false;
	}
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p><code>T</code> is the class type of the entity and <code>ID</code> is the class type of the entity&#8217;s identifier (ID), possibly declared with
Spring Data&#8217;s <a href="https://docs.spring.io/spring-data/commons/docs/current/api/org/springframework/data/annotation/Id.html"><code>org.springframework.data.annotation.Id</code></a>
annotation.</p>
</div>
<div class="paragraph">
<p>For convenience, SBDG provides the <code>AbstractAsyncEventOperationRepositoryFunction</code> class for extension, where you can
provide implementations for the <code>cacheProcess(:AsyncEvent)</code> and <code>doRepositoryOp(entity)</code> methods.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <code>AsyncEventOperationRepositoryFunction.apply(:AsyncEvent)</code> method is already implemented in terms of
<code>canProcess(:AsyncEvent)</code>, <code>resolveEntity(:AsyncEvent)</code>, <code>doRepositoryOp(entity)</code>, and catching and handling
any <code>Throwable</code> (errors) by calling the configured <code>AsyncEventErrorHandler</code>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For example, you may want to handle <a href="https://geode.apache.org/releases/latest/javadoc/org/apache/geode/cache/Operation.html#INVALIDATE"><code>Operation.INVALIDATE</code></a>
cache events as well, deleting the entity from the backend data store by invoking the <code>CrudRepository.delete(entity)</code>
method:</p>
</div>
<div class="exampleblock">
<div class="title">Example 103. Handling <code>AsyncEvent</code>, <code>Operation.INVALIDATE</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Component
class InvalidateAsyncEventRepositoryFunction
        extends RepositoryAsyncEventListener.AbstractAsyncEventOperationRepositoryFunction&lt;?, ?&gt; {

	InvalidateAsyncEventRepositoryFunction(RepositoryAsyncEventListener&lt;?, ?&gt; listener) {
		super(listener);
	}

	@Override
	public boolean canProcess(AsyncEvent&lt;?, ?&gt; event) {
		return event != null &amp;&amp; Operation.INVALIDATE.equals(event.getOperation());
	}


	@Override
	protected Object doRepositoryOperation(Object entity) {
		getRepository().delete(entity);
		return null;
	}
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>You can then register your user-defined, <code>AsyncEventOperationRepositoryFunction</code> (that is,
<code>InvalidateAsyncEventRepositoryFunction</code>) with the <code>RepositoryAsyncEventListener</code> by using
the <code>AsyncInlineCachingRegionConfigurer</code>:</p>
</div>
<div class="exampleblock">
<div class="title">Example 104. Configuring a user-defined <code>AsyncEventOperationRepositoryFunction</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">import org.springframework.geode.cache.RepositoryAsyncEventListener;

@Configuration
class GeodeConfiguration {

	@Bean
    AsyncInlineCachingRegionConfigurer asyncInlineCachingRegionConfigurer(
    	    CrudRepository&lt;?, ?&gt; repository,
            CustomAsyncEventErrorHandler errorHandler ) {

		return AsyncInlineCachingRegionConfigurer.create(repository, "ExampleRegion")
            .applyToListener(listener -&gt; {

            	if (listener instanceof RepositoryAsyncEventListener) {

            		RepositoryAsyncEventListener&lt;?, ?&gt; repositoryListener =
                        (RepositoryAsyncEventListener&lt;?, ?&gt;) listener;

             		repositoryListener.register(new InvalidAsyncEventRepositoryFunction(repositoryListener));
            	}

            	return listener;
            });
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>This same technique can be applied to <code>CREATE</code>, <code>UPDATE</code>, and <code>REMOVE</code> cache operations as well, effectively overriding
the default behavior for these cache operations handled by SBDG.</p>
</div>
</div>
<div class="sect5">
<h6 id="geode-caching-provider-inline-caching-asynchronous-region-configurer">About <code>AsyncInlineCachingRegionConfigurer</code></h6>
<div class="paragraph">
<p>As we saw in the previous section, you can intercept and post-process the essential components that are constructed
and configured by the <code>AsyncInlineCachingRegionConfigurer</code> class during initialization.</p>
</div>
<div class="paragraph">
<p>SBDG&#8217;s lets you intercept and post-process the <code>AsyncEventListener</code> (such as <code>RepositoryAsyncEventListener</code>),
the <code>AsyncEventQueueFactory</code> and even the <code>AsyncEventQueue</code> created by the <code>AsyncInlineCachingRegionConfigurer</code>
(a SDG <a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/RegionConfigurer.html"><code>RegionConfigurer</code></a>)
during Spring <code>ApplicationContext</code> bean initialization.</p>
</div>
<div class="paragraph">
<p>The <code>AsyncInlineCachingRegionConfigurer</code> class provides the following builder methods to intercept and post-process any
of the following Apache Geode objects:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>applyToListener(:Function&lt;AsyncEventListener, AsyncEventListener&gt;)</code></p>
</li>
<li>
<p><code>applyToQueue(:Function&lt;AsyncEventQueue, AsyncEventQueue&gt;)</code></p>
</li>
<li>
<p><code>applyToQueueFactory(:Function&lt;AsyncEventQueueFactory, AsyncEventQueueFactory&gt;)</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>All of these <code>apply*</code> methods accept a <code>java.util.function.Function</code> that applies the logic of the <code>Function</code> to
the Apache Geode object (such as <code>AsyncEventListener</code>), returning the object as a result.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
The Apache Geode object returned by the <code>Function</code> may be the same object, a proxy, or a completely new object.
Essentially, the returned object can be anything you want. This is the fundamental premise behind Aspect-Oriented
Programming (AOP) and the <a href="https://en.wikipedia.org/wiki/Decorator_pattern">Decorator software design pattern</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <code>apply*</code> methods and the supplied <code>Function</code> let you decorate, enhance, post-process, or otherwise modify
the Apache Geode objects created by the configurer.</p>
</div>
<div class="paragraph">
<p>The <code>AsyncInlineCachingRegionConfigurer</code> strictly adheres to
the <a href="https://en.wikipedia.org/wiki/Open%E2%80%93closed_principle">open/close principle</a>
and is, therefore, flexibly extensible.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="geode-caching-provider-multi-site-caching">10.1.4. Multi-Site Caching</h4>
<div class="paragraph">
<p>The final pattern of caching presented in this chapter is Multi-site caching.</p>
</div>
<div class="paragraph">
<p>As described earlier, there are two configuration arrangements, depending on your application usage patterns,
requirements and user demographic: active-active and active-passive.</p>
</div>
<div class="paragraph">
<p>Multi-site caching, along with active-active and active-passive configuration arrangements, are described in more detail
in the sample <a href="guides/caching-multi-site.html">guide</a>. Also, be sure to review the sample
{github-samples-url}/caching/multi-site[code].</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="geode-caching-provider-advanced-configuration">10.2. Advanced Caching Configuration</h3>
<div class="paragraph">
<p>Apache Geode supports additional caching capabilities to manage the entries stored in the cache.</p>
</div>
<div class="paragraph">
<p>As you can imagine, given that cache entries are stored in-memory, it becomes important to manage and monitor
the available memory used by the cache. After all, by default, Apache Geode stores data in the JVM Heap.</p>
</div>
<div class="paragraph">
<p>You can employ several techniques to more effectively manage memory, such as using
<a href="https://geode.apache.org/docs/guide/{apache-geode-doc-version}/developing/eviction/chapter_overview.html">eviction</a>, possibly
<a href="https://geode.apache.org/docs/guide/{apache-geode-doc-version}/developing/storing_data_on_disk/chapter_overview.html">overflowing data to disk</a>,
configuring both entry Idle-Timeout_ (TTI) and Time-to-Live_ (TTL)
<a href="https://geode.apache.org/docs/guide/{apache-geode-doc-version}/developing/expiration/chapter_overview.html">expiration policies</a>,
configuring <a href="https://geode.apache.org/docs/guide/{apache-geode-doc-version}/managing/region_compression.html">compression</a>,
and using <a href="https://geode.apache.org/docs/guide/{apache-geode-doc-version}/managing/heap_use/off_heap_management.html">off-heap</a>
or main memory.</p>
</div>
<div class="paragraph">
<p>You can use several other strategies as well, as described in
<a href="https://geode.apache.org/docs/guide/{apache-geode-doc-version}/managing/heap_use/heap_management.html">Managing Heap and Off-heap Memory</a>.</p>
</div>
<div class="paragraph">
<p>While this is beyond the scope of this document, know that Spring Data for Apache Geode makes all of these
<a href="https://docs.spring.io/spring-data/geode/docs/current/reference/html/#bootstrap-annotation-config-regions">configuration options</a> available to you.</p>
</div>
</div>
<div class="sect2">
<h3 id="geode-caching-provider-disable">10.3. Disable Caching</h3>
<div class="paragraph">
<p>There may be cases where you do not want your Spring Boot application to cache application state with
<a href="https://docs.spring.io/spring/docs/current/spring-framework-reference/integration.html#cache">Spring&#8217;s Cache Abstraction</a> using Apache Geode. In certain cases,
you may use another Spring supported caching provider, such as Redis, to cache and manage your application state.
In other cases, you may not want to use Spring&#8217;s Cache Abstraction at all.</p>
</div>
<div class="paragraph">
<p>Either way, you can specifically call out your Spring Cache Abstraction provider by using the <code>spring.cache.type</code>
property in <code>application.properties</code>:</p>
</div>
<div class="exampleblock">
<div class="title">Example 105. Use Redis as the Spring Cache Abstraction Provider</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="txt">#application.properties

spring.cache.type=redis
...</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>If you prefer not to use Spring&#8217;s Cache Abstraction to manage your Spring Boot application&#8217;s state at all, then set
the <code>spring.cache.type</code> property to "none":</p>
</div>
<div class="exampleblock">
<div class="title">Example 106. Disable Spring&#8217;s Cache Abstraction</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="txt">#application.properties

spring.cache.type=none
...</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>See the Spring Boot <a href="https://docs.spring.io/spring-boot/docs/current/reference/html/boot-features-caching.html#boot-features-caching-provider-none">documentation</a>
for more detail.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
You can include multiple caching providers on the classpath of your Spring Boot application. For instance,
you might use Redis to cache your application&#8217;s state while using Apache Geode as your application&#8217;s persistent
data store (that is, the System of Record (SOR)).
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Spring Boot does not properly recognize <code>spring.cache.type=[gemfire|geode]</code>, even though Spring Boot
for Apache Geode is set up to handle either of these property values (that is, either <code>gemfire</code> or <code>geode</code>).
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="geode-data-access-region-templates">11. Data Access with GemfireTemplate</h2>
<div class="sectionbody">
<div class="paragraph">
<p>There are several ways to access data stored in Apache Geode.</p>
</div>
<div class="paragraph">
<p>For instance, you can use the <a href="https://geode.apache.org/releases/latest/javadoc/org/apache/geode/cache/Region.html">Region API</a> directly. If you
are driven by the application&#8217;s domain context, you can use the power of
<a href="https://docs.spring.io/spring-data/commons/docs/current/reference/html/#repositories">Spring Data Repositories</a> instead.</p>
</div>
<div class="paragraph">
<p>While the Region API offers flexibility, it couples your application to Apache Geode, which is usually undesirable
and unnecessary. While using Spring Data Repositories provides a very powerful and convenient abstraction, you give up
the flexibility provided by a lower-level Region API.</p>
</div>
<div class="paragraph">
<p>A good compromise is to use the <a href="https://en.wikipedia.org/wiki/Template_method_pattern">Template software design pattern</a>.
This pattern is consistently and widely used throughout the entire Spring portfolio.</p>
</div>
<div class="paragraph">
<p>For example, the Spring Framework provides <a href="https://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/jdbc/core/JdbcTemplate.html"><code>JdbcTemplate</code></a>
and <a href="https://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/jms/core/JmsTemplate.html"><code>JmsTemplate</code></a>.</p>
</div>
<div class="paragraph">
<p>Other Spring Data modules, such as Spring Data Redis, offer the
<a href="https://docs.spring.io/spring-data/redis/docs/current/api/org/springframework/data/redis/core/RedisTemplate.html"><code>RedisTemplate</code></a>,
and Spring Data for Apache Geode (SDG) itself offers the
<a href="https://docs.spring.io/spring-data/gemfire/docs/current/api/org/springframework/data/gemfire/GemfireTemplate.html"><code>GemfireTemplate</code></a>.</p>
</div>
<div class="paragraph">
<p>The <code>GemfireTemplate</code> provides a highly consistent and familiar API to perform data access operations on Apache Geode
cache <code>Regions</code>.</p>
</div>
<div class="paragraph">
<p><code>GemfireTemplate</code> offers:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A simple and convenient data access API to perform basic CRUD and simple query operations on cache Regions.</p>
</li>
<li>
<p>Use of Spring Framework&#8217;s consistent data access <a href="https://docs.spring.io/spring/docs/current/spring-framework-reference/data-access.html#dao-exceptions">Exception hierarchy</a>.</p>
</li>
<li>
<p>Automatic enlistment in the presence of local cache transactions.</p>
</li>
<li>
<p>Consistency and protection from <a href="https://geode.apache.org/releases/latest/javadoc/org/apache/geode/cache/Region.html">Region API</a> breaking changes.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Given these advantages, Spring Boot for Apache Geode (SBDG) auto-configures <code>GemfireTemplate</code> beans for each Region
present in the Apache Geode cache.</p>
</div>
<div class="paragraph">
<p>Additionally, SBDG is careful not to create a <code>GemfireTemplate</code> if you have already declared a <code>GemfireTemplate</code> bean
in the Spring <code>ApplicationContext</code> for a given Region.</p>
</div>
<div class="sect2">
<h3 id="geode-data-access-region-templates-explicit-declaration">11.1. Explicitly Declared Regions</h3>
<div class="paragraph">
<p>Consider an explicitly declared Region bean definition:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Explicitly Declared Region Bean Definition</p>
</li>
</ol>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Configuration
class GeodeConfiguration {

    @Bean("Example")
    ClientRegionFactoryBean&lt;?, ?&gt; exampleRegion(GemFireCache gemfireCache) {
        // ...
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>SBDG automatically creates a <code>GemfireTemplate</code> bean for the <code>Example</code> Region by using the bean name <code>exampleTemplate</code>.
SBDG names the <code>GemfireTemplate</code> bean after the Region by converting the first letter in the Region&#8217;s name to lower case
and appending <code>Template</code> to the bean name.</p>
</div>
<div class="paragraph">
<p>In a managed Data Access Object (DAO), you can inject the Template:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Repository
class ExampleDataAccessObject {

    @Autowired
    @Qualifier("exampleTemplate")
    private GemfireTemplate exampleTemplate;

}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>You should use the <code>@Qualifier</code> annotation to qualify which <code>GemfireTemplate</code> bean you are specifically referring,
especially if you have more than one Region bean definition.</p>
</div>
</div>
<div class="sect2">
<h3 id="geode-data-access-region-templates-entity-defined">11.2. Entity-defined Regions</h3>
<div class="paragraph">
<p>SBDG auto-configures <code>GemfireTemplate</code> beans for entity-defined Regions.</p>
</div>
<div class="paragraph">
<p>Consider the following entity class:</p>
</div>
<div class="exampleblock">
<div class="title">Example 107. Customer class</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Region("Customers")
class Customer {
    // ...
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Further consider the following configuration:</p>
</div>
<div class="exampleblock">
<div class="title">Example 108. Apache Geode Configuration</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Configuration
@EnableEntityDefinedRegions(basePackageClasses = Customer.class)
class GeodeConfiguration {
    // ...
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>SBDG auto-configures a <code>GemfireTemplate</code> bean for the <code>Customers</code> Region named <code>customersTemplate</code>, which you can then
inject into an application component:</p>
</div>
<div class="exampleblock">
<div class="title">Example 109. CustomerService application component</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Service
class CustomerService {

    @Bean
    @Qualifier("customersTemplate")
    private GemfireTemplate customersTemplate;

}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Again, be careful to qualify the <code>GemfireTemplate</code> bean injection if you have multiple Regions, whether declared
explicitly or implicitly, such as when you use the <code>@EnableEntityDefineRegions</code> annotation.</p>
</div>
</div>
<div class="sect2">
<h3 id="geode-data-access-region-templates-caching-defined">11.3. Caching-defined Regions</h3>
<div class="paragraph">
<p>SBDG auto-configures <code>GemfireTemplate</code> beans for caching-defined Regions.</p>
</div>
<div class="paragraph">
<p>When you use Spring Framework&#8217;s <a href="https://docs.spring.io/spring/docs/current/spring-framework-reference/integration.html#cache">Cache Abstraction</a> backed by Apache Geode,
one requirement is to configure Regions for each of the caches specified in the
<a href="https://docs.spring.io/spring/docs/current/spring-framework-referenceintegration.html#cache-annotations">caching annotations</a> of your application service components.</p>
</div>
<div class="paragraph">
<p>Fortunately, SBDG makes enabling and configuring caching easy and <a href="#geode-caching-provider">automatic</a>.</p>
</div>
<div class="paragraph">
<p>Consider the following cacheable application service component:</p>
</div>
<div class="exampleblock">
<div class="title">Example 110. Cacheable <code>CustomerService</code> class</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Service
class CacheableCustomerService {

    @Bean
    @Qualifier("customersByNameTemplate")
    private GemfireTemplate customersByNameTemplate;

    @Cacheable("CustomersByName")
    public Customer findBy(String name) {
        return toCustomer(customersByNameTemplate.query("name = " + name));
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Further consider the following configuration:</p>
</div>
<div class="exampleblock">
<div class="title">Example 111. Apache Geode Configuration</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Configuration
@EnableCachingDefinedRegions
class GeodeConfiguration {

    @Bean
    public CustomerService customerService() {
        return new CustomerService();
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>SBDG auto-configures a <code>GemfireTemplate</code> bean named <code>customersByNameTemplate</code> to perform data access operations on
the <code>CustomersByName</code> (<code>@Cacheable</code>) Region. You can then inject the bean into any managed application component,
as shown in the preceding application service component example.</p>
</div>
<div class="paragraph">
<p>Again, be careful to qualify the <code>GemfireTemplate</code> bean injection if you have multiple Regions, whether declared
explicitly or implicitly, such as when you use the <code>@EnableCachingDefineRegions</code> annotation.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Autowiring (that is, injecting) <code>GemfireTemplate</code> beans auto-configured by SBDG for caching-defined Regions
into your application components does not always work. This has to do with the Spring container bean creation process.
In those cases, you may need to lazily lookup the <code>GemfireTemplate</code> by using
<code>applicationContext.getBean("customersByNameTemplate", GemfireTemplate.class)</code>. This is not ideal, but it works when
autowiring does not.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="geode-data-access-region-templates-native-defined">11.4. Native-defined Regions</h3>
<div class="paragraph">
<p>SBDG even auto-configures <code>GemfireTemplate</code> beans for Regions that have been defined with Apache Geode native
configuration metadata, such as <code>cache.xml</code>.</p>
</div>
<div class="paragraph">
<p>Consider the following Apache Geode native <code>cache.xml</code>:</p>
</div>
<div class="exampleblock">
<div class="title">Example 112. Client <code>cache.xml</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;client-cache xmlns="http://geode.apache.org/schema/cache"
			  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
			  xsi:schemaLocation="http://geode.apache.org/schema/cache http://geode.apache.org/schema/cache/cache-1.0.xsd"
			  version="1.0"&gt;

	&lt;region name="Example" refid="LOCAL"/&gt;

&lt;/client-cache&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Further consider the following Spring configuration:</p>
</div>
<div class="exampleblock">
<div class="title">Example 113. Apache Geode Configuration</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Configuration
@EnableGemFireProperties(cacheXmlFile = "cache.xml")
class GeodeConfiguration {
    // ...
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>SBDG auto-configures a <code>GemfireTemplate</code> bean named <code>exampleTemplate</code> after the <code>Example</code> Region defined in <code>cache.xml</code>.
You can inject this template as you would any other Spring-managed bean:</p>
</div>
<div class="exampleblock">
<div class="title">Example 114. Injecting the <code>GemfireTemplate</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Service
class ExampleService {

    @Autowired
    @Qualifier("exampleTemplate")
    private GemfireTemplate exampleTemplate;

}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The rules described earlier apply when multiple Regions are present.</p>
</div>
</div>
<div class="sect2">
<h3 id="geode-data-access-region-templates-rules">11.5. Template Creation Rules</h3>
<div class="paragraph">
<p>Fortunately, SBDG is careful not to create a <code>GemfireTemplate</code> bean for a Region if a template by the same name already
exists.</p>
</div>
<div class="paragraph">
<p>For example, consider the following configuration:</p>
</div>
<div class="exampleblock">
<div class="title">Example 115. Apache Geode Configuration</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Configuration
@EnableEntityDefinedRegions(basePackageClasses = Customer.class)
class GeodeConfiguration {

    @Bean
    public GemfireTemplate customersTemplate(GemFireCache cache) {
        return new GemfireTemplate(cache.getRegion("/Customers"));
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Further consider the following example:</p>
</div>
<div class="exampleblock">
<div class="title">Example 116. Customer class</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Region("Customers")
class Customer {
    // ...
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Because you explicitly defined and declared the <code>customersTemplate</code> bean, SBDG does not automatically create a template
for the <code>Customers</code> Region. This applies regardless of how the Region was created, whether by using
<code>@EnableEntityDefinedRegions</code>, <code>@EnableCachingDefinedRegions</code>, explicitly declaring Regions,
or natively defining Regions.</p>
</div>
<div class="paragraph">
<p>Even if you name the template differently from the Region for which the template was configured, SBDG conserves
resources and does not create the template.</p>
</div>
<div class="paragraph">
<p>For example, suppose you named the <code>GemfireTemplate</code> bean <code>vipCustomersTemplate</code>, even though the Region name
is <code>Customers</code>, based on the <code>@Region</code> annotated <code>Customer</code> class, which specified the <code>Customers</code> Region.</p>
</div>
<div class="paragraph">
<p>With the following configuration, SBDG is still careful not to create the template:</p>
</div>
<div class="exampleblock">
<div class="title">Example 117. Apache Geode Configuration</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Configuration
@EnableEntityDefinedRegions(basePackageClasses = Customer.class)
class GeodeConfiguration {

    @Bean
    public GemfireTemplate vipCustomersTemplate(GemFireCache cache) {
        return new GemfireTemplate(cache.getRegion("/Customers"));
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>SBDG identifies that your <code>vipCustomersTemplate</code> is the template used with the <code>Customers</code> Region, and SBDG does not
create the <code>customersTemplate</code> bean, which would result in two <code>GemfireTemplate</code> beans for the same Region.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The name of your Spring bean defined in Java configuration is the name of the method if the Spring bean is not
explicitly named by using the <code>name</code> attribute or the <code>value</code> attribute of the <code>@Bean</code> annotation.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="geode-repositories">12. Spring Data Repositories</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Using Spring Data Repositories with Apache Geode makes short work of data access operations when you use Apache Geode
as your System of Record (SoR) to persist your application&#8217;s state.</p>
</div>
<div class="paragraph">
<p><a href="https://docs.spring.io/spring-data/commons/docs/current/reference/html/#repositories">Spring Data Repositories</a> provide a convenient and powerful way to define
basic CRUD and simple query data access operations by specifying the contract of those data access operations in a Java
interface.</p>
</div>
<div class="paragraph">
<p>Spring Boot for Apache Geode auto-configures the Spring Data for Apache Geode
<a href="https://docs.spring.io/spring-data/geode/docs/current/reference/html/#gemfire-repositories">Repository extension</a>
when either is declared on your application&#8217;s classpath. You need not do anything special to enable it. You can start
coding your application-specific Repository interfaces.</p>
</div>
<div class="paragraph">
<p>The following example defines a <code>Customer</code> class to model customers and map it to the Apache Geode <code>Customers</code> Region
by using the SDG <a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/mapping/annotation/Region.html"><code>@Region</code></a>
mapping annotation:</p>
</div>
<div class="exampleblock">
<div class="title">Example 118. <code>Customer</code> entity class</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">package example.app.crm.model;

@Region("Customers")
class Customer {

    @Id
    private Long id;

    private String name;

}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The following example shows how to declare your Repository (a.k.a. <a href="https://en.wikipedia.org/wiki/Data_access_object">Data Access Object (DAO)</a>)
for <code>Customers</code>:</p>
</div>
<div class="exampleblock">
<div class="title">Example 119. <code>CustomerRepository</code> for peristing and accessing <code>Customers</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">package example.app.crm.repo;

interface CustomerRepository extends CrudRepository&lt;Customer, Long&gt; {

    List&lt;Customer&gt; findByLastNameLikeOrderByLastNameDescFirstNameAsc(String customerLastNameWildcard);

}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Then you can use the <code>CustomerRepository</code> in an application service class:</p>
</div>
<div class="exampleblock">
<div class="title">Example 120. Inject and use the <code>CustomerRepository</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">package example.app;

@SpringBootApplication
@EnableEntityDefinedRegions(basePackageClasses = Customer.class)
class SpringBootApacheGeodeClientCacheApplication {

    public static void main(String[] args) {
        SpringApplication.run(SpringBootApacheGeodeClientCacheApplication.class, args);
    }

    @Bean
    ApplicationRunner runner(CustomerRepository customerRepository) {

        // Matches Williams, Wilson, etc.
        List&lt;Customer&gt; customers =
            customerRepository.findByLastNameLikeOrderByLastNameDescFirstNameAsc("Wil%");

        // process the list of matching customers...
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>See Spring Data Commons' <a href="https://docs.spring.io/spring-data/commons/docs/current/reference/html/#repositories">Repositories abstraction</a>
and Spring Data for Apache Geode&#8217;s <a href="https://docs.spring.io/spring-data/geode/docs/current/reference/html/#gemfire-repositories">Repositories extension</a>
for more detail.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="geode-functions">13. Function Implementations &amp; Executions</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This chapter is about using Apache Geode in a Spring context for distributed computing use cases.</p>
</div>
<div class="sect2">
<h3 id="_background">13.1. Background</h3>
<div class="paragraph">
<p>Distributed computing, particularly in conjunction with data access and mutation operations, is a very effective
and efficient use of clustered computing resources. This is similar to <a href="https://en.wikipedia.org/wiki/MapReduce">MapReduce</a>.</p>
</div>
<div class="paragraph">
<p>A naively conceived query returning potentially hundreds of thousands (or even millions) of rows of data in a result set
to the application that queried and requested the data can be very costly, especially under load. Therefore, it is
typically more efficient to move the processing and computations on the predicated data set to where the data resides,
perform the required computations, summarize the results, and then send the reduced data set back to the client.</p>
</div>
<div class="paragraph">
<p>Additionally, when the computations are handled in parallel, across the cluster of computing resources, the operation
can be performed much more quickly. This typically involves intelligently organizing the data using various partitioning
(a.k.a. sharding) strategies to uniformly balance the data set across the cluster.</p>
</div>
<div class="paragraph">
<p>Apache Geode addresses this very important application concern in its
<a href="https://geode.apache.org/docs/guide/{apache-geode-doc-version}/developing/function_exec/chapter_overview.html">Function execution</a> framework.</p>
</div>
<div class="paragraph">
<p>Spring Data for Apache Geode <a href="https://docs.spring.io/spring-data/geode/docs/current/reference/html/#function-annotations">builds</a> on this Function execution
framework by letting developers <a href="https://docs.spring.io/spring-data/geode/docs/current/reference/html/#function-implementation">implement</a>
and <a href="https://docs.spring.io/spring-data/geode/docs/current/reference/html/#function-execution">execute</a> Apache Geode functions with a simple POJO-based
annotation configuration model.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
See <a href="https://docs.spring.io/spring-data/geode/docs/current/reference/html/#_implementation_vs_execution">the section about implementation versus execution</a>
for the difference between Function implementation and execution.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Taking this a step further, Spring Boot for Apache Geode auto-configures and enables both Function implementation
and execution out-of-the-box. Therefore, you can immediately begin writing Functions and invoking them without having to
worry about all the necessary plumbing to begin with. You can rest assured that it works as expected.</p>
</div>
</div>
<div class="sect2">
<h3 id="_applying_functions">13.2. Applying Functions</h3>
<div class="paragraph">
<p>Earlier, when we talked about <a href="#geode-caching-provider">caching</a>, we described a <code>FinancialLoanApplicationService</code> class
that could process eligibility when someone (represented by a <code>Person</code> object) applied for a financial loan.</p>
</div>
<div class="paragraph">
<p>This can be a very resource intensive and expensive operation, since it might involve collecting credit and employment
history, gathering information on outstanding loans, and so on. We applied caching in order to not have to recompute
or redetermine eligibility every time a loan office may want to review the decision with the customer.</p>
</div>
<div class="paragraph">
<p>But, what about the process of computing eligibility in the first place?</p>
</div>
<div class="paragraph">
<p>Currently, the application&#8217;s <code>FinancialLoanApplicationService</code> class seems to be designed to fetch the data and perform
the eligibility determination in place. However, it might be far better to distribute the processing and even determine
eligibility for a larger group of people all at once, especially when multiple, related people are involved in a single
decision, as is typically the case.</p>
</div>
<div class="paragraph">
<p>We can implement an <code>EligibilityDeterminationFunction</code> class by using SDG:</p>
</div>
<div class="exampleblock">
<div class="title">Example 121. Function implementation</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Component
class EligibilityDeterminationFunction {

    @GemfireFunction(HA = true, hasResult = true, optimizeForWrite=true)
    public EligibilityDecision determineEligibility(FunctionContext functionContext, Person person, Timespan timespan) {
        // ...
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>By using the SDG <a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/function/annotation/GemfireFunction.html"><code>@GemfireFunction</code></a>
annotation, we can implement our Function as a POJO method. SDG appropriately handles registering this POJO method
as a proper Function with Apache Geode.</p>
</div>
<div class="paragraph">
<p>If we now want to call this function from our Spring Boot <code>ClientCache</code> application, we can define
a function execution interface with a method name that matches the function name and that targets the execution
on the <code>EligibilityDecisions</code> Region:</p>
</div>
<div class="exampleblock">
<div class="title">Example 122. Function execution</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@OnRegion("EligibilityDecisions")
interface EligibilityDeterminationExecution {

  EligibilityDecision determineEligibility(Person person, Timespan timespan);

}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>We can then inject an instance of the <code>EligibilityDeterminationExecution</code> interface into our
<code>FinancialLoanApplicationService</code>, as we would any other object or Spring bean:</p>
</div>
<div class="exampleblock">
<div class="title">Example 123. Function use</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Service
class FinancialLoanApplicationService {

    private final EligibilityDeterminationExecution execution;

    public LoanApplicationService(EligibilityDeterminationExecution execution) {
        this.execution = execution;
    }

    @Cacheable("EligibilityDecisions")
    EligibilityDecision processEligibility(Person person, Timespan timespan) {
        return this.execution.determineEligibility(person, timespan);
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>As with caching, no additional configuration is required to enable and find your application Function implementations
and executions. You can simply build and run. Spring Boot for Apache Geode handles the rest.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
It is common to "implement" and register your application Functions on the server and "execute" them from
the client.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="geode-continuous-query">14. Continuous Query</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Some applications must process a stream of events as they happen and intelligently react in (near) real-time to
the countless changes in the data over time. Those applications need frameworks that can make processing a stream
of events as they happen as easy as possible.</p>
</div>
<div class="paragraph">
<p>Spring Boot for Apache Geode does just that, without users having to perform any complex setup or configure any
necessary infrastructure components to enable such functionality. Developers can define the criteria for the
data of interest and implement a handler (listener) to process the stream of events as they occur.</p>
</div>
<div class="paragraph">
<p><a href="https://geode.apache.org/docs/guide/{apache-geode-doc-version}/developing/continuous_querying/chapter_overview.html">Continuous Query (CQ)</a> lets you
easily define your criteria for the data you need. With CQ, you can express the criteria that match the data you need
by specifying a query predicate. Apache Geode implements the
<a href="https://geode.apache.org/docs/guide/{apache-geode-doc-version}/developing/querying_basics/query_basics.html">Object Query Language (OQL)</a>
for defining and executing queries. OQL resembles SQL and supports projections, query predicates, ordering,
and aggregates. Also, when used in CQs, they execute continuously, firing events when the data changes in such ways
as to match the criteria expressed in the query predicate.</p>
</div>
<div class="paragraph">
<p>Spring Boot for Apache Geode combines the ease of identifying the data you need by using an OQL query statement with
implementing the listener callback (handler) in one easy step.</p>
</div>
<div class="paragraph">
<p>For example, suppose you want to perform some follow-up action when a customer&#8217;s financial loan application is either
approved or denied.</p>
</div>
<div class="paragraph">
<p>First, the application model for our <code>EligibilityDecision</code> class might look something like the following:</p>
</div>
<div class="exampleblock">
<div class="title">Example 124. EligibilityDecision class</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Region("EligibilityDecisions")
class EligibilityDecision {

    private final Person person;

    private Status status = Status.UNDETERMINED;

    private final Timespan timespan;

    enum Status {

        APPROVED,
        DENIED,
        UNDETERMINED,

    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Then we can implement and declare our CQ event handler methods to be notified when an eligibility decision is either
<code>APPROVED</code> or <code>DENIED</code>:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Component
class EligibilityDecisionPostProcessor {

    @ContinuousQuery(name = "ApprovedDecisionsHandler",
        query = "SELECT decisions.*
                 FROM /EligibilityDecisions decisions
                 WHERE decisions.getStatus().name().equalsIgnoreCase('APPROVED')")
    public void processApprovedDecisions(CqEvent event) {
        // ...
    }

    @ContinuousQuery(name = "DeniedDecisionsHandler",
        query = "SELECT decisions.*
                 FROM /EligibilityDecisions decisions
                 WHERE decisions.getStatus().name().equalsIgnoreCase('DENIED')")
    public void processDeniedDecisions(CqEvent event) {
        // ...
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Thus, when eligibility is processed and a decision has been made, either approved or denied, our application gets
notified, and as an application developer, you are free to code your handler and respond to the event any way you like.
Also, because our Continuous Query (CQ) handler class is a component (or a bean in the Spring <code>ApplicationContext</code>)
you can auto-wire any other beans necessary to carry out the application&#8217;s intended function.</p>
</div>
<div class="paragraph">
<p>This is not unlike Spring&#8217;s <a href="https://docs.spring.io/spring/docs/current/spring-framework-reference/integration.html#jms-annotated">annotation-driven listener endpoints</a>,
which are used in (JMS) message listeners and handlers, except in Spring Boot for Apache Geode, you need not do anything
special to enable this functionality. You can declare the <code>@ContinuousQuery</code> annotation on any POJO method and go to
work on other things.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="geode-data-using">15. Using Data</h2>
<div class="sectionbody">
<div class="paragraph">
<p>One of the most important tasks during development is ensuring your Spring Boot application handles data correctly.
To verify the accuracy, integrity, and availability of your data, your application needs data with which to work.</p>
</div>
<div class="paragraph">
<p>For those of you already familiar with Spring Boot&#8217;s support for
<a href="https://docs.spring.io/spring-boot/docs/current/reference/html/howto.html#howto-initialize-a-database-using-spring-jdbc">SQL database initialization</a>,
the approach when using Apache Geode should be easy to understand.</p>
</div>
<div class="paragraph">
<p>Apache Geode provides built-in support, similar in function to Spring Boot&#8217;s SQL database initialization, by using:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Gfsh&#8217;s <a href="https://geode.apache.org/docs/guide/{apache-geode-doc-version}/tools_modules/gfsh/quick_ref_commands_by_area.html#topic_C7DB8A800D6244AE8FF3ADDCF139DCE4">import/export</a> data commands.</p>
</li>
<li>
<p><a href="https://geode.apache.org/docs/guide/{apache-geode-doc-version}/managing/cache_snapshots/chapter_overview.html">Snapshot service</a></p>
</li>
<li>
<p><a href="https://geode.apache.org/docs/guide/{apache-geode-doc-version}/developing/storing_data_on_disk/chapter_overview.html">Persistence</a> with <a href="https://geode.apache.org/docs/guide/{apache-geode-doc-version}/managing/disk_storage/chapter_overview.html">disk storage</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For example, by enabling persistence with disk storage, you could
<a href="https://geode.apache.org/docs/guide/{apache-geode-doc-version}/managing/disk_storage/backup_restore_disk_store.html">backup and restore</a>
persistent <code>DiskStore</code> files from one cluster to another.</p>
</div>
<div class="paragraph">
<p>Alternatively, using Apache Geode&#8217;s Snapshot Service, you can export data contained in targeted <code>Regions</code> from one
cluster during shutdown and import the data into another cluster on startup. The Snapshot Service lets you filter data
while it is being imported and exported.</p>
</div>
<div class="paragraph">
<p>Finally, you can use Apache Geode shell (Gfsh) commands to
<a href="https://docs.spring.io/spring-data/geode/docs/current/reference/html/tools_modules/gfsh/command-pages/export.html#topic_263B70069BFC4A7185F86B3272011734">export data</a>
and <a href="https://geode.apache.org/docs/guide/{apache-geode-doc-version}/tools_modules/gfsh/command-pages/import.html#topic_jw2_2ld_2l">import data</a>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Spring Data for Apache Geode (SDG) contains dedicated support for
<a href="https://docs.spring.io/spring-data/geode/docs/current/reference/html/#bootstrap:region:persistence">persistence</a>
and the <a href="https://docs.spring.io/spring-data/geode/docs/current/reference/html/#bootstrap:snapshot">Snapshot Service</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In all cases, the files generated by persistence, the Snapshot Service and Gfsh&#8217;s <code>export</code> command are in a proprietary
binary format.</p>
</div>
<div class="paragraph">
<p>Furthermore, none of these approaches are as convenient as Spring Boot&#8217;s database initialization automation. Therefore,
Spring Boot for Apache Geode (SBDG) offers support to import data from JSON into Apache Geode as PDX.</p>
</div>
<div class="paragraph">
<p>Unlike Spring Boot, SBDG offers support to export data as well. By default, data is imported and exported in JSON format.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
SBDG does not provide an equivalent to Spring Boot&#8217;s <code>schema.sql</code> file. The best way to define the data structures
(the <code>Region</code> instances) that manage your data is with SDG&#8217;s annotation-based configuration support for defining cache
<code>Region</code> instances from your application&#8217;s <a href="https://docs.spring.io/spring-data/geode/docs/current/reference/html/#bootstrap-annotation-config-regions">entity classes</a>
or indirectly from Spring and JSR-107 or JCache <a href="https://docs.spring.io/spring-data/geode/docs/current/reference/html/#bootstrap-annotation-config-caching">caching annotations</a>.
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
See SBDG&#8217;s <a href="#geode-configuration-declarative-annotations-productivity-regions">documentation</a> on the same.
</td>
</tr>
</table>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
While this feature works and many edge cases were thought through and tested thoroughly, there are still some
limitations that need to be ironed out. See <a href="https://github.com/spring-projects/spring-boot-data-geode/issues/82">issue-82</a>
and <a href="https://github.com/spring-projects/spring-boot-data-geode/issues/83">issue-83</a> for more details. The Spring team
strongly recommends that this feature be used only for development and testing purposes.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="geode-data-using-import">15.1. Importing Data</h3>
<div class="paragraph">
<p>You can import data into a <code>Region</code> by defining a JSON file that contain the JSON objects you wish to load. The JSON
file must follow a predefined naming convention and be placed in the root of your application classpath:</p>
</div>
<div class="paragraph">
<p><code>data-&lt;regionName&gt;.json</code></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<code>&lt;regionName&gt;</code> refers to the lowercase "name" of the <code>Region</code>, as defined by
<a href="https://geode.apache.org/releases/latest/javadoc/org/apache/geode/cache/Region.html#getName--"><code>Region.getName()</code></a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For example, if you have a <code>Region</code> named "Orders", you would create a JSON file called <code>data-orders.json</code> and place it
in the root of your application classpath (for example, in <code>src/test/resources</code>).</p>
</div>
<div class="paragraph">
<p>Create JSON files for each <code>Region</code> that is implicitly defined (for example, by using <code>@EnableEntityDefinedRegions</code>)
or explicitly defined (with <code>ClientRegionFactoryBean</code> in Java configuration) in your Spring Boot application
configuration that you want to load with data.</p>
</div>
<div class="paragraph">
<p>The JSON file that contains JSON data for the "Orders" <code>Region</code> might appear as follows:</p>
</div>
<div class="exampleblock">
<div class="title">Example 125. <code>data-orders.json</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="json">[{
  "@type": "example.app.pos.model.PurchaseOrder",
  "id": 1,
  "lineItems": [
    {
      "@type": "example.app.pos.model.LineItem",
      "product": {
        "@type": "example.app.pos.model.Product",
        "name": "Apple iPad Pro",
        "price": 1499.00,
        "category": "SHOPPING"
      },
      "quantity": 1
    },
    {
      "@type": "example.app.pos.model.LineItem",
      "product": {
        "@type": "example.app.pos.model.Product",
        "name": "Apple iPhone 11 Pro Max",
        "price": 1249.00,
        "category": "SHOPPING"
      },
      "quantity": 2
    }
  ]
}, {
  "@type": "example.app.pos.model.PurchaseOrder",
  "id": 2,
  "lineItems": [
    {
      "@type": "example.app.pos.model.LineItem",
      "product": {
        "@type": "example.app.pos.model.Product",
        "name": "Starbucks Vente Carmel Macchiato",
        "price": 5.49,
        "category": "SHOPPING"
      },
      "quantity": 1
    }
  ]
}]</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The application entity classes that matches the JSON data from the JSON file might look something like the following
listing:</p>
</div>
<div class="exampleblock">
<div class="title">Example 126. Point-of-Sale (POS) Application Domain Model Classes</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Region("Orders")
class PurchaseOrder {

	@Id
    Long id;

	List&lt;LineItem&gt; lineItems;

}

class LineItem {

	Product product;
	Integer quantity;

}

@Region("Products")
class Product {

	String name;
	Category category;
	BigDecimal price;

}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>As the preceding listings show, the object model and corresponding JSON can be arbitrarily complex with a hierarchy of
objects that have complex types.</p>
</div>
<div class="sect3">
<h4 id="geode-data-using-import-metadata">15.1.1. JSON metadata</h4>
<div class="paragraph">
<p>We want to draw your attention to a few other details contained in the object model and JSON shown
<a href="#geode-data-using-import">earlier</a>.</p>
</div>
<div class="sect4">
<h5 id="geode-data-using-import-metadata-attype">The <code>@type</code> metadata field</h5>
<div class="paragraph">
<p>First, we declared a <code>@type</code> JSON metadata field. This field does not map to any specific field or property of
the application domain model class (such as <code>PurchaseOrder</code>). Rather, it tells the framework and Apache Geode&#8217;s JSON/PDX
converter the type of object the JSON data would map to if you were to request an object (by calling
<code>PdxInstance.getObject()</code>).</p>
</div>
<div class="paragraph">
<p>Consider the following example:</p>
</div>
<div class="exampleblock">
<div class="title">Example 127. Deserializing PDX as an Object</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Repository
class OrdersRepository {

    @Resource(name = "Orders")
    Region&lt;Long, PurchaseOrder&gt; orders;

    PurchaseOrder findBy(Long id) {

        Object value = this.orders.get(id);

        return value instanceof PurchaseOrder ? (PurchaseOrder) value
            : value instanceof PdxInstance ? ((PdxInstance) value).getObject()
            : null;
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Basically, the <code>@type</code> JSON metadata field informs the <code>PdxInstance.getObject()</code> method about the type of Java object
to which the JSON object maps. Otherwise, the <code>PdxInstance.getObject()</code> method would silently return a <code>PdxInstance</code>.</p>
</div>
<div class="paragraph">
<p>It is possible for Apache Geode&#8217;s PDX serialization framework to return a <code>PurchaseOrder</code> from <code>Region.get(key)</code> as well,
but it depends on the value of PDX&#8217;s <code>read-serialized</code>, cache-level configuration setting, among other factors.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
When JSON is imported into a <code>Region</code> as PDX, the
<a href="https://geode.apache.org/releases/latest/javadoc/org/apache/geode/pdx/PdxInstance.html#getClassName--"><code>PdxInstance.getClassName()</code></a>
does not refer to a valid Java class. It is
<a href="https://geode.apache.org/releases/latest/javadoc/org/apache/geode/pdx/JSONFormatter.html#JSON_CLASSNAME"><code>JSONFormatter.JSON_CLASSNAME</code></a>.
As a result, <code>Region</code> data access operations, such as <code>Region.get(key)</code>, return a <code>PdxInstance</code> and not a Java object.
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
You may need to proxy <code>Region</code> read data access operations (such as <code>Region.get(key)</code>) by setting the SBDG property
<code>spring.boot.data.gemfire.cache.region.advice.enabled</code> to <code>true</code>. When this property is set, <code>Region</code> instances are
proxied to wrap a <code>PdxInstance</code> in a <code>PdxInstanceWrapper</code> to appropriately handle the <code>PdxInstance.getObject()</code> call
in your application code.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="geode-data-using-import-metadata-id">The <code>id</code> field and the <code>@identifier</code> metadata field</h5>
<div class="paragraph">
<p>Top-level objects in your JSON must have an identifier, such as an <code>id</code> field. This identifier is used as the identity
and key of the object (or <code>PdxInstance</code>) when stored in the <code>Region</code> (for example, <code>Region.put(key, object)</code>).</p>
</div>
<div class="paragraph">
<p>You may have noticed that the JSON for the "Orders" <code>Region</code> shown earlier declared an <code>id</code> field as the identifier:</p>
</div>
<div class="exampleblock">
<div class="title">Example 128. PurchaseOrder identifier ("id")</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="text">[{
  "@type": "example.app.pos.model.PurchaseOrder",
  "id": 1,
  ...</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>This follows the same convention used in Spring Data. Typically, Spring Data mapping infrastructure looks for a POJO
field or property annotated with <a href="https://docs.spring.io/spring-data/commons/docs/current/api/org/springframework/data/annotation/Id.html"><code>@Id</code></a>. If no
field or property is annotated with <code>@Id</code>, the framework falls back to searching for a field or property named <code>id</code>.</p>
</div>
<div class="paragraph">
<p>In Spring Data for Apache Geode, this <code>@Id</code>-annotated or <code>id</code>-named field or property is used as the identifier
and as the key for the object when storing it into a <code>Region</code>.</p>
</div>
<div class="paragraph">
<p>However, what happens when an object or entity does not have a surrogate ID defined? Perhaps the application domain
model class is appropriately using natural identifiers, which is quite common in practice.</p>
</div>
<div class="paragraph">
<p>Consider a <code>Book</code> class defined as follows:</p>
</div>
<div class="exampleblock">
<div class="title">Example 129. Book class</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Region("Books")
class Book {

	Author author;

	@Id
	ISBN isbn;

	LocalDate publishedDate;

	Sring title;

}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>As declared in the <code>Book</code> class, the identifier for <code>Book</code> is its <code>ISBN</code>, since the <code>isbn</code> field was annotated with
Spring Data&#8217;s <code>@Id</code> mapping annotation. However, we cannot know this by searching for an <code>@Id</code> annotation in JSON.</p>
</div>
<div class="paragraph">
<p>You might be tempted to argue that if the <code>@type</code> metadata field is set, we would know the class type and could load
the class definition to learn about the identifier. That is all fine until the class is not actually on the application
classpath in the first place. This is one of the reasons why SBDG&#8217;s JSON support serializes JSON to Apache Geode&#8217;s PDX
format. There might not be a class definition, which would lead to a <code>NoClassDefFoundError</code> or <code>ClassNotFoundException</code>.</p>
</div>
<div class="paragraph">
<p>So, what then?</p>
</div>
<div class="paragraph">
<p>In this case, SBDG lets you declare the <code>@identifier</code> JSON metadata field to inform the framework what to use as
the identifier for the object.</p>
</div>
<div class="paragraph">
<p>Consider the following example:</p>
</div>
<div class="exampleblock">
<div class="title">Example 130. Using "@identifer"</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="json">{
  "@type": "example.app.books.model.Book",
  "@identifier": "isbn",
  "author": {
    "id": 1,
    "name": "Josh Long"
  },
  "isbn": "978-1-449-374640-8",
  "publishedDate": "2017-08-01",
  "title": "Cloud Native Java"
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The <code>@identifier</code> JSON metadata field informs the framework that the <code>isbn</code> field is the identifier for a <code>Book</code>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="geode-data-using-import-conditional">15.1.2. Conditionally Importing Data</h4>
<div class="paragraph">
<p>While the Spring team recommends that users should only use this feature when developing and testing their Spring Boot
applications with Apache Geode, you may still occasionally use this feature in production.</p>
</div>
<div class="paragraph">
<p>You might use this feature in production to preload a (REPLICATE) Region with reference data. Reference data is largely
static, infrequently changing, and non-transactional. Preloading reference data is particularly useful when you want to
warm the cache.</p>
</div>
<div class="paragraph">
<p>When you use this feature for development and testing purposes, you can put your <code>Region</code>-specific JSON files in
<code>src/test/resources</code>. This ensures that the files are not included in your application artifact (such as a JAR or WAR)
when built and deployed to production.</p>
</div>
<div class="paragraph">
<p>However, if you must use this feature to preload data in your production environment, you can still conditionally load
data from JSON. To do so, configure the <code>spring.boot.data.gemfire.cache.data.import.active-profiles</code> property set to
the Spring profiles that must be active for the import to take effect.</p>
</div>
<div class="paragraph">
<p>Consider the following example:</p>
</div>
<div class="exampleblock">
<div class="title">Example 131. Conditional Importing JSON</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="properties"># Spring Boot application.properties

spring.boot.data.gemfire.cache.data.import.active-profiles=DEV, QA</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>For import to have an effect in this example, you must specifically set the <code>spring.profiles.active</code> property to one of
the valid, <code>active-profiles</code> listed in the import property (such as <code>QA</code>). Only one needs to match.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
There are many ways to conditionally build application artifacts. You might prefer to handle this concern in your
Gradle or Maven build.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="geode-data-using-export">15.2. Exporting Data</h3>
<div class="paragraph">
<p>Certain data stored in your application&#8217;s <code>Regions</code> may be sensitive or confidential, and keeping the data secure is of
the utmost concern and priority. Therefore, exporting data is <strong>disabled</strong> by default.</p>
</div>
<div class="paragraph">
<p>However, if you use this feature for development and testing purposes, enabling the export capability may be useful to
move data from one environment to another. For example, if your QA team finds a bug in the application that uses a
particular data set, they can export the data and pass it back to the development team to import in their local
development environment to help debug the issue.</p>
</div>
<div class="paragraph">
<p>To enable export, set the <code>spring.boot.data.gemfire.cache.data.export.enabled</code> property to <code>true</code>:</p>
</div>
<div class="exampleblock">
<div class="title">Example 132. Enable Export</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="properties"># Spring Boot application.properties

spring.boot.data.gemfire.cache.data.export.enabled=true</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>SBDG is careful to export data to JSON in a format that Apache Geode expects on import and includes things such as
<code>@type</code> metadata fields.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
The <code>@identifier</code> metadata field is not generated automatically. While it is possible for POJOs stored in a
<code>Region</code> to include an <code>@identifier</code> metadata field when exported to JSON, it is not possible when the <code>Region</code> value
is a <code>PdxInstance</code> that did not originate from JSON. In this case, you must manually ensure that the <code>PdxInstance</code>
includes an <code>@identifier</code> metadata field before it is exported to JSON if necessary (for example, <code>Book.isbn</code>). This is
only necessary if your entity classes do not declare an explicit identifier field, such as with the <code>@Id</code> mapping
annotation, or do not have an <code>id</code> field. This scenario can also occur when inter-operating with native clients
that model the application domain objects differently and then serialize the objects by using PDX, storing them in
Regions on the server that are then later consumed by your Java-based, Spring Boot application.
</td>
</tr>
</table>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
You may need to set the <code>-Dgemfire.disableShutdownHook</code> JVM System property to <code>true</code> before your Spring
Boot application starts up when using export. Unfortunately, this Java runtime shutdown hook is registered and enabled
in Apache Geode  by default, which results in the cache and the Regions being closed before the SBDG Export
functionality can export the data, thereby resulting in a <code>CacheClosedException</code>. SBDG
{github-url}/spring-geode-autoconfigure/src/main/java/org/springframework/geode/boot/autoconfigure/DataImportExportAutoConfiguration.java#L173-L183[makes a best effort]
to disable the Apache Geode JVM shutdown hook when export is enabled, but it is at the mercy of the JVM <code>ClassLoader</code>,
since Apache Geode&#8217;s JVM shutdown hook
{apache-geode-src}/geode-core/src/main/java/org/apache/geode/distributed/internal/InternalDistributedSystem.java#L2185-L2223[registration]
is declared in a <code>static</code> initializer.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="geode-data-using-import-export-api-extensions">15.3. Import/Export API Extensions</h3>
<div class="paragraph">
<p>The API in SBDG for import and export functionality is separated into the following concerns:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Data Format</p>
</li>
<li>
<p>Resource Resolving</p>
</li>
<li>
<p>Resource Reading</p>
</li>
<li>
<p>Resource Writing</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>By breaking each of these functions apart into separate concerns, a developer can customize each aspect of the import
and export functions.</p>
</div>
<div class="paragraph">
<p>For example, you could import XML from the filesystem and then export JSON to a REST-based Web Service. By default, SBDG
imports JSON from the classpath and exports JSON to the filesystem.</p>
</div>
<div class="paragraph">
<p>However, not all environments expose a filesystem, such as cloud environments like PCF. Therefore, giving users control
over each aspect of the import and export processes is essential for performing the functions in any environment.</p>
</div>
<div class="sect3">
<h4 id="geode-data-using-import-export-api-extensions-data-format">15.3.1. Data Format</h4>
<div class="paragraph">
<p>The primary interface to import data into a <code>Region</code> is <code>CacheDataImporter</code>.</p>
</div>
<div class="paragraph">
<p><code>CacheDataImporter</code> is a <code>@FunctionalInterface</code> that extends Spring&#8217;s
<a href="https://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/beans/factory/config/BeanPostProcessor.html"><code>BeanPostProcessor</code></a>
interface to trigger the import of data after the <code>Region</code> has been initialized.</p>
</div>
<div class="paragraph">
<p>The interface is defined as follows:</p>
</div>
<div class="exampleblock">
<div class="title">Example 133. <code>CacheDataImporter</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">interface CacheDataImporter extends BeanPostProcessor {

	Region importInto(Region region);

}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>You can code the <code>importInto(:Region)</code> method to handle any data format (JSON, XML, and others) you prefer. Register a
bean that implements the <code>CacheDataImporter</code> interface in the Spring container, and the importer does its job.</p>
</div>
<div class="paragraph">
<p>On the flip side, the primary interface to export data from a <code>Region</code> is the <code>CacheDataExporter</code>.</p>
</div>
<div class="paragraph">
<p><code>CacheDataExporter</code> is a <code>@FunctionalInterface</code> that extends Spring&#8217;s
<a href="https://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/beans/factory/config/DestructionAwareBeanPostProcessor.html"><code>DestructionAwareBeanPostProcessor</code></a>
interface to trigger the export of data before the <code>Region</code> is destroyed.</p>
</div>
<div class="paragraph">
<p>The interface is defined as follows:</p>
</div>
<div class="exampleblock">
<div class="title">Example 134. <code>CacheDataExporter</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">interface CacheDataExporter extends DestructionAwareBeanPostProcessor {

	Region exportFrom(Region region);
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>You can code the <code>exportFrom(:Region)</code> method to handle any data format (JSON, XML, and others) you prefer. Register a
bean implementing the <code>CacheDataExporter</code> interface in the Spring container, and the exporter does its job.</p>
</div>
<div class="paragraph">
<p>For convenience, when you want to implement both import and export functionality, SBDG provides the
<code>CacheDataImporterExporter</code> interface, which extends both <code>CacheDataImporter</code> and <code>CacheDataExporter</code>:</p>
</div>
<div class="exampleblock">
<div class="title">Example 135. <code>CacheDataImporterExporter</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">interface CacheDataImporterExporter extends CacheDataExporter, CacheDataImporter { }</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>For added support, SBDG also provides the <code>AbstractCacheDataImporterExporter</code> abstract base class to simplify
the implementation of your importer/exporter.</p>
</div>
<div class="sect4">
<h5 id="geode-data-using-import-export-api-extensions-data-format-lifecycle-management">Lifecycle Management</h5>
<div class="paragraph">
<p>Sometimes, it is necessary to precisely control when data is imported or exported.</p>
</div>
<div class="paragraph">
<p>This is especially true on import, since different <code>Region</code> instances may be collocated or tied together through a
cache callback, such as a <code>CacheListener</code>. In these cases, the other <code>Region</code> may need to exist before the import
on the dependent <code>Region</code> proceeds, particularly if the dependencies were loosely defined.</p>
</div>
<div class="paragraph">
<p>Controlling the import is also important when you use SBDG&#8217;s <code>@EnableClusterAware</code> annotation to push configuration
metadata from the client to the cluster in order to define server-side <code>Region</code> instances that match the client-side
<code>Region</code> instances, especially client <code>Region</code> instances targeted for import. The matching <code>Region</code> instances on the
server side must exist before data is imported into client (<code>PROXY</code>) <code>Region</code> instances.</p>
</div>
<div class="paragraph">
<p>In all cases, SBDG provides the <code>LifecycleAwareCacheDataImporterExporter</code> class to wrap your <code>CacheDataImporterExporter</code>
implementation. This class implements Spring&#8217;s
<a href="https://docs.spring.io/spring/docs/current/javadoc-api/https://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/context/SmartLifecycle.html"><code>SmartLifecycle</code></a>
interface.</p>
</div>
<div class="paragraph">
<p>By implementing the <code>SmartLifecycle</code> interface, you can control in which <code>phase</code> of the Spring container the import
occurs. SBDG also exposes two more properties to control the lifecycle:</p>
</div>
<div class="exampleblock">
<div class="title">Example 136. Lifecycle Management Properties</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="properties"># Spring Boot application.properties

spring.boot.data.gemfire.cache.data.import.lifecycle=[EAGER|LAZY]
spring.boot.data.gemfire.cache.data.import.phase=1000000</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p><code>EAGER</code> acts immediately, after the <code>Region</code> is initialized (the default behavior). <code>LAZY</code> delays the import until the
<code>start()</code> method is called, which is invoked according to the <code>phase</code>, thereby ordering the import relative to the other
lifecycle-aware components that are registered in the Spring container.</p>
</div>
<div class="paragraph">
<p>The following example shows how to make your <code>CacheDataImporterExporter</code> lifecycle-aware:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Configuration
class MyApplicationConfiguration {

	@Bean
    CacheDataImporterExporter importerExporter() {
		return new LifecycleAwareCacheDataImporterExporter(new MyCacheDataImporterExporter());
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="geode-data-using-import-export-api-extensions-resource-resolution">15.3.2. Resource Resolution</h4>
<div class="paragraph">
<p>Resolving resources used for import and export results in the creation of a Spring
<a href="https://docs.spring.io/spring/docs/current/javadoc-api/https://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/core/io/Resource.html"><code>Resource</code></a>
handle.</p>
</div>
<div class="paragraph">
<p>Resource resolution is a vital step to qualifying a resource, especially if the resource requires special logic
or permissions to access it. In this case, specific <code>Resource</code> handles can be returned and used by the reader
and writer of the <code>Resource</code> as appropriate for import or export operation.</p>
</div>
<div class="paragraph">
<p>SBDG encapsulates the algorithm for resolving <code>Resources</code> in the <code>ResourceResolver</code>
(<a href="https://en.wikipedia.org/wiki/Strategy_pattern">Strategy</a>) interface:</p>
</div>
<div class="exampleblock">
<div class="title">Example 137. ResourceResolver</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@FunctionalInterface
interface ResourceResolver {

	Optional&lt;Resource&gt; resolve(String location);

	default Resouce required(String location) {
		// ...
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Additionally, SBDG provides the <code>ImportResourceResolver</code> and <code>ExportResourceResolver</code> marker interfaces and the
<code>AbstractImportResourceResolver</code> and <code>AbstractExportResourceResolver</code> abstract base classes for implementing the
resource resolution logic used by both import and export operations.</p>
</div>
<div class="paragraph">
<p>If you wish to customize the resolution of <code>Resources</code> used for import or export, your <code>CacheDataImporterExporter</code>
implementation can extend the <code>ResourceCapableCacheDataImporterExporter</code> abstract base class, which provides the
aforementioned interfaces and base classes.</p>
</div>
<div class="paragraph">
<p>As stated earlier, SBDG resolves resources on import from the classpath and resources on export to the filesystem.</p>
</div>
<div class="paragraph">
<p>You can customize this behavior by providing an implementation of <code>ImportResourceResolver</code>, <code>ExportResourceResolver</code>,
or both interfaces and declare instances as beans in the Spring context:</p>
</div>
<div class="exampleblock">
<div class="title">Example 138. Import &amp; Export ResourceResolver beans</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Configuration
class MyApplicationConfiguration {

	@Bean
    ImportResourceResolver importResourceResolver() {
		return new MyImportResourceResolver();
    }

    @Bean
    ExportResourceResolver exportResourceResolver() {
		return new MyExportResourceResolver();
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
If you need to customize the resource resolution process for each location (or <code>Region</code>) on import or export,
you can use the <a href="https://en.wikipedia.org/wiki/Composite_pattern">Composite software design pattern</a>.
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="geode-data-using-import-export-api-extensions-resource-resolution-default-customization">Customize Default Resource Resolution</h5>
<div class="paragraph">
<p>If you are content with the provided defaults but want to target specific locations on the classpath or filesystem
used by the import or export, SBDG additionally provides the following properties:</p>
</div>
<div class="exampleblock">
<div class="title">Example 139. Import/Export Resource Location Properties</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="properties"># Spring Boot application.properties

spring.boot.data.gemfire.cache.data.import.resource.location=...
spring.boot.data.gemfire.cache.data.export.resource.location=...</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The properties accept any valid resource string, as specified in the Spring
<a href="https://docs.spring.io/spring/docs/current/spring-framework-reference/core.html#resources-resourceloader">documentation</a> (see <strong>Table 10. Resource strings</strong>).</p>
</div>
<div class="paragraph">
<p>This means that, even though import defaults from the classpath, you can change the location from classpath
to filesystem, or even network (for example, https://) by changing the prefix (or protocol).</p>
</div>
<div class="paragraph">
<p>Import/export resource location properties can refer to other properties through property placeholders, but SBDG
further lets you use SpEL inside the property values.</p>
</div>
<div class="paragraph">
<p>Consider the following example:</p>
</div>
<div class="exampleblock">
<div class="title">Example 140. Using SpEL</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="properties"># Spring Boot application.properties

spring.boot.data.gemfire.cache.data.import.resource.location=\
  https://#{#env['user.name']}:#{someBean.lookupPassword(#env['user.name'])}@#{host}:#{port}/cache/#{#regionName}/data/import</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>In this case, the import resource location refers to a rather sophisticated resource string by using a complex SpEL
expression.</p>
</div>
<div class="paragraph">
<p>SBDG populates the SpEL <code>EvaluationContext</code> with three sources of information:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Access to the Spring <code>BeanFactory</code></p>
</li>
<li>
<p>Access to the Spring <code>Environment</code></p>
</li>
<li>
<p>Access to the current <code>Region</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Simple Java System properties or environment variables can be accessed with the following expression:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="text">#{propertyName}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>You can access more complex property names (including properties that use dot notation, such as the <code>user.home</code>
Java System property), directly from the <code>Environment</code> by using map style syntax as follows:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="text">#{#env['property.name']}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The <code>#env</code> variable is set in the SpEL <code>EvaluationContext</code> to the Spring <code>Environment</code>.</p>
</div>
<div class="paragraph">
<p>Because the SpEL <code>EvaluationContext</code> is evaluated with the Spring <code>ApplicationContext</code> as the root object, you also have
access to the beans declared and registered in the Spring container and can invoke methods on them, as shown earlier
with <code>someBean.lookupPassword(..)</code>. <code>someBean</code> must be the name of the bean as declared and registered in the Spring
container.</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
Be careful when accessing beans declared in the Spring container with SpEL, particularly when using <code>EAGER</code>
import, as it may force those beans to be eagerly (or even prematurely) initialized.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>SBDG also sets the <code>#regionName</code> variable in the <code>EvaluationContext</code> to the name of the <code>Region</code>, as determined by
<a href="https://geode.apache.org/releases/latest/javadoc/https://geode.apache.org/releases/latest/javadoc/org/apache/geode/cache/Region.html#getName--"><code>Region.getName()</code></a>,
targeted for import and export.</p>
</div>
<div class="paragraph">
<p>This lets you not only change the location of the resource but also change the resource name (such as a filename).</p>
</div>
<div class="paragraph">
<p>Consider the following example:</p>
</div>
<div class="exampleblock">
<div class="title">Example 141. Using <code>#regionName</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="properties"># Spring Boot application.properties

spring.boot.data.gemfire.cache.data.export.resource.location=\
    file://#{#env['user.home']}/gemfire/cache/data/custom-filename-for-#{#regionName}.json</code></pre>
</div>
</div>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
By default, the exported file is stored in the working directory (<code>System.getProperty("user.dir")</code>)
of the Spring Boot application process.
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
See the Spring Framework <a href="https://docs.spring.io/spring/docs/current/spring-framework-reference/core.html#expressions">documentation</a> for more information on SpEL.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="geode-data-using-import-export-api-extensions-resource-reading-writing">15.3.3. Reading &amp; Writing Resources</h4>
<div class="paragraph">
<p>The Spring <a href="https://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/core/io/Resource.html"><code>Resource</code></a> handle
specifies tion of a resource, not how the resource is read or written. Even the Spring
<a href="https://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/core/io/ResourceLoader.html"><code>ResourceLoader</code></a>,
which is an interface for loading <code>Resources</code>, does not specifically read or write any content to the <code>Resource</code>.</p>
</div>
<div class="paragraph">
<p>SBDG separates these concerns into two interfaces: <code>ResourceReader</code> and <code>ResourceWriter</code>, respectively.
The design follows the same pattern used by Java&#8217;s <code>InputStream/OutputStream</code> and <code>Reader/Writer</code> classes
in the <code>java.io</code> package.</p>
</div>
<div class="paragraph">
<p>The <code>ResourceReader</code> interfaces is defined as:</p>
</div>
<div class="exampleblock">
<div class="title">Example 142. ResourceReader</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@FunctionalInterface
interface ResourceReader {

    byte[] read(Resource resource);

}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The <code>ResourceWriter</code> interfaces is defined as:</p>
</div>
<div class="exampleblock">
<div class="title">Example 143. ResourceWriter</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@FunctionalInterface
interface ResourceWriter {

    void write(Resource resource, byte[] data);

}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Both interfaces provide additional methods to compose readers and writers, much like Java&#8217;s <code>Consumer</code> and <code>Function</code>
interfaces in the <code>java.util.function</code> package. If a particular reader or writer is used in a composition and is unable
to handle the given <code>Resource</code>, it should throw a <code>UnhandledResourceException</code> to let the next reader or writer in the
composition try to read from or write to the <code>Resource</code>.</p>
</div>
<div class="paragraph">
<p>The reader or writer are free to throw a <code>ResourceReadException</code> or <code>ResourceWriteException</code> to break the chain of
reader and writer invocations in the composition.</p>
</div>
<div class="paragraph">
<p>To override the default export/import reader and writer used by SBDG, you can implement the <code>ResourceReader</code>
or <code>ResourceWriter</code> interfaces as appropriate and declare instances of these classes as beans in the Spring container:</p>
</div>
<div class="exampleblock">
<div class="title">Example 144. Custom <code>ResourceReader</code> &amp; <code>ResourceWriter</code> beans</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Configuration
class MyApplicationConfiguration {

	@Bean
    ResourceReader myResourceReader() {
		return new MyResourceReader()
            .thenReadFrom(new MyOtherResourceReader());
    }

    @Bean
    ResourceWriter myResourceWriter() {
		return new MyResourceWriter();
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="geode-data-serialization">16. Data Serialization with PDX</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Anytime data is overflowed or persisted to disk, transferred between clients and servers, transferred between peers
in a cluster or between different clusters in a multi-site WAN topology, all data stored in Apache Geode must be
serializable.</p>
</div>
<div class="paragraph">
<p>To serialize objects in Java, object types must implement the <code>java.io.Serializable</code> interface. However, if you have a
large number of application domain object types that currently do not implement <code>java.io.Serializable</code>, refactoring
hundreds or even thousands of class types to implement <code>java.io.Serializable</code> would be a tedious task just to store
and manage those objects in Apache Geode.</p>
</div>
<div class="paragraph">
<p>Additionally, it is not only your application domain object types you necessarily need to consider. If you used
third-party libraries in your application domain model, any types referred to by your application domain object types
stored in Apache Geode must also be serializable. This type explosion may bleed into class types for which you may have
no control over.</p>
</div>
<div class="paragraph">
<p>Furthermore, Java serialization is not the most efficient format, given that metadata about your types is stored with
the data itself. Therefore, even though Java serialized bytes are more descriptive, it adds a great deal of overhead.</p>
</div>
<div class="paragraph">
<p>Then, along came serialization using Apache Geode&#8217;s
<a href="https://geode.apache.org/docs/guide/{apache-geode-doc-version}/developing/data_serialization/gemfire_pdx_serialization.html">PDX</a> format.
PDX stands for Portable Data Exchange and achieves four goals:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Separates type metadata from the data itself, streamlining the bytes during transfer. Apache Geode maintains a type
registry that stores type metadata about the objects serialized with PDX.</p>
</li>
<li>
<p>Supports versioning as your application domain types evolve. It is common to have old and new versions of the same
application deployed to production, running simultaneously, sharing data, and possibly using different versions of the
same domain types. PDX lets fields be added or removed while still preserving interoperability between old and new
application clients without loss of data.</p>
</li>
<li>
<p>Enables objects stored as PDX to be queried without being de-serialized. Constant serialization and deserialization of
data is a resource-intensive task that adds to the latency of each data request when redundancy is enabled. Since data
is replicated across peers in the cluster to preserve High Availability (HA) and must be serialized to be transferred,
keeping data serialized is more efficient when data is updated frequently, since it is likely the data will need to be
transferred again in order to maintain consistency in the face of redundancy and availability.</p>
</li>
<li>
<p>Enables interoperability between native language clients (such as C, C++ and C#) and Java language clients, with each
being able to access the same data set regardless from where the data originated.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>However, PDX does have limitations.</p>
</div>
<div class="paragraph">
<p>For instance, unlike Java serialization, PDX does not handle cyclic dependencies. Therefore, you must be careful how you
structure and design your application domain object types.</p>
</div>
<div class="paragraph">
<p>Also, PDX cannot handle field type changes.</p>
</div>
<div class="paragraph">
<p>Furthermore, while Apache Geode&#8217;s general <a href="https://geode.apache.org/docs/guide/{apache-geode-doc-version}/developing/data_serialization/gemfire_data_serialization.html">Data Serialization</a>
handles <a href="https://geode.apache.org/docs/guide/{apache-geode-doc-version}/developing/delta_propagation/chapter_overview.html">Deltas</a>, this is not achievable without
de-serializing the object, since it involves a method invocation, which defeats one of the key benefits of PDX:
preserving format to avoid the cost of serialization and deserialization.</p>
</div>
<div class="paragraph">
<p>However, we think the benefits of using PDX outweigh the limitations and, therefore, have enabled PDX by default.</p>
</div>
<div class="paragraph">
<p>You need do nothing special. You can code your domain types and rest assured that objects of those domain types are
properly serialized when overflowed and persisted to disk, transferred between clients and servers, transferred between
peers in a cluster, and even when data is transferred over the network when you use Apache Geode&#8217;s multi-site WAN
topology.</p>
</div>
<div class="exampleblock">
<div class="title">Example 145. EligibilityDecision is automatically serialiable without implementing Java Serializable.</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Region("EligibilityDecisions")
class EligibilityDecision {
    // ...
}</code></pre>
</div>
</div>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Apache Geode does <a href="https://geode.apache.org/docs/guide/{apache-geode-doc-version}/developing/data_serialization/java_serialization.html">support</a> the standard
Java Serialization format.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_sdg_mappingpdxserializer_vs_apache_geodes_reflectionbasedautoserializer">16.1. SDG <code>MappingPdxSerializer</code> vs. Apache Geode&#8217;s <code>ReflectionBasedAutoSerializer</code></h3>
<div class="paragraph">
<p>Under-the-hood, Spring Boot for Apache Geode <a href="https://docs.spring.io/spring-data/geode/docs/current/reference/html/#bootstrap-annotation-config-pdx">enables</a>
and uses Spring Data for Apache Geode&#8217;s
<a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/mapping/MappingPdxSerializer.html"><code>MappingPdxSerializer</code></a>
to serialize your application domain objects with PDX.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
See the SDG <a href="https://docs.spring.io/spring-data/geode/docs/current/reference/html/#mapping.pdx-serializer">Reference Guide</a> for more details
on the <code>MappingPdxSerializer</code> class.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <code>MappingPdxSerializer</code> class offers several advantages above and beyond Apache Geode&#8217;s own
<a href="https://geode.apache.org/releases/latest/javadoc/org/apache/geode/pdx/ReflectionBasedAutoSerializer.html"><code>ReflectionBasedAutoSerializer</code></a> class.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
See Apache Geode&#8217;s <a href="https://geode.apache.org/docs/guide/{apache-geode-doc-version}/developing/data_serialization/auto_serialization.html">User Guide</a>
for more details about the <code>ReflectionBasedAutoSerializer</code>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The SDG <code>MappingPdxSerializer</code> class offers the following benefits and capabilities:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>PDX serialization is based on Spring Data&#8217;s powerful mapping infrastructure and metadata.</p>
</li>
<li>
<p>Includes support for both <code>includes</code> and <code>excludes</code> with first-class
<a href="https://docs.spring.io/spring-data/geode/docs/current/reference/html/#mapping.pdx-serializer.type-filtering">type filtering</a>.
Additionally, you can implement type filters by using Java&#8217;s <code>java.util.function.Predicate</code> interface as opposed to
the limited regex capabilities provided by Apache Geode&#8217;s <code>ReflectionBasedAutoSerializer</code> class. By default,
<code>MappingPdxSerializer</code> excludes all types in the following packages: <code>java</code>, <code>org.apache.geode</code>, <code>org.springframework</code>
and <code>com.gemstone.gemfire</code>.</p>
</li>
<li>
<p>Handles <a href="https://docs.spring.io/spring-data/geode/docs/current/reference/html/#mapping.pdx-serializer.transient-properties">transient object fields
and properties</a> when either Java&#8217;s <code>transient</code> keyword or Spring Data&#8217;s <code>@Transient</code> annotation is used.</p>
</li>
<li>
<p>Handles <a href="https://docs.spring.io/spring-data/geode/docs/current/reference/html/#mapping.pdx-serializer.read-only-properties">read-only object properties</a>.</p>
</li>
<li>
<p>Automatically determines the identifier of your entities when you annotate the appropriate entity field or property
with Spring Data&#8217;s <a href="https://docs.spring.io/spring-data/commons/docs/current/api/org/springframework/data/annotation/Id.html"><code>@Id</code></a> annotation.</p>
</li>
<li>
<p>Lets additional <code>o.a.g.pdx.PdxSerializers</code> be registered to
<a href="https://docs.spring.io/spring-data/geode/docs/current/reference/html/#mapping.pdx-serializer.custom-serialization">customize the serialization</a>
of nested entity/object field and property types.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The support for <code>includes</code> and <code>excludes</code> deserves special attention, since the <code>MappingPdxSerializer</code> excludes all Java,
Spring, and Apache Geode types, by default. However, what happens when you need to serialize one of those types?</p>
</div>
<div class="paragraph">
<p>For example, suppose you need to serialize objects of type <code>java.security.Principal</code>. Then you can override the excludes
by registering an <code>include</code> type filter:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">package example.app;

import java.security.Principal;

@SpringBootApplication
@EnablePdx(serializerBeanName = "myCustomMappingPdxSerializer")
class SpringBootApacheGeodeClientCacheApplication {

    public static void main(String[] args) {
        SpringApplication.run(SpringBootApacheGeodeClientCacheApplication.class, args);
    }

    @Bean
    MappingPdxSerializer myCustomMappingPdxSerializer() {

        MappingPdxSerializer customMappingPdxSerializer =
            MappingPdxSerializer.newMappginPdxSerializer();

        customMappingPdxSerializer.setIncludeTypeFilters(
            type -&gt; Principal.class.isAssignableFrom(type));

        return customMappingPdxSerializer;
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Normally, you need not explicitly declare SDG&#8217;s <code>@EnablePdx</code> annotation to enable and configure PDX. However,
if you want to override auto-configuration, as we have demonstrated above, you must do this.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="geode-logging">17. Logging</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Apache Geode <code>1.9.2</code> was modularized to separate its use of the Apache Log4j API to log output in Apache Geode code
from the underlying implementation of logging, which uses Apache Log4j as the logging provider by default.</p>
</div>
<div class="paragraph">
<p>Prior to <code>1.9.2</code>, the Apache Log4j API (<code>log4j-api</code>) and the Apache Log4j service provider (<code>log4j-core</code>)
were automatically pulled in by Apache Geode core (<code>org.apache.geode:geode-core</code>), thereby making it problematic
to change logging providers when using Apache Geode in Spring Boot applications.</p>
</div>
<div class="paragraph">
<p>However, now, in order to get any log output from Apache Geode whatsoever, Apache Geode requires a logging provider
declared on your Spring Boot application classpath. Consequently, this also means the old Apache Geode <code>Properties</code>
(such as <code>log-level</code>) no longer have any effect, regardless of whether the property is specified in <code>gemfire.properties</code>,
in Spring Boot <code>application.properties</code>, or even as a JVM System Property (<code>-Dgemfire.log-level</code>).</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
See Apache Geode&#8217;s <a href="https://geode.apache.org/docs/guide/{apache-geode-doc-version}/reference/topics/gemfire_properties.html">documentation</a> for a complete list
of valid <code>Properties</code>, including the <code>Properties</code> used to configure logging.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Unfortunately, this also means the Spring Data for Apache Geode
<a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnableLogging.html"><code>@EnableLogging</code></a>
annotation no longer has any effect on Apache Geode logging either. Consequently, it has been
<a href="https://jira.spring.io/browse/DATAGEODE-299">deprecated</a>. The reason <code>@EnableLogging</code> no longer has any effect on logging
is because this annotation&#8217;s attributes and associated SDG properties indirectly set the corresponding Apache Geode
properties, which, again, are useless from Apache Geode <code>1.9.2</code> onward.</p>
</div>
<div class="paragraph">
<p>By way of example, and to make this concrete, <strong>none</strong> of the following approaches have any effect on Apache Geode logging:</p>
</div>
<div class="exampleblock">
<div class="title">Example 146. Command-line configuration</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="txt">$ java -classpath ...:/path/to/MySpringBootApacheGeodeClientCacheApplication.jar -Dgemfire.log-level=DEBUG
    example.app.MySpringBootApacheGeodeClientCacheApplication</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 147. Externalized configuration using Apache Geode <code>gemfire.properties</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="properties"># {geode-name} only/specific properties
log-level=INFO</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 148. Externalized configuration using Spring Boot <code>application.properties</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="properties">spring.data.gemfire.cache.log-level=DEBUG
spring.data.gemfire.logging.level=DEBUG</code></pre>
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 149. Java configuration using SDG&#8217;s <code>@EnableLogging</code> annotation</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@SpringBootApplication
@EnableLogging(logLevel = "DEBUG")
class MySpringBootApacheGeodeClientApplication {

}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>None of the preceding approaches have any effect without the <strong>new</strong> SBDG logging starter.</p>
</div>
<div class="sect2">
<h3 id="geode-logging-configuration">17.1. Configure Apache Geode Logging</h3>
<div class="paragraph">
<p>So, how do you configure logging for Apache Geode?</p>
</div>
<div class="paragraph">
<p>Three things are required to get Apache Geode to log output:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>You must declare a logging provider (such as Logback, or Log4j) on your Spring Boot application classpath.</p>
</li>
<li>
<p>(optional) You can declare an adapter (a bridge JAR) between Log4j and your logging provider if your declared
logging provider is not Apache Log4j.</p>
<div class="paragraph">
<p>For example, if you use the SLF4J API to log output from your Spring Boot application and use Logback as your
logging provider or implementation, you must include the <code>org.apache.logging.log4j.log4j-to-slf4j</code> adapter or
bridge JAR as well.</p>
</div>
<div class="paragraph">
<p>Internally, Apache Geode uses the Apache Log4j API to log output from Geode components. Therefore, you must bridge Log4j
to any other logging provider (such as Logback) that is not Log4j (<code>log4j-core</code>). If you use Log4j as your
logging provider, you need not declare an adapter or bridge JAR on your Spring Boot application classpath.</p>
</div>
</li>
<li>
<p>Finally, you must supply logging provider configuration to configure Loggers, Appenders, log levels, and other details.</p>
<div class="paragraph">
<p>For example, when you use Logback, you must provide a <code>logback.xml</code> configuration file on your Spring Boot application
classpath or in the filesystem. Alternatively, you can use other means to configure your logging provider and get
Apache Geode to log output.</p>
</div>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Apache Geode&#8217;s <code>geode-log4j</code> module covers the required configuration for steps 1-3 above and uses Apache Log4j
(<code>org.apache.logging.log4j:log4j-core</code>) as the logging provider. The <code>geode-log4j</code> module even provides a default
<code>log4j2.xml</code> configuration file to configure Loggers, Appenders, and log levels for Apache Geode.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If you declare Spring Boot&#8217;s own <code>org.springframework.boot:spring-boot-starter-logging</code> on your application
classpath, it covers steps 1 and 2 above.</p>
</div>
<div class="paragraph">
<p>The <code>spring-boot-starter-logging</code> dependency declares Logback as the logging provider and automatically adapts (bridges)
<code>java.util.logging</code> (JUL) and Apache Log4j to SLF4J. However, you still need to supply logging provider configuration
(such as a <code>logback.xml</code> file for Logback) to configure logging not only for your Spring Boot application but for
Apache Geode as well.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If no user-specified logging configuration is supplied, Logback will apply default configuration
using the <code>BasicConfigurator</code>. See Logback <a href="https://logback.qos.ch/manual/configuration.html#auto_configuration">documentation</a>
for complete details.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>SBDG has simplified the setup of Apache Geode logging. You need only declare the
<code>org.springframework.geode:spring-geode-starter-logging</code> dependency on your Spring Boot application classpath.</p>
</div>
<div class="paragraph">
<p>Unlike Apache Geode&#8217;s default Log4j XML configuration file (<code>log4j2.xml</code> from <code>geode-log4j</code>), SBDG&#8217;s provided
<code>logback.xml</code> configuration file is properly parameterized, letting you adjust log levels, add Appenders
as well as adjust other logging settings.</p>
</div>
<div class="paragraph">
<p>In addition, SBDG&#8217;s provided Logback configuration uses templates so that you can compose your own logging configuration
while still including snippets from SBDG&#8217;s provided logging configuration, such as Loggers and Appenders.</p>
</div>
<div class="sect3">
<h4 id="geode-logging-configuration-log-levels">17.1.1. Configuring Log Levels</h4>
<div class="paragraph">
<p>One of the most common logging tasks is to adjust the log level of one or more Loggers or the ROOT Logger. However,
you may want to only adjust the log level for specific components of your Spring Boot application, such as for
Apache Geode, by setting the log level for only the Logger that logs Apache Geode events.</p>
</div>
<div class="paragraph">
<p>SBDG&#8217;s Logback configuration defines three Loggers to control the log output from Apache Geode:</p>
</div>
<div class="exampleblock">
<div class="title">Example 150. Apache Geode Loggers by Name</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;comfiguration&gt;
  &lt;logger name="com.gemstone.gemfire" level="${spring.boot.data.gemfire.log.level:-INFO}"/&gt;
  &lt;logger name="org.apache.geode" level="${spring.boot.data.gemfire.log.level:-INFO}"/&gt;
  &lt;logger name="org.jgroups" level="${spring.boot.data.gemfire.jgroups.log.level:-WARN}"/&gt;
&lt;/comfiguration&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The <code>com.gemstone.gemfire</code> Logger covers old GemFire components that are still present in Apache Geode for backwards
compatibility. By default, it logs output at <code>INFO</code>. This Logger&#8217;s use should be mostly unnecessary.</p>
</div>
<div class="paragraph">
<p>The <code>org.apache.geode</code> Logger is the primary Logger used to control log output from all Apache Geode components
during the runtime operation of Apache Geode. By default, it logs output at <code>INFO</code>.</p>
</div>
<div class="paragraph">
<p>The <code>org.jgroups</code> Logger is used to log output from Apache Geode&#8217;s message distribution and membership system.
Apache Geode uses JGroups for membership and message distribution between peer members (nodes) in the cluster
(distributed system). By default, JGroups logs output at <code>WARN</code>.</p>
</div>
<div class="paragraph">
<p>You can configure the log level for the <code>com.gemstone.gemfire</code> and <code>org.apache.geode</code> Loggers by setting
the <code>spring.boot.data.gemfire.log.level</code> property. You can independently configure the <code>org.jgroups</code> Logger by setting
the <code>spring.boot.data.gemfire.jgroups.log.level</code> property.</p>
</div>
<div class="paragraph">
<p>You can set the SBDG logging properties on the command line as JVM System properties when you run
your Spring Boot application:</p>
</div>
<div class="exampleblock">
<div class="title">Example 151. Setting the log-level from the CLI</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="text">$ java -classpath ...:/path/to/MySpringBootApplication.jar -Dspring.boot.data.gemfire.log.level=DEBUG
    package.to.MySpringBootApplicationClass</code></pre>
</div>
</div>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Setting JVM System properties by using
<code>$ java -jar MySpringBootApplication.jar -Dspring.boot.data.gemfire.log.level=DEBUG</code>
is not supported by the Java Runtime Environment (JRE).
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Alternatively, you can configure and control Apache Geode logging in Spring Boot <code>application.properties</code>:</p>
</div>
<div class="exampleblock">
<div class="title">Example 152. Setting the log-level in Spring Boot <code>application.properties</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="properties">spring.boot.data.gemfire.log.level=DEBUG</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>For backwards compatibility, SBDG additionally supports the Spring Data for Apache Geode (SDG) logging properties
as well, by using either of the following properties:</p>
</div>
<div class="exampleblock">
<div class="title">Example 153. Setting log-level using SDG Properties</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="properties">spring.data.gemfire.cache.log-level=DEBUG
spring.data.gemfire.logging.level=DEBUG</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>If you previously used either of these SDG-based logging properties, they continue to work as designed in SBDG <code>1.3</code>
or later.</p>
</div>
</div>
<div class="sect3">
<h4 id="geode-logging-configuration-composition">17.1.2. Composing Logging Configuration</h4>
<div class="paragraph">
<p>As mentioned earlier, SBDG lets you compose your own logging configuration from SBDG&#8217;s default Logback configuration
metadata.</p>
</div>
<div class="paragraph">
<p>SBDG conveniently bundles the Properties, Loggers and Appenders from SBDG&#8217;s logging starter into several template files
that you can include into your own custom Logback XML configuration file.</p>
</div>
<div class="paragraph">
<p>The Logback configuration template files are broken down into:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>org/springframework/geode/logging/slf4j/logback/properties-include.xml</code></p>
</li>
<li>
<p><code>org/springframework/geode/logging/slf4j/logback/loggers-include.xml</code></p>
</li>
<li>
<p><code>org/springframework/geode/logging/slf4j/logback/appenders-include.xml</code></p>
</li>
</ul>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
As of SBDG <code>3.0</code>, the <code>logback-include.xml</code> file was removed.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <code>properties-include.xml</code> defines Logback "<em>local</em>" scoped properties or variables common to SBDG&#8217;s configuration
of Apache Geode logging.</p>
</div>
<div class="exampleblock">
<div class="title">Example 154. properties-include.xml</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;included&gt;

	&lt;property name="SPRING_BOOT_LOG_CHARSET" value="${SPRING_BOOT_LOG_CHARSET:-${file.encoding:-UTF-8}}"/&gt;
	&lt;property name="SPRING_BOOT_LOG_PATTERN" value="${SPRING_BOOT_LOG_PATTERN:-%d %5p %40.40c:%4L - %msg%n}"/&gt;
	&lt;property name="APACHE_GEODE_LOG_CHARSET" value="${APACHE_GEODE_LOG_CHARSET:-${file.encoding:-UTF-8}}"/&gt;
	&lt;property name="APACHE_GEODE_LOG_PATTERN" value="${APACHE_GEODE_LOG_PATTERN:-[%level{lowerCase=true} %date{yyyy/MM/dd HH:mm:ss.SSS z} &amp;lt;%thread&amp;gt;] %message%n%throwable%n}"/&gt;

&lt;/included&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The <code>loggers-include.xml</code> file defines the <code>Loggers</code> used to log output from Apache Geode components.</p>
</div>
<div class="exampleblock">
<div class="title">Example 155. loggers-include.xml</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;included&gt;

	&lt;logger name="com.gemstone.gemfire" level="${spring.boot.data.gemfire.log.level:-INFO}" additivity="false"&gt;
		&lt;appender-ref ref="${spring.geode.logging.appender-ref:-CONSOLE}"/&gt;
		&lt;appender-ref ref="delegate"/&gt;
	&lt;/logger&gt;

	&lt;logger name="org.apache.geode" level="${spring.boot.data.gemfire.log.level:-INFO}" additivity="false"&gt;
		&lt;appender-ref ref="${spring.geode.logging.appender-ref:-CONSOLE}"/&gt;
		&lt;appender-ref ref="delegate"/&gt;
	&lt;/logger&gt;

	&lt;logger name="org.jgroups" level="${spring.boot.data.gemfire.jgroups.log.level:-WARN}" additivity="false"&gt;
		&lt;appender-ref ref="${spring.geode.logging.appender-ref:-CONSOLE}"/&gt;
		&lt;appender-ref ref="delegate"/&gt;
	&lt;/logger&gt;

&lt;/included&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The <code>appenders-include.xml</code> file defines Appenders to send the log output to. If Spring Boot is on the application
classpath, then Spring Boot logging configuration will define the "CONSOLE" <code>Appender</code>, otherwise, SBDG will provide
a default definition.</p>
</div>
<div class="paragraph">
<p>The "geode" <code>Appender</code> defines the Apache Geode logging pattern as seen in Apache Geode&#8217;s Log4j configuration.</p>
</div>
<div class="exampleblock">
<div class="title">Example 156. appenders-include.xml</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;included&gt;

	&lt;if condition='property("bootPresent").equals("false")'&gt;
		&lt;then&gt;
			&lt;appender name="CONSOLE" class="ch.qos.logback.core.ConsoleAppender"&gt;
				&lt;encoder&gt;
					&lt;charset&gt;${SPRING_BOOT_LOG_CHARSET}&lt;/charset&gt;
					&lt;pattern&gt;${SPRING_BOOT_LOG_PATTERN}&lt;/pattern&gt;
				&lt;/encoder&gt;
			&lt;/appender&gt;
		&lt;/then&gt;
	&lt;/if&gt;

	&lt;appender name="delegate" class="org.springframework.geode.logging.slf4j.logback.DelegatingAppender"/&gt;

	&lt;appender name="geode" class="ch.qos.logback.core.ConsoleAppender"&gt;
		&lt;encoder&gt;
			&lt;charset&gt;${APACHE_GEODE_LOG_CHARSET}&lt;/charset&gt;
			&lt;pattern&gt;${APACHE_GEODE_LOG_PATTERN}&lt;/pattern&gt;
		&lt;/encoder&gt;
	&lt;/appender&gt;

&lt;/included&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Then you can include any of SBDG&#8217;S Logback configuration metadata files as needed in your application-specific
Logback XML configuration file, as follows:</p>
</div>
<div class="exampleblock">
<div class="title">Example 157. application-specific logback.xml</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;configuration&gt;

	&lt;include resource="org/springframework/geode/logging/slf4j/logback/properties-include.xml"/&gt;
	&lt;include resource="org/springframework/geode/logging/slf4j/logback/appender-include.xml"/&gt;

	&lt;logger name="org.apache.geode" level="INFO" additivity="false"&gt;
		&lt;appender-ref ref="geode"/&gt;
	&lt;/logger&gt;

	&lt;root level="${logback.root.log.level:-INFO}"&gt;
		&lt;appender-ref ref="CONSOLE"/&gt;
		&lt;appender-ref ref="delegate"/&gt;
	&lt;/root&gt;

&lt;/configuration&gt;</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="geode-logging-configuration-customizing">17.1.3. Customizing Logging Configuration</h4>
<div class="paragraph">
<p>It is now possible to customize the configuration of Apache Geode logging using properties defined in
a <code>spring-geode-logging.properties</code> file included on the Spring Boot application classpath.</p>
</div>
<div class="paragraph">
<p>Any of the properties defined in <code>org/springframework/geode/logging/slf4j/logback/properties-include.xml</code> (shown above),
such as <code>APACHE_GEODE_LOG_PATTERN</code>, or the <code>spring.geode.logging.appender-ref</code> property, can be set.</p>
</div>
<div class="paragraph">
<p>For instance, and by default, Apache Geode components log output using the Spring Boot log pattern. However, if you
prefer the fine-grained details of Apache Geode&#8217;s logging behavior, you can change the <code>Appender</code> used by
the Apache Geode <code>Logger&#8217;s</code> to use the pre-defined "geode" <code>Appender</code> instead. Simply set
the <code>spring-geode.logging.appender-ref</code> property to "geode" in a <code>spring-geode-logging.properties</code> file
on your Spring Boot application classpath, as follows:</p>
</div>
<div class="exampleblock">
<div class="title">Example 158. spring-geode-logging.properties</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="properties"># spring-geode-logging.properties
spring.geode.logging.appender-ref=geode</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Alternatively, if you want to configure the log output of your entire Spring Boot application, including log output
from all Apache Geode components, then you can set the <code>SPRING_BOOT_LOG_PATTERN</code> property, or Spring Boot&#8217;s
<code>CONSOLE_LOG_PATTERN</code> property, in <code>spring-geode-logging.properties</code>, as follows:</p>
</div>
<div class="exampleblock">
<div class="title">Example 159. spring-geode-logging.properties</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="properties"># spring-geode-logging.properties
CONSOLE_LOG_PATTERN=TEST - %msg%n</code></pre>
</div>
</div>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <code>spring-geode-logging.properties</code> file is only recognized when the <code>spring-geode-starter-logging</code> module
is used.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="geode-logging-slf4j-logback-api-support">17.2. SLF4J and Logback API Support</h3>
<div class="paragraph">
<p>SBDG provides additional support when working with the SLF4J and Logback APIs. This support is available when you
declare the <code>org.springframework.geode:spring-geode-starter-logging</code> dependency on your Spring Boot application
classpath.</p>
</div>
<div class="paragraph">
<p>One of the main supporting classes from the <code>spring-geode-starter-logger</code>
is the <code>org.springframework.geode.logging.slf4j.logback.LogbackSupport</code> class. This class provides methods to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Resolve a reference to the Logback <code>LoggingContext</code>.</p>
</li>
<li>
<p>Resolve the SLF4J ROOT <code>Logger</code> as a Logback <code>Logger</code>.</p>
</li>
<li>
<p>Look up <code>Appenders</code> by name and required type.</p>
</li>
<li>
<p>Add or remove <code>Appenders</code> to <code>Loggers</code>.</p>
</li>
<li>
<p>Reset the state of the Logback logging system, which can prove to be most useful during testing.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>LogbackSupport</code> can even suppress the auto-configuration of Logback performed by Spring Boot on startup, which is
another useful utility during automated testing.</p>
</div>
<div class="paragraph">
<p>In addition to the <code>LogbackSupport</code> class, SBDG also provides some custom Logback <code>Appenders</code>.</p>
</div>
<div class="sect3">
<h4 id="geode-logging-slf4j-logback-api-support-appender-composite">17.2.1. CompositeAppender</h4>
<div class="paragraph">
<p>The <code>org.springframework.geode.logging.slf4j.logback.CompositeAppender</code> class is an implementation of the Logback
<code>Appender</code> interface and the <a href="https://en.wikipedia.org/wiki/Composite_pattern">Composite software design pattern</a>.</p>
</div>
<div class="paragraph">
<p><code>CompositeAppender</code> lets developers compose multiple Appenders and use them as if they were a single <code>Appender</code>.</p>
</div>
<div class="paragraph">
<p>For example, you could compose both the Logback <code>ConsoleAppender</code> and <code>FileAppender</code> into one <code>Appender</code>:</p>
</div>
<div class="exampleblock">
<div class="title">Example 160. Composing multiple <code>Appenders</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">class LoggingConfiguration {

  Appender&lt;ILoggingEvent&gt; compositeAppender() {

    ConsoleAppender&lt;ILoggingEvent&gt; consoleAppender = new ConsoleAppender&lt;&gt;();

    FileAppender&lt;ILoggingEvent&gt; fileAppender = new FileApender&lt;&gt;();

    Appender&lt;ILoggingEvent&gt; compositeAppender = CompositeAppender.compose(consoleAppender, fileAppender);

    return compositeAppender;
  }
}

// do something with the compositeAppender</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>You could then add the <code>CompositeAppender</code> to a named <code>Logger</code>:</p>
</div>
<div class="exampleblock">
<div class="title">Example 161. Register <code>CompositeAppender</code> on "named" <code>Logger</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">class LoggerConfiguration {

  void registerAppenderOnLogger() {

    Logger namedLogger = LoggerFactory.getLogger("loggerName");

    LogbackSupport.toLogbackLogger(namedLogger)
      .ifPresent(it -&gt; LogbackSupport.addAppender(it, compositeAppender));
  }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>In this case, the named <code>Logger</code> logs events (or log messages) to both the console and file Appenders.</p>
</div>
<div class="paragraph">
<p>You can compose an array or <code>Iterable</code> of <code>Appenders</code> by using either the
<code>CompositeAppender.compose(:Appender&lt;T&gt;[])</code> method or the <code>CompositeAppender.compose(:Iterable&lt;Appender&lt;T&gt;&gt;)</code> method.</p>
</div>
</div>
<div class="sect3">
<h4 id="geode-logging-slf4j-logback-api-support-appender-delegate">17.2.2. DelegatingAppender</h4>
<div class="paragraph">
<p>The <code>org.springframework.geode.logging.slf4j.logback.DelegatingAppender</code> is a pass-through Logback <code>Appender</code>
implementation that wraps another Logback <code>Appender</code> or collection of <code>Appenders</code>, such as the <code>ConsoleAppender</code>,
a <code>FileAppender</code>, a <code>SocketAppender</code>, or others. By default, the <code>DelegatingAppender</code> delegates to the <code>NOPAppender</code>,
thereby doing no actual work.</p>
</div>
<div class="paragraph">
<p>By default, SBDG registers the <code>org.springframework.geode.logging.slfj4.logback.DelegatingAppender</code> with the ROOT
<code>Logger</code>, which can be useful for testing purposes.</p>
</div>
<div class="paragraph">
<p>With a reference to a <code>DelegatingAppender</code>, you can add any <code>Appender</code> (even a <code>CompositeAppender</code>) as the delegate:</p>
</div>
<div class="exampleblock">
<div class="title">Example 162. Add <code>ConsoleAppender</code> as the "delegate" for the <code>DelegatingAppender</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">class LoggerConfiguration {

  void setupDelegation() {

    ConsoleAppender consoleAppender = new ConsoleAppender();

    LogbackSupport.resolveLoggerContext().ifPresent(consoleAppender::setContext);

    consoleAppender.setImmediateFlush(true);
    consoleAppender.start();

    LogbackSupport.resolveRootLogger()
      .flatMap(LogbackSupport::toLogbackLogger)
      .flatMap(rootLogger -&gt; LogbackSupport.resolveAppender(rootLogger,
        LogbackSupport.DELEGATE_APPENDER_NAME, DelegatingAppender.class))
      .ifPresent(delegateAppender -&gt; delegateAppender.setAppender(consoleAppender));
  }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="geode-logging-slf4j-logback-api-support-appender-string">17.2.3. StringAppender</h4>
<div class="paragraph">
<p>The <code>org.springframework.geode.logging.slf4j.logback.StringAppender</code> stores a log message in-memory, appended to
a <code>String</code>.</p>
</div>
<div class="paragraph">
<p>The <code>StringAppender</code> is useful for testing purposes. For instance, you can use the <code>StringAppender</code> to assert that
a <code>Logger</code> used by certain application components logged messages at the appropriately configured log level
while other log messages were not logged.</p>
</div>
<div class="paragraph">
<p>Consider the following example:</p>
</div>
<div class="exampleblock">
<div class="title">Example 163. <code>StringAppender</code> in Action</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">class ApplicationComponent {

	private final Logger logger = LoggerFactory.getLogger(getClass());

	public void someMethod() {
		logger.debug("Some debug message");
		// ...
	}

	public void someOtherMethod() {
		logger.info("Some info message");
	}
}

// Assuming the ApplicationComponent Logger was configured with log-level 'INFO', then...
class ApplicationComponentUnitTests {

	private final ApplicationComponent applicationComponent = new ApplicationComponent();

	private final Logger logger = LoggerFactory.getLogger(ApplicationComponent.class);

	private StringAppender stringAppender;

	@Before
    public void setup() {

        LogbackSupport.toLogbackLogger(logger)
            .map(Logger::getLevel)
            .ifPresent(level -&gt; assertThat(level).isEqualTo(Level.INFO));

        stringAppender = new StringAppender.Builder()
            .applyTo(logger)
            .build();
    }

    @Test
    public void someMethodDoesNotLogDebugMessage() {

        applicationComponent.someMethod();

        assertThat(stringAppender.getLogOutput).doesNotContain("Some debug message");
    }

    @Test
    public void someOtherMethodLogsInfoMessage() {

        applicationComponent.someOtherMethod();

        assertThat(stringAppender.getLogOutput()).contains("Some info message");
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>There are many other uses for the <code>StringAppender</code> and you can use it safely in a multi-Threaded context by calling
<code>StringAppender.Builder.useSynchronization()</code>.</p>
</div>
<div class="paragraph">
<p>When combined with other SBDG provided <code>Appenders</code> in conjunction with the <code>LogbackSupport</code> class, you have a lot of
power both in application code as well as in your tests.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="geode-security">18. Security</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This chapter covers security configuration for Apache Geode, which includes both authentication and authorization
(collectively, auth) as well as Transport Layer Security (TLS) using SSL.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Securing data at rest is not supported by Apache Geode.
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
See the corresponding sample <a href="guides/boot-security.html">guide</a> and {github-samples-url}/boot/security[code]
to see Spring Boot Security for Apache Geode in action.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="geode-security-auth">18.1. Authentication and Authorization</h3>
<div class="paragraph">
<p>Apache Geode employs username- and password-based <a href="https://geode.apache.org/docs/guide/{apache-geode-doc-version}/managing/security/authentication_overview.html">authentication</a>
and role-based <a href="https://geode.apache.org/docs/guide/{apache-geode-doc-version}/managing/security/authorization_overview.html">authorization</a> to secure your client to
server data exchanges and operations.</p>
</div>
<div class="paragraph">
<p>Spring Data for Apache Geode provides <a href="https://docs.spring.io/spring-data/geode/docs/current/reference/html/#bootstrap-annotation-config-security">first-class support</a>
for Apache Geode&#8217;s Security framework, which is based on the
<a href="https://geode.apache.org/releases/latest/javadoc/org/apache/geode/security/SecurityManager.html"><code>SecurityManager</code></a> interface.
Additionally, Apache Geode&#8217;s Security framework is integrated with <a href="https://shiro.apache.org/">Apache Shiro</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
SBDG will eventually provide support for and integration with
<a href="https://spring.io/projects/spring-security">Spring Security</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When you use Spring Boot for Apache Geode, which builds Spring Data for Apache Geode, it makes short work of
enabling auth in both your clients and servers.</p>
</div>
<div class="sect3">
<h4 id="geode-security-auth-servers">18.1.1. Auth for Servers</h4>
<div class="paragraph">
<p>The easiest and most standard way to enable auth in the servers of your cluster is to simply define one or more
Apache Shiro <a href="https://shiro.apache.org/realm.html">Realms</a> as beans in the Spring <code>ApplicationContext</code>.</p>
</div>
<div class="paragraph">
<p>Consider the following example:</p>
</div>
<div class="exampleblock">
<div class="title">Example 164. Declaring an Apache Shiro Realm</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Configuration
class ApacheGeodeSecurityConfiguration {

    @Bean
    DefaultLdapRealm ldapRealm() {
        return new DefaultLdapRealm();
    }

    // ...
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>When an Apache Shiro Realm (such as <code>DefaultLdapRealm</code>) is declared and registered in the Spring <code>ApplicationContext</code>
as a Spring bean, Spring Boot automatically detects this <code>Realm</code> bean (or <code>Realm</code> beans if more than one is configured),
and the servers in the Apache Geode cluster are automatically configured with authentication and authorization enabled.</p>
</div>
<div class="paragraph">
<p>Alternatively, you can provide a custom, application-specific implementation of Apache Geode&#8217;s
<a href="https://geode.apache.org/releases/latest/javadoc/org/apache/geode/security/SecurityManager.html"><code>SecurityManager</code></a> interface,
declared and registered as a bean in the Spring <code>ApplicationContext</code>:</p>
</div>
<div class="exampleblock">
<div class="title">Example 165. Declaring a custom Apache Geode <code>SecurityManager</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Configuration
class ApacheGeodeSecurityConfiguration {

    @Bean
    CustomSecurityManager customSecurityManager() {
        return new CustomSecurityManager();
    }

    // ...
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Spring Boot discovers your custom, application-specific <code>SecurityManager</code> implementation and configures the servers
in the Apache Geode cluster with authentication and authorization enabled.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
The Spring team recommends that you use Apache Shiro to manage the authentication and authorization of your
servers over implementing Apache Geode&#8217;s <code>SecurityManager</code> interface.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="geode-security-auth-clients">18.1.2. Auth for Clients</h4>
<div class="paragraph">
<p>When servers in an Apache Geode cluster have been configured with authentication and authorization enabled, clients
must authenticate when connecting.</p>
</div>
<div class="paragraph">
<p>Spring Boot for Apache Geode makes this easy, regardless of whether you run your Spring Boot <code>ClientCache</code> applications
in a local, non-managed environment or run in a cloud-managed environment.</p>
</div>
<div class="sect4">
<h5 id="geode-security-auth-clients-non-managed">Non-Managed Auth for Clients</h5>
<div class="paragraph">
<p>To enable auth for clients that connect to a secure Apache Geode cluster, you need only set a username and password
in Spring Boot <code>application.properties</code>:</p>
</div>
<div class="exampleblock">
<div class="title">Example 166. Spring Boot <code>application.properties</code> for the client</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="txt"># Spring Boot client application.properties

spring.data.gemfire.security.username = jdoe
spring.data.gemfire.security.password = p@55w0rd</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Spring Boot for Apache Geode handles the rest.</p>
</div>
</div>
<div class="sect4">
<h5 id="geode-secuirty-auth-clients-managed">Managed Auth for Clients</h5>
<div class="paragraph">
<p>Enabling auth for clients that connect to a VMware Tanzu GemFire for VMs service instance (PCC)
in VMware Tanzu Application Service (TAS) (PCF) is even easier: You need do nothing.</p>
</div>
<div class="paragraph">
<p>If your Spring Boot application uses SBDG and is bound to PCC, when you deploy (that is, <code>cf push</code>) your application
to PCF, Spring Boot for Apache Geode extracts the required auth credentials from the environment that you set up when
you provisioned a PCC service instance in your PCF organization and space. PCC automatically assigns two users with
roles of <code>cluster_operator</code> and <code>developer</code>, respectively, to any Spring Boot application bound to the PCC service
instance.</p>
</div>
<div class="paragraph">
<p>By default, SBDG auto-configures your Spring Boot application to run with the user that has the <code>cluster_operator</code> role.
This ensures that your Spring Boot application has the necessary permission (authorization) to perform all data access
operations on the servers in the PCC cluster, including, for example, pushing configuration metadata from the client
to the servers in the PCC cluster.</p>
</div>
<div class="paragraph">
<p>See the <a href="#cloudfoundry-cloudcache-security-auth-runtime-user-configuration">Running Spring Boot applications as a specific user</a> section
in the <a href="#cloudfoundry">Pivotal CloudFoundry</a> chapter for additional details on user authentication and authorization.</p>
</div>
<div class="paragraph">
<p>See the <a href="#cloudfoundry">chapter</a> (titled &#8220;Pivotal CloudFoundry&#8221;) for more general details.</p>
</div>
<div class="paragraph">
<p>See the <a href="https://docs.pivotal.io/p-cloud-cache/{pivotal-cloudcache-doc-version}/security.html">Pivotal Cloud Cache documentation</a> for security details
when you use PCC and PCF.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="geode-security-ssl">18.2. Transport Layer Security using SSL</h3>
<div class="paragraph">
<p>Securing data in motion is also essential to the integrity of your Spring [Boot] applications.</p>
</div>
<div class="paragraph">
<p>For instance, it would not do much good to send usernames and passwords over plain text socket connections
between your clients and servers nor to send other sensitive data over those same connections.</p>
</div>
<div class="paragraph">
<p>Therefore, Apache Geode supports SSL between clients and servers, between JMX clients (such as Gfsh) and the Manager,
between HTTP clients when you use the Developer REST API or Pulse, between peers in the cluster, and when you use
the WAN Gateway to connect multiple sites (clusters).</p>
</div>
<div class="paragraph">
<p>Spring Data for Apache Geode provides
<a href="https://docs.spring.io/spring-data/geode/docs/current/reference/html/#bootstrap-annotation-config-ssl">first-class support</a>
for configuring and enabling SSL as well. Still, Spring Boot makes it even easier to configure and enable SSL,
especially during development.</p>
</div>
<div class="paragraph">
<p>Apache Geode requires certain properties to be configured. These properties translate to the appropriate
<code>javax.net.ssl.*</code> properties required by the JRE to create secure socket connections by using
<a href="https://docs.oracle.com/javase/8/docs/technotes/guides/security/jsse/JSSERefGuide.html">JSSE</a>.</p>
</div>
<div class="paragraph">
<p>However, ensuring that you have set all the required SSL properties correctly is an error prone and tedious task.
Therefore, Spring Boot for Apache Geode applies some basic conventions for you.</p>
</div>
<div class="paragraph">
<p>You can create a <code>trusted.keystore</code> as a JKS-based <code>KeyStore</code> file and place it in one of three well-known locations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>In your application JAR file at the root of the classpath.</p>
</li>
<li>
<p>In your Spring Boot application&#8217;s working directory.</p>
</li>
<li>
<p>In your user home directory (as defined by the <code>user.home</code> Java System property).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When this file is named <code>trusted.keystore</code> and is placed in one of these three well-known locations, Spring Boot
for Apache Geode automatically configures your client to use SSL socket connections.</p>
</div>
<div class="paragraph">
<p>If you use Spring Boot to configure and bootstrap an Apache Geode server:</p>
</div>
<div class="exampleblock">
<div class="title">Example 167. Spring Boot configured and bootstrapped Apache Geode server</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@SpringBootApplication
@CacheServerApplication
class SpringBootApacheGeodeCacheServerApplication {
    // ...
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Then Spring Boot also applies the same procedure to enable SSL on the servers (between peers).</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
During development, it is convenient to <strong>not</strong> set a <code>trusted.keystore</code> password when accessing the keys in the JKS
file. However, it is highly recommended that you secure the <code>trusted.keystore</code> file when deploying your application to
a production environment.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If your <code>trusted.keystore</code> file is secured with a password, you need to additionally specify the following property:</p>
</div>
<div class="exampleblock">
<div class="title">Example 168. Accessing a secure <code>trusted.keystore</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="txt"># Spring Boot application.properties

spring.data.gemfire.security.ssl.keystore.password=p@55w0rd!</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>You can also configure the location of the keystore and truststore files, if they are separate and have not been placed
in one of the default, well-known locations searched by Spring Boot:</p>
</div>
<div class="exampleblock">
<div class="title">Example 169. Accessing a secure <code>trusted.keystore</code> by location</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="txt"># Spring Boot application.properties

spring.data.gemfire.security.ssl.keystore = /absolute/file/system/path/to/keystore.jks
spring.data.gemfire.security.ssl.keystore.password = keystorePassword
spring.data.gemfire.security.ssl.truststore = /absolute/file/system/path/to/truststore.jks
spring.data.gemfire.security.ssl.truststore.password = truststorePassword</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>See the SDG <a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnableSsl.html"><code>EnableSsl</code></a>
annotation for all the configuration attributes and the corresponding properties expressed in <code>application.properties</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="geode-security-encryption">18.3. Securing Data at Rest</h3>
<div class="paragraph">
<p>Currently, neither Apache Geode nor Spring Boot nor Spring Data for Apache Geode offer any support for securing your
data while at rest (for example, when your data has been overflowed or persisted to disk).</p>
</div>
<div class="paragraph">
<p>To secure data at rest when using Apache Geode, with or without Spring, you must employ third-party solutions, such as
disk encryption, which is usually highly contextual and technology-specific.</p>
</div>
<div class="paragraph">
<p>For example, to secure data at rest when you use Amazon EC2, see
<a href="https://aws.amazon.com/blogs/security/how-to-protect-data-at-rest-with-amazon-ec2-instance-store-encryption/">Instance Store Encryption</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="geode-testing">19. Testing</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Spring Boot for Apache Geode (SBDG), with help from <a href="https://github.com/spring-projects/spring-test-data-geode">Spring Test for Apache Geode (STDG)</a>, offers
first-class support for both unit and integration testing with Apache Geode in your Spring Boot applications.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
See the Spring Test for Apache Geode (STDG) <a href="https://github.com/spring-projects/spring-test-data-geode/#stdg-in-a-nutshell">documentation</a> for more details.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="geode-testing-unit">19.1. Unit Testing</h3>
<div class="paragraph">
<p>Unit testing with Apache Geode using mock objects in a Spring Boot Test requires only that you declare the STDG
<code>@EnableGemFireMockObjects</code> annotation in your test configuration:</p>
</div>
<div class="exampleblock">
<div class="title">Example 170. Unit Test with Apache Geode using Spring Boot</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@SpringBootTest
@RunWith(SpringRunner.class)
public class SpringBootApacheGeodeUnitTest extends IntegrationTestsSupport {

	@Autowired
	private UserRepository userRepository;

	@Test
	public void saveAndFindUserIsSuccessful() {

		User jonDoe = User.as("jonDoe");

		assertThat(this.userRepository.save(jonDoe)).isNotNull();

		User jonDoeFoundById = this.userRepository.findById(jonDoe.getName()).orElse(null);

		assertThat(jonDoeFoundById).isEqualTo(jonDoe);
	}

	@SpringBootApplication
	@EnableGemFireMockObjects
	@EnableEntityDefinedRegions(basePackageClasses = User.class)
	static class TestConfiguration { }

}

@Getter
@ToString
@EqualsAndHashCode
@RequiredArgsConstructor(staticName = "as")
@Region("Users")
class User {

	@Id
	@lombok.NonNull
	private String name;

}

interface UserRepository extends CrudRepository&lt;User, String&gt; { }</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>This test class is not a &#8220;pure&#8221; unit test, particularly since it bootstraps an actual Spring <code>ApplicationContext</code>
using Spring Boot. However, it does mock all Apache Geode objects, such as the <code>Users</code> <code>Region</code> declared by the <code>User</code>
application entity class, which was annotated with SDG&#8217;s <code>@Region</code> mapping annotation.</p>
</div>
<div class="paragraph">
<p>This test class conveniently uses Spring Boot&#8217;s auto-configuration to auto-configure an Apache Geode <code>ClientCache</code>
instance. In addition, SDG&#8217;s <code>@EnableEntityDefinedRegions</code> annotation was used to conveniently create the Apache Geode
"Users` <code>Region</code> to store instances of <code>User</code>.</p>
</div>
<div class="paragraph">
<p>Finally, Spring Data&#8217;s Repository abstraction was used to conveniently perform basic CRUD (such as <code>save</code>)  and simple
(OQL) query (such as <code>findById</code>) data access operations on the <code>Users</code> <code>Region</code>.</p>
</div>
<div class="paragraph">
<p>Even though the Apache Geode objects (such as the <code>Users</code> <code>Region</code>) are &#8220;mock objects&#8221;, you can still perform many of
the data access operations required by your Spring Boot application&#8217;s components in an Apache Geode API-agnostic way&#8201;&#8212;&#8201;that is, by using Spring&#8217;s powerful programming model and constructs.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
By extending STDG&#8217;s <code>org.springframework.data.gemfire.tests.integration.IntegrationTestSupport</code> class, you ensure
that all Apache Geode mock objects and resources are properly released after the test class runs, thereby preventing
any interference with downstream tests.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>While STDG tries to <a href="https://github.com/spring-projects/spring-test-data-geode/#mock-regions-with-data">mock the functionality and behavior</a> for many <code>Region</code>
operations, it is not pragmatic to mock them all. For example, it would not be practical to mock <code>Region</code> query
operations involving complex OQL statements that have sophisticated predicates.</p>
</div>
<div class="paragraph">
<p>If such functional testing is required, the test might be better suited as an integration test. Alternatively, you can
follow the advice in this section about <a href="https://github.com/spring-projects/spring-test-data-geode/#mocking-unsupported-region-operations">unsupported Region operations</a>.</p>
</div>
<div class="paragraph">
<p>In general, STDG provides the following capabilities when mocking Apache Geode objects:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/spring-projects/spring-test-data-geode#mock-object-scope&#8212;&#8203;lifecycle-management">Mock Object Scope &amp; Lifecycle Management</a></p>
</li>
<li>
<p><a href="https://github.com/spring-projects/spring-test-data-geode#mock-regions-with-data">Support for Mock Regions with Data</a></p>
</li>
<li>
<p><a href="https://github.com/spring-projects/spring-test-data-geode#mock-region-callbacks">Support for Mocking Region Callbacks</a></p>
</li>
<li>
<p><a href="https://github.com/spring-projects/spring-test-data-geode#mocking-unsupported-region-operations">Support for Mocking Unsupported Region Operations</a></p>
</li>
</ul>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
See the documentation on <a href="https://github.com/spring-projects/spring-test-data-geode/#unit-testing-with-stdg">Unit Testing with STDG</a> for more details.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="geode-testing-integration">19.2. Integration Testing</h3>
<div class="paragraph">
<p>Integration testing with Apache Geode in a Spring Boot Test is as simple as <strong>not</strong> declaring STDG&#8217;s
<code>@EnableGemFireMockObjects</code> annotation in your test configuration. You may then want to use SBDG&#8217;s <code>@EnableClusterAware</code>
annotation to conditionally detect the presence of a Apache Geode cluster:</p>
</div>
<div class="exampleblock">
<div class="title">Example 171. Using <code>@EnableClusterAware</code> in test configuration</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@SpringBootApplication
@EnableClusterAware
@EnableEntityDefinedRegions(basePackageClasses = User.class)
static class TestConfiguration { }</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The SBDG <code>@EnableClusterAware</code> annotation conveniently toggles your auto-configured <code>ClientCache</code> instance between
local-only mode and client/server. It even pushes configuration metadata (such as <code>Region</code> definitions) up to
the servers in the cluster that are required by the application to store data.</p>
</div>
<div class="paragraph">
<p>In most cases, in addition to testing with &#8220;live&#8221; Apache Geode objects (such as Regions), we also want to test in
a client/server capacity. This unlocks the full capabilities of the Apache Geode data management system in a Spring
context and gets you as close as possible to production from the comfort of your IDE.</p>
</div>
<div class="paragraph">
<p>Building on our example from the section on <a href="#geode-testing-unit">Unit Testing</a>, you can modify the test to use &#8220;live&#8221; Apache Geode
objects in a client/server topology as follows:</p>
</div>
<div class="exampleblock">
<div class="title">Example 172. Integration Test with Apache Geode using Spring Boot</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@ActiveProfiles("client")
@RunWith(SpringRunner.class)
@SpringBootTest(properties = "spring.data.gemfire.management.use-http=false")
public class SpringBootApacheGeodeIntegrationTest extends ForkingClientServerIntegrationTestsSupport {

	@BeforeClass
	public static void startGeodeServer() throws IOException {
		startGemFireServer(TestGeodeServerConfiguration.class);
	}

	@Autowired
	private UserRepository userRepository;

	@Test
	public void saveAndFindUserIsSuccessful() {

		User jonDoe = User.as("jonDoe");

		assertThat(this.userRepository.save(jonDoe)).isNotNull();

		User jonDoeFoundById = this.userRepository.findById(jonDoe.getName()).orElse(null);

		assertThat(jonDoeFoundById).isEqualTo(jonDoe);
		assertThat(jonDoeFoundById).isNotSameAs(jonDoe);
	}

	@SpringBootApplication
	@EnableClusterAware
	@EnableEntityDefinedRegions(basePackageClasses = User.class)
	@Profile("client")
	static class TestGeodeClientConfiguration { }

	@CacheServerApplication
	@Profile("server")
	static class TestGeodeServerConfiguration {

		public static void main(String[] args) {

			new SpringApplicationBuilder(TestGeodeServerConfiguration.class)
				.web(WebApplicationType.NONE)
				.profiles("server")
				.build()
				.run(args);
		}
	}
}

@Getter
@ToString
@EqualsAndHashCode
@RequiredArgsConstructor(staticName = "as")
@Region("Users")
class User {

	@Id
	@lombok.NonNull
	private String name;

}

interface UserRepository extends CrudRepository&lt;User, String&gt; { }</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The application client/server-based integration test class extend STDG&#8217;s
<code>org.springframework.data.gemfire.tests.integration.ForkingClientServerIntegrationTestsSupport</code> class.
This ensures that all Apache Geode objects and resources are properly cleaned up after the test class runs. In addition,
it coordinates the client and server components of the test (for example connecting the client to the server using a
random port).</p>
</div>
<div class="paragraph">
<p>The Apache Geode server is started in a <code>@BeforeClass</code> setup method:</p>
</div>
<div class="listingblock">
<div class="title">Start the Apache Geode server</div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">class SpringBootApacheGeodeIntegrationTest extends ForkingClientServerIntegrationTestsSupport {

  @BeforeClass
  public static void startGeodeServer() throws IOException {
    startGemFireServer(TestGeodeServerConfiguration.class);
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>STDG lets you configure the Apache Geode server with Spring configuration, specified in
the <code>TestGeodeServerConfiguration</code> class. The Java class needs to provide a <code>main</code> method. It uses
the <code>SpringApplicationBuilder</code> to bootstrap the Apache Geode <code>CacheServer</code> application:</p>
</div>
<div class="exampleblock">
<div class="title">Example 173. Apache Geode server configuration</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@CacheServerApplication
@Profile("server")
static class TestGeodeServerConfiguration {

  public static void main(String[] args) {

    new SpringApplicationBuilder(TestGeodeServerConfiguration.class)
      .web(WebApplicationType.NONE)
      .profiles("server")
      .build()
      .run(args);
  }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>In this case, we provide minimal configuration, since the configuration is determined and pushed up to the server
by the client. For example, we do not need to explicitly create the <code>Users</code> <code>Region</code> on the server since it is
implicitly handled for you by the SBDG/STDG frameworks from the client.</p>
</div>
<div class="paragraph">
<p>We take advantage of Spring profiles in the test setup to distinguish between the client and server configuration.
Keep in mind that the test is the &#8220;client&#8221; in this arrangement.</p>
</div>
<div class="paragraph">
<p>The STDG framework does what the supporting class demands: &#8220;forking&#8221; the Spring Boot-based, Apache Geode <code>CacheServer</code>
application in a separate JVM process. Subsequently, the STDG framework stops the server upon completion of the tests
in the test class.</p>
</div>
<div class="paragraph">
<p>You are free to start your servers or cluster however you choose. STDG provides this capability as a convenience for you,
since it is a common concern.</p>
</div>
<div class="paragraph">
<p>This test class is simple. STDG can handle much more complex test scenarios.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Review SBDG&#8217;s test suite to witness the full power and functionality of the STDG framework for yourself.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
See the documentation on <a href="https://github.com/spring-projects/spring-test-data-geode/#integration-testing-with-stdg">Integration Testing with STDG</a>
for more details.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="geode-api-extensions">20. Apache Geode API Extensions</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When using the Spring programming model and abstractions, it should not be necessary to use Apache Geode
<a href="https://geode.apache.org/releases/latest/javadoc">APIs</a> at all&#8201;&#8212;&#8201;for example, when using the Spring Cache Abstraction for caching
or the Spring Data Repository abstraction for DAO development. There are many more examples.</p>
</div>
<div class="paragraph">
<p>For certain use cases, users may require low level access to fine-grained functionally. Spring Boot for Apache Geode&#8217;s
<code>org.springframework.geode:apache-geode-extensions</code> module and library builds on Apache Geode&#8217;s APIs by including
several extensions with enhanced functionality to offer an experience familiar to Spring users inside a Spring context.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Spring Data for Apache Geode (SDG) also <a href="https://docs.spring.io/spring-data/geode/docs/current/reference/html/#apis">includes</a> additional extensions to
Apache Geode&#8217;s APIs.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="geode-api-extensions-cacheresolver">20.1. <code>SimpleCacheResolver</code></h3>
<div class="paragraph">
<p>In some cases, it is necessary to acquire a reference to the cache instance in your application components at runtime.
For example, you might want to create a temporary <code>Region</code> on the fly to aggregate data for analysis.</p>
</div>
<div class="paragraph">
<p>Typically, you already know the type of cache your application is using, since you must declare your application to be
either a client (<code>ClientCache</code>) in the <a href="https://geode.apache.org/docs/guide/{apache-geode-doc-version}/topologies_and_comm/cs_configuration/chapter_overview.html">client/server topology</a>,
or a <a href="https://geode.apache.org/docs/guide/{apache-geode-doc-version}/topologies_and_comm/p2p_configuration/chapter_overview.html">peer member or node</a> (<code>Cache</code>) in
the cluster on startup. This is expressed in configuration when creating the cache instance required to interact with
the Apache Geode data management system. In most cases, your application will be a client. SBDG makes this decision easy,
since it auto-configures a <code>ClientCache</code> instance, <a href="#geode-clientcache-applications">by default</a>.</p>
</div>
<div class="paragraph">
<p>In a Spring context, the cache instance created by the framework is a managed bean in the Spring container.
You can inject a reference to the <a href="https://en.wikipedia.org/wiki/Singleton_pattern"><em>Singleton</em></a> cache bean
into any other managed application component:</p>
</div>
<div class="exampleblock">
<div class="title">Example 174. Autowired Cache Reference using Dependency Injection (DI)</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Service
class CacheMonitoringService {

	@Autowired
    ClientCache clientCache;

    // use the clientCache object reference to monitor the cache as necessary

}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>However, in cases where your application component or class is not managed by Spring and you need a reference to the
cache instance at runtime, SBDG provides the abstract <code>org.springframework.geode.cache.SimpleCacheResolver</code> class
(see its <a href="https://docs.spring.io/spring-boot-data-geode-build/current/api//org/springframework/geode/cache/SimpleCacheResolver.html">Javadoc</a>).</p>
</div>
<div class="exampleblock">
<div class="title">Example 175. <code>SimpleCacheResolver</code> API</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">package org.springframework.geode.cache;

abstract class SimpleCacheResolver {

	&lt;T extends GemFireCache&gt; T require() { }

	&lt;T extends GemFireCache&gt; Optional&lt;T&gt; resolve() { }

	Optional&lt;ClientCache&gt; resolveClientCache() { }

	Optional&lt;Cache&gt; resolvePeerCache() { }

}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p><code>SimpleCacheResolver</code> adheres to <a href="https://en.wikipedia.org/wiki/SOLID">SOLID OO Principles</a>. This class is abstract
and extensible so that you can change the algorithm used to resolve client or peer cache instances as well as mock
its methods in unit tests.</p>
</div>
<div class="paragraph">
<p>Additionally, each method is precise. For example, <code>resolveClientCache()</code> resolves a reference to a cache only if
the cache instance is a &#8220;client.&#8221; If a cache exists but is a &#8220;peer&#8221; cache instance, <code>resolveClientCache()</code>
returns <code>Optional.EMPTY</code>. The behavior of <code>resolvePeerCache()</code> is similar.</p>
</div>
<div class="paragraph">
<p><code>require()</code> returns a non-<code>Optional</code> reference to a cache instance and throws an <code>IllegalStateException</code> if a cache
is not present.</p>
</div>
</div>
<div class="sect2">
<h3 id="geode-api-extensions-cacheutils">20.2. <code>CacheUtils</code></h3>
<div class="paragraph">
<p>Under the hood, <code>SimpleCacheResolver</code> delegates some of its functions to the
<a href="https://docs.spring.io/spring-boot-data-geode-build/current/api//org/springframework/geode/util/CacheUtils.html"><code>CacheUtils</code></a>
abstract utility class, which provides additional, convenient capabilities when you use a cache.</p>
</div>
<div class="paragraph">
<p>While there are utility methods to determine whether a cache instance (that is, a <code>GemFireCache</code>) or Region is a client
or a peer, one of the more useful functions is to extract all the values from a Region.</p>
</div>
<div class="paragraph">
<p>To extract all the values stored in a Region, call <code>CacheUtils.collectValues(:Region&lt;?, T&gt;)</code>. This method returns a
<code>Collection&lt;T&gt;</code> that contains all the values stored in the given <code>Region</code>. The method is smart and knows how to handle
the <code>Region</code> appropriately regardless of whether the <code>Region</code> is a client or a peer. This distinction is important,
since client <code>PROXY</code> Regions store no values.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Caution is advised when you get all values from a Region. While getting filtered reference values from a
non-transactional, reference data only [<code>REPLICATE</code>] Region is quite useful, getting all values from a transactional,
[<code>PARTITION</code>] Region can prove quite detrimental, especially in production. Getting all values from a Region can be
useful during testing.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="geode-api-extensions-membership">20.3. <code>MembershipListenerAdapter</code> and <code>MembershipEvent</code></h3>
<div class="paragraph">
<p>Another useful API hidden by Apache Geode is the membership events and listener interface. This API is especially useful
on the server side when your Spring Boot application serves as a peer member of an Apache Geode distributed system.</p>
</div>
<div class="paragraph">
<p>When a peer member is disconnected from the distributed system, perhaps due to a network failure, the member is forcibly
removed from the cluster. This node immediately enters a reconnecting state, trying to establish a connection back to
the cluster. Once reconnected, the peer member must rebuild all cache objects (<code>Cache</code>, <code>Region</code> instances, <code>Index</code>
instances, <code>DiskStore</code> instances, and so on). All previous cache objects are now invalid, and their references are stale.</p>
</div>
<div class="paragraph">
<p>In a Spring context, this is particularly problematic since most Apache Geode objects are <em>Singleton</em> beans declared in
and managed by the Spring container. Those beans may be injected and used in other framework and application components.
For instance, <code>Region</code> instances are injected into SDG&#8217;s <code>GemfireTemplate</code>, Spring Data Repositories and possibly
application-specific data access objects (<a href="https://en.wikipedia.org/wiki/Data_access_object">DAOs</a>).</p>
</div>
<div class="paragraph">
<p>If references to those cache objects become stale on a forced disconnect event, there is no way to auto-wire fresh
object references into the dependent application or framework components when the peer member is reconnected, unless the
Spring <code>ApplicationContext</code> is &#8220;refreshed&#8221;. In fact, there is no way to even know that this event has occurred, since
the Apache Geode <code>MembershipListener</code> API and corresponding events are &#8220;internal&#8221;.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The Spring team explored the idea of creating proxies for all types of cache objects (<code>Cache</code>, <code>Region</code>, <code>Index</code>,
<code>DiskStore</code>, <code>AsyncEventQueue</code>, <code>GatewayReceiver</code>, <code>GatewaySender</code>, and others) used by Spring. The proxies would know
how to obtain a fresh reference on a reconnect event. However, this turns out to be more problematic than it is worth.
It is easier to &#8220;refresh&#8221; the Spring <code>ApplicationContext</code>, although doing so is no less expensive. Neither way is
ideal. See <a href="https://jira.spring.io/browse/SGF-921">SGF-921</a> and <a href="https://jira.spring.io/browse/SGF-227">SGF-227</a>
for further details.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In the case where membership events are useful to the Spring Boot application, SBDG provides the following
<a href="https://docs.spring.io/spring-boot-data-geode-build/current/api//org/springframework/geode/distributed/event/package-frame.html">API</a>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://docs.spring.io/spring-boot-data-geode-build/current/api//org/springframework/geode/distributed/event/MembershipListenerAdapter.html"><code>MembershipListenerAdapter</code></a></p>
</li>
<li>
<p><a href="https://docs.spring.io/spring-boot-data-geode-build/current/api//org/springframework/geode/distributed/event/MembershipEvent.html"><code>MembershipEvent</code></a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The abstract <code>MembershipListenerAdapter</code> class implements Apache Geode&#8217;s <code>org.apache.geode.distributed.internal.MembershipListener</code>
interface to simplify the event handler method signatures by using an appropriate <code>MembershipEvent</code> type to encapsulate
the actors in the event.</p>
</div>
<div class="paragraph">
<p>The abstract <code>MembershipEvent</code> class is further subclassed to represent specific membership event types that occur
within the Apache Geode system:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://docs.spring.io/spring-boot-data-geode-build/current/api//org/springframework/geode/distributed/event/support/MemberDepartedEvent.html"><code>MemberDepartedEvent</code></a></p>
</li>
<li>
<p><a href="https://docs.spring.io/spring-boot-data-geode-build/current/api//org/springframework/geode/distributed/event/support/MemberJoinedEvent.html"><code>MemberJoinedEvent</code></a></p>
</li>
<li>
<p><a href="https://docs.spring.io/spring-boot-data-geode-build/current/api//org/springframework/geode/distributed/event/support/MemberSuspectEvent.html"><code>MemberSuspectEvent</code></a></p>
</li>
<li>
<p><a href="https://docs.spring.io/spring-boot-data-geode-build/current/api//org/springframework/geode/distributed/event/support/QuorumLostEvent.html"><code>QuorumLostEvent</code></a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The API is depicted in the following UML diagram:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/membership-api-uml.png" alt="membership api uml">
</div>
</div>
<div class="paragraph">
<p>The membership event type is further categorized with an appropriate enumerated value,
<a href="https://docs.spring.io/spring-boot-data-geode-build/current/api//org/springframework/geode/distributed/event/MembershipEvent.Type.html"><code>MembershipEvent.Type</code></a>,
as a property of the <code>MembershipEvent</code> itself (see <a href="https://docs.spring.io/spring-boot-data-geode-build/current/api//org/springframework/geode/distributed/event/MembershipEvent.html#getType--"><code>getType()</code></a>).</p>
</div>
<div class="paragraph">
<p>The type hierarchy is useful in <code>instanceof</code> expressions, while the <code>Enum</code> is useful in <code>switch</code> statements.</p>
</div>
<div class="paragraph">
<p>You can see one particular implementation of the <code>MembershipListenerAdapter</code> with the
<a href="https://docs.spring.io/spring-boot-data-geode-build/current/api//org/springframework/geode/distributed/event/ApplicationContextMembershipListener.html"><code>ApplicationContextMembershipListener</code></a> class,
which does exactly as we described earlier, handling forced-disconnect/auto-reconnect membership events inside a
Spring container in order to refresh the Spring <code>ApplicationContext</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="geode-api-extensions-pdx">20.4. PDX</h3>
<div class="paragraph">
<p>Apache Geode&#8217;s PDX serialization framework is yet another API that falls short of a complete stack.</p>
</div>
<div class="paragraph">
<p>For instance, there is no easy or direct way to serialize an object as PDX bytes. It is also not possible to modify an
existing <code>PdxInstance</code> by adding or removing fields, since doing so would require a new PDX type. In this case, you must
create a new <code>PdxInstance</code> and copy from an existing <code>PdxInstance</code>. Unfortunately, the Apache Geode API offers no help
in this regard. It is also not possible to use PDX in a client, local-only mode without a server, since the PDX type
registry is only available and managed on servers in a cluster.</p>
</div>
<div class="sect3">
<h4 id="geode-api-extensions-pdx-builder">20.4.1. <code>PdxInstanceBuilder</code></h4>
<div class="paragraph">
<p>In such cases, SBDG conveniently provides the
<a href="https://docs.spring.io/spring-boot-data-geode-build/current/api//org/springframework/geode/pdx/PdxInstanceBuilder.html"><code>PdxInstanceBuilder</code></a> class,
appropriately named after the <a href="https://en.wikipedia.org/wiki/Builder_pattern">Builder software design pattern</a>.
The <code>PdxInstanceBuilder</code> also offers a fluent API for constructing <code>PdxInstances</code>:</p>
</div>
<div class="exampleblock">
<div class="title">Example 176. <code>PdxInstanceBuilder</code> API</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">class PdxInstanceBuilder {

	PdxInstanceFactory copy(PdxInstance pdx);

	Factory from(Object target);

}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>For example, you could serialize an application domain object as PDX bytes with the following code:</p>
</div>
<div class="exampleblock">
<div class="title">Example 177. Serializing an Object to PDX</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Component
class CustomerSerializer {

	PdxInstance serialize(Customer customer) {

		return PdxInstanceBuilder.create()
            .from(customer)
            .create();
	}
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>You could then modify the <code>PdxInstance</code> by copying from the original:</p>
</div>
<div class="exampleblock">
<div class="title">Example 178. Copy <code>PdxInstance</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Component
class CustomerDecorator {

	@Autowired
    CustomerSerializer serializer;

	PdxIntance decorate(Customer customer) {

		PdxInstance pdxCustomer = serializer.serialize(customer);

		return PdxInstanceBuilder.create()
            .copy(pdxCustomer)
            .writeBoolean("vip", isImportant(customer))
            .create();
	}
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="geode-api-extensions-pdx-wrapper">20.4.2. <code>PdxInstanceWrapper</code></h4>
<div class="paragraph">
<p>SBDG also provides the <a href="https://docs.spring.io/spring-boot-data-geode-build/current/api//org/springframework/geode/pdx/PdxInstanceWrapper.html"><code>PdxInstanceWrapper</code></a>
class to wrap an existing <code>PdxInstance</code> in order to provide more control during the conversion from PDX to JSON and from
JSON back into a POJO. Specifically, the wrapper gives you more control over the configuration of Jackson&#8217;s
<code>ObjectMapper</code>.</p>
</div>
<div class="paragraph">
<p>The <code>ObjectMapper</code> constructed by Apache Geode&#8217;s own <code>PdxInstance</code> implementation (<code>PdxInstanceImpl</code>) is not
configurable, nor was it configured correctly. Unfortunately, since <code>PdxInstance</code> is not extensible, the <code>getObject()</code>
method fails when converting the JSON generated from PDX back into a POJO for any practical application domain model
type.</p>
</div>
<div class="paragraph">
<p>The following example wraps an existing <code>PdxInstance</code>:</p>
</div>
<div class="exampleblock">
<div class="title">Example 179. Wrapping an existing <code>PdxInstance</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">PdxInstanceWrapper wrapper = PdxInstanceWrapper.from(pdxInstance);</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>For all operations on <code>PdxInstance</code> except <code>getObject()</code>, the wrapper delegates to the underlying <code>PdxInstance</code> method
implementation called by the user.</p>
</div>
<div class="paragraph">
<p>In addition to the decorated <code>getObject()</code> method, the <code>PdxInstanceWrapper</code> provides a thorough implementation of the
<code>toString()</code> method. The state of the <code>PdxInstance</code> is output in a JSON-like <code>String</code>.</p>
</div>
<div class="paragraph">
<p>Finally, the <code>PdxInstanceWrapper</code> class adds a <code>getIdentifier()</code> method. Rather than put the burden on the user to have
to iterate the field names of the <code>PdxInstance</code> to determine whether a field is the identity field and then call
<code>getField(name)</code> with the field name to get the ID (value)&#8201;&#8212;&#8201;assuming an identity field was marked in the first place&#8201;&#8212;&#8201;the <code>PdxInstanceWrapper</code> class provides the <code>getIdentifier()</code> method to return the ID of the <code>PdxInstance</code> directly.</p>
</div>
<div class="paragraph">
<p>The <code>getIdentifier()</code> method is smart in that it first iterates the fields of the <code>PdxInstance</code>, asking each field if it
is the identity field. If no field was marked as the identity field, the algorithm searches for a field named <code>id</code>. If
no field with the name <code>id</code> exists, the algorithm searches for a metadata field called <code>@identifier</code>, which refers to
the field that is the identity field of the <code>PdxInstance</code>.</p>
</div>
<div class="paragraph">
<p>The <code>@identifier</code> metadata field is useful in cases where the <code>PdxInstance</code> originated from JSON and the application
domain object uses a natural identifier, rather than a surrogate ID, such as <code>Book.isbn</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Apache Geode&#8217;s <code>JSONFormatter</code> class is not capable of marking the identity field of a <code>PdxInstance</code> originating
from JSON.
</td>
</tr>
</table>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
It is not currently possible to implement the <code>PdxInstance</code> interface and store instances of this type as a
value in a Region. Apache Geode assumes all <code>PdxInstance</code> objects are an implementation created by Apache Geode itself
(that is, <code>PdxInstanceImpl</code>), which has a tight coupling to the PDX type registry. An <code>Exception</code> is thrown if you try
to store instances of your own <code>PdxInstance</code> implementation.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="geode-api-extensions-pdx-adapter">20.4.3. <code>ObjectPdxInstanceAdapter</code></h4>
<div class="paragraph">
<p>In rare cases, you may need to treat an <code>Object</code> as a <code>PdxInstance</code>, depending on the context without incurring
the overhead of serializing an <code>Object</code> to PDX. For such cases, SBDG offers the <code>ObjectPdxInstanceAdapter</code> class.</p>
</div>
<div class="paragraph">
<p>This might be true when calling a method with a parameter expecting an argument of, or returning an instance of,
type <code>PdxInstance</code>, particularly when Apache Geode&#8217;s <code>read-serialized</code> PDX configuration property is set to <code>true</code>
and only an object is available in the current context.</p>
</div>
<div class="paragraph">
<p>Under the hood, SBDG&#8217;s <code>ObjectPdxInstanceAdapter</code> class uses Spring&#8217;s
<a href="https://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/beans/BeanWrapper.html"><code>BeanWrapper</code></a> class along with Java&#8217;s
introspection and reflection functionality to adapt the given <code>Object</code> and access it with the full
<a href="https://geode.apache.org/releases/latest/javadoc/org/apache/geode/pdx/PdxInstance.html"><code>PdxInstance</code></a> API. This includes the use of the
<a href="https://geode.apache.org/releases/latest/javadoc/org/apache/geode/pdx/WritablePdxInstance.html"><code>WritablePdxInstance</code></a> API, obtained from
<a href="https://geode.apache.org/releases/latest/javadoc/org/apache/geode/pdx/PdxInstance.html#createWriter--"><code>PdxInstance.createWriter()</code></a>, to modify
the underlying <code>Object</code> as well.</p>
</div>
<div class="paragraph">
<p>Like the <code>PdxInstanceWrapper</code> class, <code>ObjectPdxInstanceAdapter</code> contains special logic to resolve the identity field
and ID of the <code>PdxInstance</code>, including consideration for Spring Data&#8217;s
<a href="https://docs.spring.io/spring-data/commons/docs/current/api/org/springframework/data/annotation/Id.html"><code>@Id</code></a> mapping annotation,
which can be introspected in this case, given that the underlying <code>Object</code> backing the <code>PdxInstance</code> is a POJO.</p>
</div>
<div class="paragraph">
<p>The <code>ObjectPdxInstanceAdapter.getObject()</code> method returns the wrapped <code>Object</code> used to construct
the <code>ObjectPdxInstanceAdapter</code> and is, therefore, automatically deserializable, as determined by the
<a href="https://geode.apache.org/releases/latest/javadoc/org/apache/geode/pdx/PdxInstance.html#isDeserializable--"><code>PdxInstance.isDeseriable()</code></a> method,
which always returns <code>true</code>.</p>
</div>
<div class="paragraph">
<p>You can adapt any <code>Object</code> as a <code>PdxInstance</code>:</p>
</div>
<div class="exampleblock">
<div class="title">Example 180. Adapt an <code>Object</code> as a <code>PdxInstance</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">class OfflineObjectToPdxInstanceConverter {

	@NonNull PdxInstance convert(@NonNull Object target) {
		return ObjectPdxInstanceAdapter.from(target);
	}
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Once the <a href="https://en.wikipedia.org/wiki/Adapter_pattern">Adapter</a> is created, you can use it to access data
on the underlying <code>Object</code>.</p>
</div>
<div class="paragraph">
<p>Consider the following example of a <code>Customer</code> class:</p>
</div>
<div class="exampleblock">
<div class="title">Example 181. <code>Customer</code> class</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Region("Customers")
class Customer {

	@Id
    private Long id;

	String name;

	// constructors, getters and setters omitted

}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Then you can access an instance of <code>Customer</code> by using the <code>PdxInstance</code> API:</p>
</div>
<div class="exampleblock">
<div class="title">Example 182. Accessing an <code>Object</code> using the <code>PdxInstance</code> API</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">class ObjectPdxInstanceAdapterTest {

	@Test
    public void getAndSetObjectProperties() {

		Customer jonDoe = new Customer(1L, "Jon Doe");

		PdxInstance adapter = ObjectPdxInstanceAdapter.from(jonDoe);

		assertThat(jonDoe.getName()).isEqualTo("Jon Doe");
		assertThat(adapter.getField("name")).isEqualTo("Jon Doe");

		adapter.createWriter().setField("name", "Jane Doe");

		assertThat(adapter.getField("name")).isEqualTo("Jane Doe");
		assertThat(jonDoe.getName()).isEqualTo("Jane Doe");
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="geode-api-extensions-security">20.5. Security</h3>
<div class="paragraph">
<p>For testing purposes, SBDG provides a test implementation of
Apache Geode&#8217;s <a href="https://geode.apache.org/releases/latest/javadoc/org/apache/geode/security/SecurityManager.html"><code>SecurityManager</code></a> interface,
which expects the password to match the username (case-sensitive) when authenticating.</p>
</div>
<div class="paragraph">
<p>By default, all operations are authorized.</p>
</div>
<div class="paragraph">
<p>To match the expectations of SBDG&#8217;s <code>TestSecurityManager</code>, SBDG additionally provides a test implementation of
Apache Geode&#8217;s <a href="https://geode.apache.org/releases/latest/javadoc/org/apache/geode/security/AuthInitialize.html"><code>AuthInitialize</code></a> interface,
which supplies matching credentials for both the username and password.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="actuator">21. Spring Boot Actuator</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Spring Boot for Apache Geode (SBDG) adds <a href="https://docs.spring.io/spring-boot/docs/current/reference/html/production-ready.html">Spring Boot Actuator</a> support
and dedicated <code>HealthIndicators</code> for Apache Geode. Equally, the provided <code>HealthIndicators</code> even work with Tanzu Cache
(which is backed by VMware Tanzu GemFire) when you push your Spring Boot applications using Apache Geode
to {VMware Tanzu Application Service (TAS)} platform.</p>
</div>
<div class="paragraph">
<p>Spring Boot <code>HealthIndicators</code> provide details about the runtime operation and behavior of your Apache Geode-based
Spring Boot applications. For instance, by querying the right <code>HealthIndicator</code> endpoint, you can get the current
hit/miss count for your <code>Region.get(key)</code> data access operations.</p>
</div>
<div class="paragraph">
<p>In addition to vital health information, SBDG provides basic, pre-runtime configuration metadata about the
Apache Geode components that are monitored by Spring Boot Actuator. This makes it easier to see how
the application was configured all in one place, rather than in properties files, Spring configuration, XML,
and so on.</p>
</div>
<div class="paragraph">
<p>The provided Spring Boot <code>HealthIndicators</code> fall into three categories:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Base <code>HealthIndicators</code> that apply to all Apache Geode, Spring Boot applications, regardless of cache type,
such as <code>Regions</code>, <code>Indexes</code>, and <code>DiskStores</code>.</p>
</li>
<li>
<p>Peer <code>Cache</code>-based <code>HealthIndicators</code> that apply only to peer <code>Cache</code> applications, such as <code>AsyncEventQueues</code>,
<code>CacheServers</code>, <code>GatewayReceivers</code>, and <code>GatewaySenders</code>.</p>
</li>
<li>
<p><code>ClientCache</code>-based <code>HealthIndicators</code> that apply only to <code>ClientCache</code> applications, such as <code>ContinuousQuery</code>
and connection <code>Pools</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following sections give a brief overview of all the available Spring Boot <code>HealthIndicators</code> provided for
Apache Geode.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
See the corresponding sample <a href="guides/boot-actuator.html">guide</a> and {github-samples-url}/boot/actuator[code]
to see Spring Boot Actuator for Apache Geode in action.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="actuator-base-healthindicators">21.1. Base HealthIndicators</h3>
<div class="paragraph">
<p>This section covers Spring Boot <code>HealthIndicators</code> that apply to both Apache Geode peer <code>Cache</code> and <code>ClientCache</code>,
Spring Boot applications. That is, these <code>HealthIndicators</code> are not specific to the cache type.</p>
</div>
<div class="paragraph">
<p>In Apache Geode, the cache instance is either a peer <code>Cache</code> instance (which makes your Spring Boot application
part of a Apache Geode cluster) or, more commonly, a <code>ClientCache</code> instance (which talks to an existing cluster).
Your Spring Boot application can only be one cache type or the other and can only have a single instance of
that cache type.</p>
</div>
<div class="sect3">
<h4 id="actuator-base-healthindicators-cache">21.1.1. GeodeCacheHealthIndicator</h4>
<div class="paragraph">
<p><code>GeodeCacheHealthIndicator</code> provides essential details about the (single) cache instance (client or peer)
and the underlying <code>DistributedSystem</code>, the <code>DistributedMember</code> and configuration details of the <code>ResourceManager</code>.</p>
</div>
<div class="paragraph">
<p>When your Spring Boot application creates an instance of a peer <a href="https://geode.apache.org/releases/latest/javadoc/org/apache/geode/cache/Cache.html"><code>Cache</code></a>,
the <a href="https://geode.apache.org/releases/latest/javadoc/org/apache/geode/distributed/DistributedMember.html"><code>DistributedMember</code></a> object represents
your application as a peer member or node of the <a href="https://geode.apache.org/releases/latest/javadoc/org/apache/geode/distributed/DistributedSystem.html"><code>DistributedSystem</code></a>.
The distributed system (that is, the cluster) is formed from a collection of connected peers, to which your application
also has <a href="https://geode.apache.org/releases/latest/javadoc/org/apache/geode/cache/GemFireCache.html#getDistributedSystem--">access</a>&#8201;&#8212;&#8201;indirectly,
through the cache instance.</p>
</div>
<div class="paragraph">
<p>This is no different for a <code>ClientCache</code> even though the client is technically not part of the peer/server cluster.
However, it still creates instances of the <code>DistributedSystem</code> and <code>DistributedMember</code> objects, respectively.</p>
</div>
<div class="paragraph">
<p>Each object has the following configuration metadata and health details:</p>
</div>
<table class="tableblock frame-all grid-all" style="width: 90%;">
<caption class="title">Table 2. Cache Details</caption>
<colgroup>
<col style="width: 23.0769%;">
<col style="width: 76.9231%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.cache.name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the member in the distributed system.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.cache.closed</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Determines whether the cache has been closed.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.cache.cancel-in-progress</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates whether cancellation of operations is in progress.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all" style="width: 90%;">
<caption class="title">Table 3. DistributedMember Details</caption>
<colgroup>
<col style="width: 23.0769%;">
<col style="width: 76.9231%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.distributed-member.id</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DistributedMember</code> identifier (used in logs internally).</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.distributed-member.name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the member in the distributed system.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.distributed-members.groups</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Configured groups to which the member belongs.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.distributed-members.host</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the machine on which the member is running.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.distributed-members.process-id</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Identifier of the JVM process (PID).</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all" style="width: 90%;">
<caption class="title">Table 4. DistributedSystem Details</caption>
<colgroup>
<col style="width: 23.0769%;">
<col style="width: 76.9231%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.distributed-system.connected</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates whether the member is currently connected to
the cluster.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.distributed-system.member-count</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Total number of members in the cluster (1 for clients).</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.distributed-system.reconnecting</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates whether the member is in a reconnecting state,
which happens when a network partition occurs and the member gets disconnected from the cluster.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.distributed-system.properties-location</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Location of the
<a href="https://geode.apache.org/docs/guide/{apache-geode-doc-version}/topics/gemfire_properties.html">standard configuration properties</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.distributed-system.security-properties-location</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Location of the
<a href="https://geode.apache.org/docs/guide/{apache-geode-doc-version}/topics/gemfire_properties.html">security configuration properties</a>.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all" style="width: 90%;">
<caption class="title">Table 5. ResourceManager Details</caption>
<colgroup>
<col style="width: 23.0769%;">
<col style="width: 76.9231%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.resource-manager.critical-heap-percentage</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Percentage of heap at which the cache is in danger of
becoming inoperable.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.resource-manager.critical-off-heap-percentage</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Percentage of off-heap at which the cache is in danger of
becoming inoperable.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.resource-manager.eviction-heap-percentage</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Percentage of heap at which eviction begins on Regions
configured with a heap LRU eviction policy.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.resource-manager.eviction-off-heap-percentage</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Percentage of off-heap at which eviction begins on Regions
configured with a heap LRU eviction policy.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="actuator-base-healthindicators-regions">21.1.2. GeodeRegionsHealthIndicator</h4>
<div class="paragraph">
<p><code>GeodeRegionsHealthIndicator</code> provides details about all the configured and known <code>Regions</code> in the cache.
If the cache is a client, details include all <code>LOCAL</code>, <code>PROXY</code>, and <code>CACHING_PROXY</code> <code>Regions</code>. If the cache is a peer
then details include all <code>LOCAL</code>, <code>PARTITION</code>, and <code>REPLICATE</code> <code>Region</code> instances.</p>
</div>
<div class="paragraph">
<p>The following table describes the essential details and basic performance metrics:</p>
</div>
<table class="tableblock frame-all grid-all" style="width: 90%;">
<caption class="title">Table 6. Region Details</caption>
<colgroup>
<col style="width: 23.0769%;">
<col style="width: 76.9231%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.cache.regions.&lt;name&gt;.cloning-enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether Region values are cloned on read (for example, <code>cloning-enabled</code>
is <code>true</code> when cache transactions are used to prevent in-place modifications).</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.cache.regions.&lt;name&gt;.data-policy</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Policy used to manage data in the Region (<code>PARTITION</code>, <code>REPLICATE</code>,
and others).</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.cache.regions.&lt;name&gt;.initial-capacity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Initial number of entries that can be held by a Region before it needs
to be resized.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.cache.regions.&lt;name&gt;.load-factor</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Load factor used to determine when to resize the Region when it nears
capacity.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.cache.regions.&lt;name&gt;.key-constraint</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Type constraint for Region keys.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.cache.regions.&lt;name&gt;.off-heap</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Determines whether this Region stores values in off-heap memory
(NOTE: Keys are always kept on the JVM heap).</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.cache.regions.&lt;name&gt;.pool-name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If this Region is a client Region, this property determines
the configured connection <code>Pool</code>. (NOTE: Regions can have and use dedicated <code>Pools</code> for their data access operations.)</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.cache.regions.&lt;name&gt;.pool-name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Determines the <code>Scope</code> of the Region, which plays a factor in
the Region&#8217;s consistency-level, as it pertains to acknowledgements for writes.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.cache.regions.&lt;name&gt;.value-constraint</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Type constraint for Region values.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The following details also apply when the Region is a peer <code>Cache</code> <code>PARTITION</code> Region:</p>
</div>
<table class="tableblock frame-all grid-all" style="width: 90%;">
<caption class="title">Table 7. Partition Region Details</caption>
<colgroup>
<col style="width: 23.0769%;">
<col style="width: 76.9231%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.cache.regions.&lt;name&gt;.partition.collocated-with</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates whether this Region is collocated with
another <code>PARTITION</code> Region, which is necessary when performing equi-joins queries (NOTE: distributed joins
are not supported).</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.cache.regions.&lt;name&gt;.partition.local-max-memory</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Total amount of heap memory allowed to be used by
this Region on this node.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.cache.regions.&lt;name&gt;.partition.redundant-copies</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number of replicas for this <code>PARTITION</code> Region,
which is useful in high availability (HA) use cases.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.cache.regions.&lt;name&gt;.partition.total-max-memory</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Total amount of heap memory allowed to be used by
this Region across all nodes in the cluster hosting this Region.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.cache.regions.&lt;name&gt;.partition.total-number-of-buckets</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Total number of buckets (shards) into which this Region
is divided (defaults to 113).</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Finally, when statistics are enabled (for example, when you use <code>@EnableStatistics</code>&#8201;&#8212;&#8201;(see <a href="https://docs.spring.io/spring-data/geode/docs/current/reference/html/#bootstrap-annotation-config-statistics">doc</a> for more details),
the following metadata is available:</p>
</div>
<table class="tableblock frame-all grid-all" style="width: 90%;">
<caption class="title">Table 8. Region Statistic Details</caption>
<colgroup>
<col style="width: 23.0769%;">
<col style="width: 76.9231%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.cache.regions.&lt;name&gt;.statistics.hit-count</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number of hits for a region entry.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.cache.regions.&lt;name&gt;.statistics.hit-ratio</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ratio of hits to the number of <code>Region.get(key)</code> calls.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.cache.regions.&lt;name&gt;.statistics.last-accessed-time</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">For an entry, indicates the last time it was accessed
with <code>Region.get(key)</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.cache.regions.&lt;name&gt;.statistics.last-modified-time</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">For an entry, indicates the time when a Region&#8217;s entry
value was last modified.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.cache.regions.&lt;name&gt;.statistics.miss-count</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the number of times that a <code>Region.get</code>
was performed and no value was found locally.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="actuator-base-healthindicators-indexes">21.1.3. GeodeIndexesHealthIndicator</h4>
<div class="paragraph">
<p><code>GeodeIndexesHealthIndicator</code> provides details about the configured Region <code>Indexes</code> used by OQL query data access
operations.</p>
</div>
<div class="paragraph">
<p>The following details are covered:</p>
</div>
<table class="tableblock frame-all grid-all" style="width: 90%;">
<caption class="title">Table 9. Index Details</caption>
<colgroup>
<col style="width: 23.0769%;">
<col style="width: 76.9231%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.index.&lt;name&gt;.from-clause</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Region from which data is selected.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.index.&lt;name&gt;.indexed-expression</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Region value fields and properties used in the Index expression.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.index.&lt;name&gt;.projection-attributes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">For <code>Map</code> <code>Indexes</code>, returns either <code><strong></code> or the specific Map keys
that were indexed. For all other <code>Indexes</code>, returns <code></strong></code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.index.&lt;name&gt;.region</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Region to which the Index is applied.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Additionally, when statistics are enabled (for example, when you use <code>@EnableStatistics</code>&#8201;&#8212;&#8201;see <a href="https://docs.spring.io/spring-data/geode/docs/current/reference/html/#bootstrap-annotation-config-statistics">Configuring Statistics</a> for more details),
the following metadata is available:</p>
</div>
<table class="tableblock frame-all grid-all" style="width: 90%;">
<caption class="title">Table 10. Index Statistic Details</caption>
<colgroup>
<col style="width: 23.0769%;">
<col style="width: 76.9231%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.index.&lt;name&gt;.statistics.number-of-bucket-indexes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number of bucket Indexes created in a PARTITION Region.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.index.&lt;name&gt;.statistics.number-of-keys</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number of keys in this Index.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.index.&lt;name&gt;.statistics.number-of-map-indexed-keys</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number of keys in this Index at the highest level.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.index.&lt;name&gt;.statistics.number-of-values</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number of values in this Index.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.index.&lt;name&gt;.statistics.number-of-updates</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number of times this Index has been updated.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.index.&lt;name&gt;.statistics.read-lock-count</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number of read locks taken on this Index.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.index.&lt;name&gt;.statistics.total-update-time</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Total amount of time (ns) spent updating this Index.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.index.&lt;name&gt;.statistics.total-uses</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Total number of times this Index has been accessed by
an OQL query.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="actuator-base-healthindicators-diskstores">21.1.4. GeodeDiskStoresHealthIndicator</h4>
<div class="paragraph">
<p>The <code>GeodeDiskStoresHealthIndicator</code> provides details about the configured <code>DiskStores</code> in the system or application.
Remember, <code>DiskStores</code> are used to overflow and persist data to disk, including type metadata tracked by PDX when the
values in the Regions have been serialized with PDX and the Regions are persistent.</p>
</div>
<div class="paragraph">
<p>Most of the tracked health information pertains to configuration:</p>
</div>
<table class="tableblock frame-all grid-all" style="width: 90%;">
<caption class="title">Table 11. DiskStore Details</caption>
<colgroup>
<col style="width: 23.0769%;">
<col style="width: 76.9231%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.disk-store.&lt;name&gt;.allow-force-compaction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates whether manual compaction of the DiskStore
is allowed.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.disk-store.&lt;name&gt;.auto-compact</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates whether compaction occurs automatically.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.disk-store.&lt;name&gt;.compaction-threshold</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Percentage at which the oplog becomes compactible.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.disk-store.&lt;name&gt;.disk-directories</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Location of the oplog disk files.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.disk-store.&lt;name&gt;.disk-directory-sizes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Configured and allowed sizes (MB) for the disk directory
that stores the disk files.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.disk-store.&lt;name&gt;.disk-usage-critical-percentage</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Critical threshold of disk usage proportional to
the total disk volume.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.disk-store.&lt;name&gt;.disk-usage-warning-percentage</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Warning threshold of disk usage proportional to
the total disk volume.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.disk-store.&lt;name&gt;.max-oplog-size</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Maximum size (MB) allowed for a single oplog file.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.disk-store.&lt;name&gt;.queue-size</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Size of the queue used to batch writes that are flushed
to disk.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.disk-store.&lt;name&gt;.time-interval</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Time to wait (ms) before writes are flushed to disk
from the queue if the size limit has not be reached.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.disk-store.&lt;name&gt;.uuid</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Universally unique identifier for the DiskStore across a
distributed system.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.disk-store.&lt;name&gt;.write-buffer-size</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Size the of write buffer the DiskStore uses to write data
to disk.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="actuator-clientcache-healthindicators">21.2. <code>ClientCache</code> <code>HealthIndicators</code></h3>
<div class="paragraph">
<p>The <code>ClientCache</code>-based <code>HealthIndicators</code> provide additional details specifically for Spring Boot, cache client
applications. These <code>HealthIndicators</code> are available only when the Spring Boot application creates a <code>ClientCache</code>
instance (that is, the application is a cache client), which is the default.</p>
</div>
<div class="sect3">
<h4 id="actuator-clientcache-healthindicators-cq">21.2.1. GeodeContinuousQueriesHealthIndicator</h4>
<div class="paragraph">
<p><code>GeodeContinuousQueriesHealthIndicator</code> provides details about registered client Continuous Queries (CQs). CQs let
client applications receive automatic notification about events that satisfy some criteria. That criteria can be easily
expressed by using the predicate of an OQL query (for example, <code>SELECT * FROM /Customers c WHERE c.age &gt; 21</code>).
When data is inserted or updated and the data matches the criteria specified in the OQL query predicate
(data of interests), an event is sent to the registered client.</p>
</div>
<div class="paragraph">
<p>The following details are covered for CQs by name:</p>
</div>
<table class="tableblock frame-all grid-all" style="width: 90%;">
<caption class="title">Table 12. Continuous Query (CQ) Details</caption>
<colgroup>
<col style="width: 23.0769%;">
<col style="width: 76.9231%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.continuous-query.&lt;name&gt;.oql-query-string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OQL query constituting the CQ.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.continuous-query.&lt;name&gt;.closed</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates whether the CQ has been closed.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.continuous-query.&lt;name&gt;.closing</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates whether the CQ is in the process of closing.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.continuous-query.&lt;name&gt;.durable</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates whether the CQ events are remembered
between client sessions.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.continuous-query.&lt;name&gt;.running</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates whether the CQ is currently running.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.continuous-query.&lt;name&gt;.stopped</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates whether the CQ has been stopped.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>In addition, the following CQ query and statistical data is covered:</p>
</div>
<table class="tableblock frame-all grid-all" style="width: 90%;">
<caption class="title">Table 13. Continuous Query (CQ), Query Details</caption>
<colgroup>
<col style="width: 23.0769%;">
<col style="width: 76.9231%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.continuous-query.&lt;name&gt;.query.number-of-executions</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Total number of times the query has been executed.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.continuous-query.&lt;name&gt;.query.total-execution-time</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Total amount of time (ns) spent executing the query.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all" style="width: 90%;">
<caption class="title">Table 14. Continuous Query(CQ), Statistic Details</caption>
<colgroup>
<col style="width: 23.0769%;">
<col style="width: 76.9231%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.continuous-query.&lt;name&gt;.statistics.number-of-deletes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number of delete events qualified by this CQ.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.continuous-query.&lt;name&gt;.statistics.number-of-events</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Total number of events qualified by this CQ.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.continuous-query.&lt;name&gt;.statistics.number-of-inserts</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number of insert events qualified by this CQ.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.continuous-query.&lt;name&gt;.statistics.number-of-updates</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number of update events qualified by this CQ.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The Apache Geode Continuous Query system is also tracked with the following additional details on the client:</p>
</div>
<table class="tableblock frame-all grid-all" style="width: 90%;">
<caption class="title">Table 15. Continuous Query (CQ), Additional Statistic Details</caption>
<colgroup>
<col style="width: 23.0769%;">
<col style="width: 76.9231%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.continuous-query.count</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Total count of CQs.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.continuous-query.number-of-active</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number of currently active CQs (if available).</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.continuous-query.number-of-closed</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Total number of closed CQs (if available).</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.continuous-query.number-of-created</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Total number of created CQs (if available).</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.continuous-query.number-of-stopped</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number of currently stopped CQs (if available).</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.continuous-query.number-on-client</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number of CQs that are currently active or stopped
(if available).</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="actuator-clientcache-healthindicators-pools">21.2.2. GeodePoolsHealthIndicator</h4>
<div class="paragraph">
<p><code>GeodePoolsHealthIndicator</code> provides details about all the configured client connection <code>Pools</code>. This <code>HealthIndicator</code>
primarily provides configuration metadata for all the configured <code>Pools</code>.</p>
</div>
<div class="paragraph">
<p>The following details are covered:</p>
</div>
<table class="tableblock frame-all grid-all" style="width: 90%;">
<caption class="title">Table 16. Pool Details</caption>
<colgroup>
<col style="width: 23.0769%;">
<col style="width: 76.9231%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.pool.count</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Total number of client connection pools.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.pool.&lt;name&gt;.destroyed</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates whether the pool has been destroyed.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.pool.&lt;name&gt;.free-connection-timeout</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Configured amount of time to wait for a free connection
from the Pool.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.pool.&lt;name&gt;.idle-timeout</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The amount of time to wait before closing unused, idle
connections, not exceeding the configured number of minimum required connections.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.pool.&lt;name&gt;.load-conditioning-interval</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">How frequently the Pool checks to see whether a connection
to a given server should be moved to a different server to improve the load balance.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.pool.&lt;name&gt;.locators</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">List of configured Locators.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.pool.&lt;name&gt;.max-connections</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Maximum number of connections obtainable from the Pool.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.pool.&lt;name&gt;.min-connections</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Minimum number of connections contained by the Pool.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.pool.&lt;name&gt;.multi-user-authentication</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Determines whether the Pool can be used by multiple
authenticated users.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.pool.&lt;name&gt;.online-locators</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns a list of living Locators.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.pool.&lt;name&gt;.pending-event-count</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Approximate number of pending subscription events maintained
at the server for this durable client Pool at the time it (re)connected to the server.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.pool.&lt;name&gt;.ping-interval</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">How often to ping the servers to verify they are still alive.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.pool.&lt;name&gt;.pr-single-hop-enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether the client acquires a direct connection to
the server.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.pool.&lt;name&gt;.read-timeout</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number of milliseconds to wait for a response from a server
before timing out the operation and trying another server (if any are available).</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.pool.&lt;name&gt;.retry-attempts</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number of times to retry a request after a timeout
or an exception.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.pool.&lt;name&gt;.server-group</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">All servers must belong to the same group, and this value
sets the name of that group.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.pool.&lt;name&gt;.servers</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">List of configured servers.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.pool.&lt;name&gt;.socket-buffer-size</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Socket buffer size for each connection made in this pool.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.pool.&lt;name&gt;.statistic-interval</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">How often to send client statistics to the server.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.pool.&lt;name&gt;.subscription-ack-interval</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Interval in milliseconds to wait before sending
acknowledgements to the cache server for events received from the server subscriptions.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.pool.&lt;name&gt;.subscription-enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled server-to-client subscriptions.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.pool.&lt;name&gt;.subscription-message-tracking-timeout</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Time-to-Live (TTL) period (ms) for subscription events
the client has received from the server.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.pool.&lt;name&gt;.subscription-redundancy</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Redundancy level for this Pool&#8217;s server-to-client
subscriptions, which is used to ensure clients do not miss potentially important events.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.pool.&lt;name&gt;.thread-local-connections</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Thread local connection policy for this Pool.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="actuator-peercache-healthindicators">21.3. Peer Cache HealthIndicators</h3>
<div class="paragraph">
<p>The peer <code>Cache</code>-based <code>HealthIndicators</code> provide additional details specifically for Spring Boot peer cache member
applications. These <code>HealthIndicators</code> are available only when the Spring Boot application creates a peer <code>Cache</code>
instance.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The default cache instance created by Spring Boot for Apache Geode is a <code>ClientCache</code> instance.
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
To control what type of cache instance is created, such as a &#8220;peer&#8221;, you can explicitly declare either the
<code>@PeerCacheApplication</code> or, alternatively, the <code>@CacheServerApplication</code> annotation on your
<code>@SpringBootApplication</code>-annotated class.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="actuator-peercache-healthindicators-cacheservers">21.3.1. GeodeCacheServersHealthIndicator</h4>
<div class="paragraph">
<p>The <code>GeodeCacheServersHealthIndicator</code> provides details about the configured Apache Geode <code>CacheServer</code> instances.
<code>CacheServer</code> instances are required to enable clients to connect to the servers in the cluster.</p>
</div>
<div class="paragraph">
<p>This <code>HealthIndicator</code> captures basic configuration metadata and the runtime behavior and characteristics of
the configured <code>CacheServer</code> instances:</p>
</div>
<table class="tableblock frame-all grid-all" style="width: 90%;">
<caption class="title">Table 17. CacheServer Details</caption>
<colgroup>
<col style="width: 23.0769%;">
<col style="width: 76.9231%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.cache.server.count</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Total number of configured <code>CacheServer</code> instances
on this peer member.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.cache.server.&lt;index&gt;.bind-address</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">IP address of the NIC to which the <code>CacheServer</code> <code>ServerSocket</code>
is bound (useful when the system contains multiple NICs).</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.cache.server.&lt;index&gt;.hostname-for-clients</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the host used by clients to connect to the <code>CacheServer</code>
(useful with DNS).</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.cache.server.&lt;index&gt;.load-poll-interval</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">How often (ms) to query the load probe on the <code>CacheServer</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.cache.server.&lt;index&gt;.max-connections</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Maximum number of connections allowed to this <code>CacheServer</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.cache.server.&lt;index&gt;.max-message-count</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Maximum number of messages that can be put in a client queue.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.cache.server.&lt;index&gt;.max-threads</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Maximum number of threads allowed in this <code>CacheServer</code>
to service client requests.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.cache.server.&lt;index&gt;.max-time-between-pings</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Maximum time between client pings.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.cache.server.&lt;index&gt;.message-time-to-live</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Time (seconds) in which the client queue expires.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.cache.server.&lt;index&gt;.port</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Network port to which the CacheServer <code>ServerSocket</code> is bound
and on which it listens for client connections.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.cache.server.&lt;index&gt;.running</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Determines whether this <code>CacheServer</code> is currently running
and accepting client connections.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.cache.server.&lt;index&gt;.socket-buffer-size</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Configured buffer size of the socket connection used by
this CacheServer.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.cache.server.&lt;index&gt;.tcp-no-delay</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Configures the TCP/IP <code>TCP_NO_DELAY</code> setting on outgoing sockets.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>In addition to the configuration settings shown in the preceding table, the <code>ServerLoadProbe</code> of the <code>CacheServer</code>
tracks additional details about the runtime characteristics of the <code>CacheServer</code>:</p>
</div>
<table class="tableblock frame-all grid-all" style="width: 90%;">
<caption class="title">Table 18. CacheServer Metrics and Load Details</caption>
<colgroup>
<col style="width: 23.0769%;">
<col style="width: 76.9231%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.cache.server.&lt;index&gt;.load.connection-load</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Load on the server due to client-to-server
connections.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.cache.server.&lt;index&gt;.load.load-per-connection</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Estimate of how much load each new connection
adds to this server.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.cache.server.&lt;index&gt;.load.subscription-connection-load</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Load on the server due to subscription connections.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.cache.server.&lt;index&gt;.load.load-per-subscription-connection</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Estimate of how much load each new subscriber adds
to this server.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.cache.server.&lt;index&gt;.metrics.client-count</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number of connected clients.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.cache.server.&lt;index&gt;.metrics.max-connection-count</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Maximum number of connections made to this
<code>CacheServer</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.cache.server.&lt;index&gt;.metrics.open-connection-count</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number of open connections to this <code>CacheServer</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.cache.server.&lt;index&gt;.metrics.subscription-connection-count</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number of subscription connections to this
<code>CacheServer</code>.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="actuator-peercache-healthindicators-aeq">21.3.2. GeodeAsyncEventQueuesHealthIndicator</h4>
<div class="paragraph">
<p><code>GeodeAsyncEventQueuesHealthIndicator</code> provides details about the configured <code>AsyncEventQueues</code>. AEQs can be attached to
Regions to configure asynchronous write-behind behavior.</p>
</div>
<div class="paragraph">
<p>This <code>HealthIndicator</code> captures configuration metadata and runtime characteristics for all AEQs:</p>
</div>
<table class="tableblock frame-all grid-all" style="width: 90%;">
<caption class="title">Table 19. AsyncEventQueue Details</caption>
<colgroup>
<col style="width: 23.0769%;">
<col style="width: 76.9231%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.async-event-queue.count</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Total number of configured AEQs.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.async-event-queue.&lt;id&gt;.batch-conflation-enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates whether batch events are conflated when sent.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.async-event-queue.&lt;id&gt;.batch-size</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Size of the batch that gets delivered over this AEQ.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.async-event-queue.&lt;id&gt;.batch-time-interval</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Maximum time interval that can elapse before a batch is sent.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.async-event-queue.&lt;id&gt;.disk-store-name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the disk store used to overflow and persist events.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.async-event-queue.&lt;id&gt;.disk-synchronous</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates whether disk writes are synchronous or asynchronous.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.async-event-queue.&lt;id&gt;.dispatcher-threads</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number of threads used to dispatch events.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.async-event-queue.&lt;id&gt;.forward-expiration-destroy</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates whether expiration destroy operations
are forwarded to <code>AsyncEventListener</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.async-event-queue.&lt;id&gt;.max-queue-memory</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Maximum memory used before data needs to be overflowed
to disk.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.async-event-queue.&lt;id&gt;.order-policy</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Order policy followed while dispatching the events to
<code>AsyncEventListeners</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.async-event-queue.&lt;id&gt;.parallel</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates whether this queue is parallel (higher throughput)
or serial.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.async-event-queue.&lt;id&gt;.persistent</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates whether this queue stores events to disk.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.async-event-queue.&lt;id&gt;.primary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates whether this queue is primary or secondary.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.async-event-queue.&lt;id&gt;.size</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number of entries in this queue.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="actuator-peercache-healthindicators-gateway-receivers">21.3.3. GeodeGatewayReceiversHealthIndicator</h4>
<div class="paragraph">
<p><code>GeodeGatewayReceiversHealthIndicator</code> provides details about the configured (WAN) <code>GatewayReceivers</code>,
which are capable of receiving events from remote clusters when using Apache Geode&#8217;s
<a href="https://geode.apache.org/docs/guide/{apache-geode-doc-version}/topologies_and_comm/multi_site_configuration/chapter_overview.html">multi-site, WAN topology</a>.</p>
</div>
<div class="paragraph">
<p>This <code>HealthIndicator</code> captures configuration metadata along with the running state for each <code>GatewayReceiver</code>:</p>
</div>
<table class="tableblock frame-all grid-all" style="width: 90%;">
<caption class="title">Table 20. GatewayReceiver Details</caption>
<colgroup>
<col style="width: 23.0769%;">
<col style="width: 76.9231%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.gateway-receiver.count</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Total number of configured <code>GatewayReceiver</code> instances.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.gateway-receiver.&lt;index&gt;.bind-address</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">IP address of the NIC to which the <code>GatewayReceiver</code>
<code>ServerSocket</code> is bound (useful when the system contains multiple NICs).</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.gateway-receiver.&lt;index&gt;.end-port</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">End value of the port range from which the port of
the <code>GatewayReceiver</code> is chosen.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.gateway-receiver.&lt;index&gt;.host</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">IP address or hostname that Locators tell clients (that is,
<code>GatewaySender</code> instances) on which this <code>GatewayReceiver</code> listens.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.gateway-receiver.&lt;index&gt;.max-time-between-pings</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Maximum amount of time between client pings.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.gateway-receiver.&lt;index&gt;.port</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Port on which this <code>GatewayReceiver</code> listens for clients
(that is, <code>GatewaySender</code> instances).</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.gateway-receiver.&lt;index&gt;.running</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates whether this <code>GatewayReceiver</code> is running
and accepting client connections (from <code>GatewaySender</code> instances).</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.gateway-receiver.&lt;index&gt;.socket-buffer-size</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Configured buffer size for the socket connections used by
this <code>GatewayReceiver</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.gateway-receiver.&lt;index&gt;.start-port</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Start value of the port range from which the port of
the <code>GatewayReceiver</code> is chosen.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="actuator-peercache-healthindicators-gateway-senders">21.3.4. GeodeGatewaySendersHealthIndicator</h4>
<div class="paragraph">
<p>The <code>GeodeGatewaySendersHealthIndicator</code> provides details about the configured <code>GatewaySenders</code>. <code>GatewaySender</code>
instances are attached to Regions in order to send Region events to remote clusters in Apache Geode&#8217;s
<a href="https://geode.apache.org/docs/guide/{apache-geode-doc-version}/topologies_and_comm/multi_site_configuration/chapter_overview.html">multi-site, WAN topology</a>.</p>
</div>
<div class="paragraph">
<p>This <code>HealthIndicator</code> captures essential configuration metadata and runtime characteristics for each <code>GatewaySender</code>:</p>
</div>
<table class="tableblock frame-all grid-all" style="width: 90%;">
<caption class="title">Table 21. GatewaySender Details</caption>
<colgroup>
<col style="width: 23.0769%;">
<col style="width: 76.9231%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.gateway-sender.count</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Total number of configured <code>GatewaySender</code> instances.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.gateway-sender.&lt;id&gt;.alert-threshold</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Alert threshold (ms) for entries in this
<code>GatewaySender</code> instances queue.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.gateway-sender.&lt;id&gt;.batch-conflation-enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates whether batch events are conflated
when sent.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.gateway-sender.&lt;id&gt;.batch-size</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Size of the batches sent.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.gateway-sender.&lt;id&gt;.batch-time-interval</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Maximum time interval that can elapse before a batch
is sent.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.gateway-sender.&lt;id&gt;.disk-store-name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the <code>DiskStore</code> used to overflow and persist
queued events.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.gateway-sender.&lt;id&gt;.disk-synchronous</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates whether disk writes are synchronous
or asynchronous.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.gateway-sender.&lt;id&gt;.dispatcher-threads</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number of threads used to dispatch events.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.gateway-sender.&lt;id&gt;.max-parallelism-for-replicated-region</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.gateway-sender.&lt;id&gt;.max-queue-memory</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Maximum amount of memory (MB) usable for this
<code>GatewaySender</code> instance&#8217;s queue.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.gateway-sender.&lt;id&gt;.order-policy</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Order policy followed while dispatching the events
to <code>GatewayReceiver</code> instances.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.gateway-sender.&lt;id&gt;.parallel</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates whether this <code>GatewaySender</code> is parallel
(higher throughput) or serial.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.gateway-sender.&lt;id&gt;.paused</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates whether this <code>GatewaySender</code> is paused.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.gateway-sender.&lt;id&gt;.persistent</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates whether this <code>GatewaySender</code> persists
queue events to disk.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.gateway-sender.&lt;id&gt;.remote-distributed-system-id</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Identifier for the remote distributed system.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.gateway-sender.&lt;id&gt;.running</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates whether this <code>GatewaySender</code>
is currently running.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.gateway-sender.&lt;id&gt;.socket-buffer-size</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Configured buffer size for the socket connections
between this <code>GatewaySender</code> and the receiving <code>GatewayReceiver</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">geode.gateway-sender.&lt;id&gt;.socket-read-timeout</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Amount of time (ms) that a socket read between this
sending <code>GatewaySender</code> and the receiving <code>GatewayReceiver</code> blocks.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="geode-session">22. Spring Session</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This chapter covers auto-configuration of Spring Session for Apache Geode to manage (HTTP) session state in a reliable
(consistent), highly available (replicated), and clustered manner.</p>
</div>
<div class="paragraph">
<p><a href="https://spring.io/projects/spring-session">Spring Session</a> provides an API and several implementations for managing a user&#8217;s session
information. It has the ability to replace the <code>javax.servlet.http.HttpSession</code> in an application container-neutral way
and provide session IDs in HTTP headers to work with RESTful APIs.</p>
</div>
<div class="paragraph">
<p>Furthermore, Spring Session provides the ability to keep the <code>HttpSession</code> alive even when working with <code>WebSockets</code>
and reactive Spring WebFlux <code>WebSessions</code>.</p>
</div>
<div class="paragraph">
<p>A complete discussion of Spring Session is beyond the scope of this document. You can learn more by reading
the <a href="https://docs.spring.io/spring-session/docs/current/reference/html5">docs</a> and reviewing the <a href="https://docs.spring.io/spring-session/docs/current/reference/html5/#samples">samples</a>.</p>
</div>
<div class="paragraph">
<p>Spring Boot for Apache Geode provides auto-configuration support to configure Apache Geode as the session management
provider and store when <a href="https://spring.io/projects/spring-session-data-geode">Spring Session for Apache Geode</a> is on your Spring Boot
application&#8217;s classpath.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
You can learn more about Spring Session for Apache Geode in the <a href="https://docs.spring.io/autorepo/docs/spring-session-data-geode-build/{spring-session-data-geode-version}/reference/html5">docs</a>.
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
See the corresponding sample <a href="guides/caching-http-session.html.html">guide</a>
and {github-samples-url}/caching/http-session[code] to see Spring Session for Apache Geode in action.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="geode-session-configuration">22.1. Configuration</h3>
<div class="paragraph">
<p>You need do nothing special to use Apache Geode as a Spring Session provider implementation, managing the (HTTP) session
state of your Spring Boot application.</p>
</div>
<div class="paragraph">
<p>To do so, include the appropriate Spring Session dependency on your Spring Boot application&#8217;s classpath:</p>
</div>
<div class="exampleblock">
<div class="title">Example 183. Maven dependency declaration</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">  &lt;dependency&gt;
    &lt;groupId&gt;org.springframework.session&lt;/groupId&gt;
    &lt;artifactId&gt;spring-session-data-geode&lt;/artifactId&gt;
    &lt;version&gt;{spring-session-data-geode-version}&lt;/version&gt;
  &lt;/dependency&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Alternatively, you may declare the provided <code>spring-geode-starter-session</code> dependency in your Spring Boot application
Maven POM (shown here) or Gradle build file:</p>
</div>
<div class="exampleblock">
<div class="title">Example 184. Maven dependency declaration</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">  &lt;dependency&gt;
    &lt;groupId&gt;org.springframework.geode&lt;/groupId&gt;
    &lt;artifactId&gt;spring-geode-starter-session&lt;/artifactId&gt;
    &lt;version&gt;{version}&lt;/version&gt;
  &lt;/dependency&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>After declaring the required Spring Session dependency, you can begin your Spring Boot application as you normally would:</p>
</div>
<div class="exampleblock">
<div class="title">Example 185. Spring Boot Application</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@SpringBootApplication
public class MySpringBootApplication {

  public static void main(String[] args) {
    SpringApplication.run(MySpringBootApplication.class, args);
  }

  // ...
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>You can then create application-specific Spring Web MVC <code>Controllers</code> to interact with the <code>HttpSession</code> as needed
by your application:</p>
</div>
<div class="exampleblock">
<div class="title">Example 186. Spring Boot Application <code>Controller</code> using <code>HttpSession</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Controller
class MyApplicationController {

  @GetRequest("...")
  public String processGet(HttpSession session) {
    // interact with HttpSession
  }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The <code>HttpSession</code> is replaced by a Spring managed <code>Session</code> that is stored in Apache Geode.</p>
</div>
</div>
<div class="sect2">
<h3 id="geode-session-configuration-custom">22.2. Custom Configuration</h3>
<div class="paragraph">
<p>By default, Spring Boot for Apache Geode (SBDG) applies reasonable and sensible defaults when configuring Apache Geode
as the provider in Spring Session.</p>
</div>
<div class="paragraph">
<p>For instance, by default, SBDG sets the session expiration timeout to 30 minutes. It also uses a
<code>ClientRegionShortcut.PROXY</code> as the data management policy for the Apache Geode client Region that managing the (HTTP)
session state when the Spring Boot application is using a <code>ClientCache</code>, which it does
by <a href="#geode-clientcache-applications">default</a>.</p>
</div>
<div class="paragraph">
<p>However, what if the defaults are not sufficient for your application requirements?</p>
</div>
<div class="paragraph">
<p>In that case, see the next section.</p>
</div>
<div class="sect3">
<h4 id="geode-session-configuration-custom-properties">22.2.1. Custom Configuration using Properties</h4>
<div class="paragraph">
<p>Spring Session for Apache Geode publishes
<a href="https://docs.spring.io/autorepo/docs/spring-session-data-geode-build/{spring-session-data-geode-version}/reference/html5/#httpsession-gemfire-configuration-properties">well-known configuration properties</a>
for each of the various Spring Session configuration options when you use Apache Geode as the (HTTP) session state
management provider.</p>
</div>
<div class="paragraph">
<p>You can specify any of these properties in Spring Boot <code>application.properties</code> to adjust Spring Session&#8217;s configuration
when using Apache Geode.</p>
</div>
<div class="paragraph">
<p>In addition to the properties provided in and by Spring Session for Apache Geode, Spring Boot for Apache Geode also
recognizes and respects the <code>spring.session.timeout</code> property and the <code>server.servlet.session.timeout</code> property, as
discussed <a href="https://docs.spring.io/spring-boot/docs/current/reference/html/boot-features-session.html">the Spring Boot documentation</a>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<code>spring.session.data.gemfire.session.expiration.max-inactive-interval-seconds</code> takes precedence over
<code>spring.session.timeout</code>, which takes precedence over <code>server.servlet.session.timeout</code> when any combination of
these properties have been simultaneously configured in the Spring <code>Environment</code> of your application.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="geode-session-configuration-custom-configurer">22.2.2. Custom Configuration using a Configurer</h4>
<div class="paragraph">
<p>Spring Session for Apache Geode also provides the
<a href="https://docs.spring.io/autorepo/docs/spring-session-data-geode-build/{spring-session-data-geode-version}/api/org/springframework/session/data/gemfire/config/annotation/web/http/support/SpringSessionGemFireConfigurer.html"><code>SpringSessionGemFireConfigurer</code></a>
callback interface, which you can declare in your Spring <code>ApplicationContext</code> to programmatically control
the configuration of Spring Session when you use Apache Geode.</p>
</div>
<div class="paragraph">
<p>The <code>SpringSessionGemFireConfigurer</code>, when declared in the Spring <code>ApplicationContext</code>, takes precedence over any of
the Spring Session (for Apache Geode) configuration properties and effectively overrides them when both are present.</p>
</div>
<div class="paragraph">
<p>More information on using the <code>SpringSessionGemFireConfigurer</code> can be found in the
<a href="https://docs.spring.io/autorepo/docs/spring-session-data-geode-build/{spring-session-data-geode-version}/reference/html5/#httpsession-gemfire-configuration-configurer">docs</a>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="geode-session-disable">22.3. Disabling Session State Caching</h3>
<div class="paragraph">
<p>There may be cases where you do not want your Spring Boot application to manage (HTTP) session state by using
Apache Geode.</p>
</div>
<div class="paragraph">
<p>In certain cases, you may be using another Spring Session provider implementation, such as Redis, to cache and manage
your Spring Boot application&#8217;s (HTTP) session state. In other cases, you do not want to use Spring Session to manage
your (HTTP) session state at all. Rather, you prefer to use your Web Server&#8217;s (such as Tomcat&#8217;s) built-in <code>HttpSession</code>
state management capabilities.</p>
</div>
<div class="paragraph">
<p>Either way, you can specifically call out your Spring Session provider implementation by using
the <code>spring.session.store-type</code> property in Spring Boot <code>application.properties</code>:</p>
</div>
<div class="exampleblock">
<div class="title">Example 187. Use Redis as the Spring Session Provider Implementation</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="txt">#application.properties

spring.session.store-type=redis
...</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>If you prefer not to use Spring Session to manage your Spring Boot application&#8217;s (HTTP) session state at all, you can do
the following:</p>
</div>
<div class="exampleblock">
<div class="title">Example 188. Use Web Server Session State Management</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="txt">#application.properties

spring.session.store-type=none
...</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Again, see the Spring Boot <a href="https://docs.spring.io/spring-boot/docs/current/reference/html/boot-features-session.html">documentation</a> for more detail.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
You can include multiple provider implementations on the classpath of your Spring Boot application. For instance,
you might use Redis to cache your application&#8217;s (HTTP) session state while using Apache Geode as your application&#8217;s
transactional persistent store (System of Record).
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Spring Boot does not properly recognize <code>spring.session.store-type=[gemfire|geode]</code> even though
Spring Boot for Apache Geode is set up to handle either of these property values
(that is, either <code>gemfire</code> or <code>geode</code>).
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="geode-session-pcc">22.4. Using Spring Session with VMware Tanzu GemFire for VMs (PCC)</h3>
<div class="paragraph">
<p>Whether you use Spring Session in a Spring Boot, Apache Geode <code>ClientCache</code> application to connect to an standalone,
externally managed cluster of Apache Geode servers or to connect to a cluster of servers in a VMware Tanzu GemFire for VMs service
instance managed by a VMware Tanzu Application Service (TAS) environment, the setup is the same.</p>
</div>
<div class="paragraph">
<p>Spring Session for Apache Geode expects there to be a cache Region in the cluster that can store and manage (HTTP)
session state when your Spring Boot application is a <code>ClientCache</code> application in the client/server topology.</p>
</div>
<div class="paragraph">
<p>By default, the cache Region used to store and manage (HTTP) session state is called <code>ClusteredSpringSessions</code>.</p>
</div>
<div class="paragraph">
<p>We recommend that you configure the cache Region name by using the well-known and documented property
in Spring Boot <code>application.properties</code>:</p>
</div>
<div class="exampleblock">
<div class="title">Example 189. Using properties</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="properties">spring.session.data.gemfire.session.region.name=MySessions</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Alternatively, you can set the name of the cache Region used to store and manage (HTTP) session state by explicitly
declaring the <code>@EnableGemFireHttpSession</code> annotation on your main <code>@SpringBootApplication</code> class:</p>
</div>
<div class="exampleblock">
<div class="title">Example 190. Using `@EnableGemfireHttpSession</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@SpringBootApplication
@EnableGemFireHttpSession(regionName = "MySessions")
class MySpringBootSpringSessionApplication {
	// ...
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Once you decide on the cache Region name used to store and manage (HTTP) sessions, you must create the cache Region
in the cluster somehow.</p>
</div>
<div class="paragraph">
<p>On the client, doing so is simple, since SBDG&#8217;s auto-configuration automatically creates the client <code>PROXY</code> Region
that is used to send and receive (HTTP) session state between the client and server for you when either Spring Session
is on the application classpath (for example, <code>spring-geode-starter-session</code>) or you explicitly declare
the <code>@EnableGemFireHttpSession</code> annotation on your main <code>@SpringBootApplication</code> class.</p>
</div>
<div class="paragraph">
<p>However, on the server side, you currently have a couple of options.</p>
</div>
<div class="paragraph">
<p>First, you can manually create the cache Region by using Gfsh:</p>
</div>
<div class="exampleblock">
<div class="title">Example 191. Create the Sessions Region using Gfsh</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="txt">gfsh&gt; create region --name=MySessions --type=PARTITION --entry-idle-time-expiration=1800
        --entry-idle-time-expiration-action=INVALIDATE</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>You must create the cache Region with the appropriate name and an expiration policy.</p>
</div>
<div class="paragraph">
<p>In this case, we created an idle expiration policy with a timeout of <code>1800</code> seconds (30 minutes), after which the entry
(session object) is <code>invalidated</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Session expiration is managed by the Expiration Policy set on the cache Region that is used to store session state.
The Servlet container&#8217;s (HTTP) session expiration configuration is not used, since Spring Session replaces the Servlet
container&#8217;s session management capabilities with its own, and Spring Session delegates this behavior to the individual
providers, such as Apache Geode.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Alternatively, you could send the definition for the cache Region from your Spring Boot <code>ClientCache</code> application
to the cluster by using the SBDG <a href="https://docs.spring.io/spring-boot-data-geode-build/current/api//org/springframework/geode/config/annotation/EnableClusterAware.html"><code>@EnableClusterAware</code></a> annotation,
which is meta-annotated with SDG&#8217;s <code>@EnableClusterConfiguration</code> annotation:</p>
</div>
<div class="exampleblock">
<div class="title">Example 192. Using <code>@EnableClusterAware</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@SpringBootApplication
@EnableClusterAware
class MySpringBootSpringSessionApacheGeodeApplication {
	// ...
}</code></pre>
</div>
</div>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
See the <a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnableClusterConfiguration.html">Javadoc</a>
on the <code>@EnableClusterConfiguration</code> annotation and the <a href="https://docs.spring.io/spring-data/geode/docs/current/reference/html/#bootstrap-annotation-config-cluster">documentation</a>
for more detail.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>However, you cannot currently send expiration policy configuration metadata to the cluster. Therefore, you must manually
alter the cache Region to set the expiration policy:</p>
</div>
<div class="exampleblock">
<div class="title">Example 193. Using Gfsh to Alter Region</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="txt">gfsh&gt; alter region --name=MySessions --entry-idle-time-expiration=1800
        --entry-idle-time-expiration-action=INVALIDATE</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Now your Spring Boot <code>ClientCache</code> application that uses Spring Session in a client/server topology is configured to
store and manage user (HTTP) session state in the cluster. This works for either standalone, externally managed
Apache Geode clusters or when you use PCC running in a VMware Tanzu Application Service (TAS) environment.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cloudfoundry">23. Pivotal CloudFoundry</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
As of the VMware, Inc. acquisition of Pivotal Software, Inc., Pivotal CloudFoundry (PCF) is now known as VMware Tanzu
Application Service (TAS) for VMs. Also, Pivotal Cloud Cache (PCC) has been rebranded as VMware Tanzu GemFire for VMS.
This documentation will eventually be updated to reflect the rebranding.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In most cases, when you deploy (that is, <code>cf push</code>) your Spring Boot applications to Pivotal CloudFoundry (PCF), you bind
your application to one or more instances of the Pivotal Cloud Cache (PCC) service.</p>
</div>
<div class="paragraph">
<p>In a nutshell, <a href="https://pivotal.io/pivotal-cloud-cache">Pivotal Cloud Cache</a> (PCC) is a managed version of
<a href="https://pivotal.io/pivotal-gemfire">VMware Tanzu GemFire</a> that runs in <a href="https://pivotal.io/platform">Pivotal CloudFoundry</a> (PCF).
When running in or across cloud environments (such as AWS, Azure, GCP, or PWS), PCC with PCF offers several advantages
over trying to run and manage your own standalone Apache Geode clusters. It handles many of the infrastructure-related,
operational concerns so that you need not do so.</p>
</div>
<div class="sect2">
<h3 id="cloudfoundry-cloudcache-security-auth-runtime-user-configuration">23.1. Running a Spring Boot application as a specific user</h3>
<div class="paragraph">
<p>By default, Spring Boot applications run as a <code>cluster_operator</code> role-based user in Pivotal CloudFoundry when the application
is bound to a Pivotal Cloud Cache service instance.</p>
</div>
<div class="paragraph">
<p>A <code>cluster_operator</code> has full system privileges (that is, authorization) to do whatever that user wishes to involving
the PCC service instance. A <code>cluster_operator</code> has read and write access to all the data, can modify the schema (for
example, create and destroy Regions, add and remove Indexes, change eviction or expiration policies, and so on), start
and stop servers in the PCC cluster, or even modify permissions.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">About cluster_operator as the default user</div>
<div class="paragraph">
<p>One of the reasons why Spring Boot applications default to running as a <code>cluster_operator</code> is to allow configuration
metadata to be sent from the client to the server. Enabling configuration metadata to be sent from the client to the
server is a useful development-time feature and is as simple as annotating your main <code>@SpringBootApplication</code> class
with the <code>@EnableClusterConfiguration</code> annotation:</p>
</div>
<div class="exampleblock">
<div class="title">Example 194. Using <code>@EnableClusterConfiguration</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@SpringBootApplication
@EnableClusterConfiguration(useHttp = true)
class SpringBootApacheGeodeClientCacheApplication {  }</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>With <code>@EnableClusterConfiguration</code>, Region and OQL Index configuration metadata that is defined on the client can be
sent to servers in the PCC cluster. Apache Geode requires matching Regions by name on both the client and the servers
in order for clients to send and receive data to and from the cluster.</p>
</div>
<div class="paragraph">
<p>For example, when you declare the Region where an application entity is persisted by using the <code>@Region</code> mapping
annotation and declare the <code>@EnableEntityDefinedRegions</code> annotation on the main <code>@SpringBootApplication</code> class
in conjunction with the <code>@EnableClusterConfiguration</code> annotation, not only does SBDG create the required client Region,
but it also sends the configuration metadata for this Region to the servers in the cluster to create the matching,
required server Region, where the data for your application entity is managed.</p>
</div>
</div>
</div>
<div class="paragraph">
<p>However&#8230;&#8203;</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>With great power comes great responsibility. - Uncle Ben</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>Not all Spring Boot applications using PCC need to change the schema or even modify data. Rather, certain applications
may need only read access. Therefore, it is ideal to be able to configure your Spring Boot applications to run with
a different user at runtime other than the auto-configured <code>cluster_operator</code>, by default.</p>
</div>
<div class="paragraph">
<p>A prerequisite for running a Spring Boot application in PCC with a specific user is to create a user with restricted
permissions by using Pivotal CloudFoundry AppsManager while provisioning the PCC service instance to which the Spring Boot
application is bound.</p>
</div>
<div class="paragraph">
<p>Configuration metadata for the PCC service instance might appear as follows:</p>
</div>
<div class="exampleblock">
<div class="title">Example 195. Pivotal Cloud Cache configuration metadata</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="json">{
  "p-cloudcache":[{
    "credentials": {
      "distributed_system_id": "0",
      "locators": [ "localhost[55221]" ],
      "urls": {
        "gfsh": "https://cloudcache-12345.services.cf.pws.com/gemfire/v1",
        "pulse": "https://cloudcache-12345.services.cf.pws.com/pulse"
      },
      "users": [{
        "password": "*****",
        "roles": [ "cluster_operator" ],
        "username": "cluster_operator_user"
      }, {
        "password": "*****",
        "roles": [ "developer" ],
        "username": "developer_user"
      }, {
        "password": "*****",
        "roles": [ "read-only-user" ],
        "username": "guest"
      }],
      "wan": {
        "sender_credentials": {
          "active": {
            "password": "*****",
            "username": "gateway-sender-user"
          }
        }
      }
    },
    "name": "jblum-pcc",
    "plan": "small",
    "tags": [ "gemfire", "cloudcache", "database", "pivotal" ]
  }]
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>In the PCC service instance configuration metadata shown in the preceding example, we see a <code>guest</code> user with
the <code>read-only-user</code> role. If the <code>read-only-user</code> role is properly configured with read-only permissions as the name
implies, we could configure our Spring Boot application to run as <code>guest</code> with read-only access:</p>
</div>
<div class="exampleblock">
<div class="title">Example 196. Configuring a Spring Boot application to run as a specific user</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="properties"># Spring Boot application.properties for PCF when using PCC

spring.data.gemfire.security.username=guest</code></pre>
</div>
</div>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
The <code>spring.data.gemfire.security.username</code> property corresponds directly to the SDG <code>@EnableSecurity</code> annotation&#8217;s
<code>securityUsername</code> attribute. See the
<a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnableSecurity.html#securityUsername--">Javadoc</a>
for more details.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <code>spring.data.gemfire.security.username</code> property is the same property used by Spring Data for Apache Geode (SDG) to
configure the runtime user of your Spring Data application when you connect to an externally managed Apache Geode
cluster.</p>
</div>
<div class="paragraph">
<p>In this case, SBDG uses the configured username to look up the authentication credentials of the user to set
the username and password used by the Spring Boot <code>ClientCache</code> application when connecting to PCC while running in PCF.</p>
</div>
<div class="paragraph">
<p>If the username is not valid, an <code>IllegalStateException</code> is thrown.</p>
</div>
<div class="paragraph">
<p>By using <a href="https://docs.spring.io/spring-boot/docs/current/reference/html/#boot-features-profiles">Spring profiles</a>, it would be a simple matter to configure
the Spring Boot application to run with a different user depending on environment.</p>
</div>
<div class="paragraph">
<p>See the Pivotal Cloud Cache documentation on <a href="https://docs.pivotal.io/p-cloud-cache/{pivotal-cloudcache-doc-version}/security.html">security</a> for configuring users with
assigned roles and permissions.</p>
</div>
<div class="sect3">
<h4 id="cloudfoundry-cloudcache-security-auth-autoconfiguration-override">23.1.1. Overriding Authentication Auto-configuration</h4>
<div class="paragraph">
<p>It should be understood that auto-configuration for client authentication is available only for managed environments,
such as Pivotal CloudFoundry. When running in externally managed environments, you must explicitly set a username and password
to authenticate, as described in <a href="#geode-security-auth-clients-non-managed">Non-Managed Auth for Clients</a>.</p>
</div>
<div class="paragraph">
<p>To completely override the auto-configuration of client authentication, you can set both a username and a password:</p>
</div>
<div class="exampleblock">
<div class="title">Example 197. Overriding Security Authentication Auto-configuration with explicit username and password</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="txt"># Spring Boot application.properties

spring.data.gemfire.security.username=MyUser
spring.data.gemfire.security.password=MyPassword</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>In this case, SBDG&#8217;s auto-configuration for authentication is effectively disabled and security credentials are not
extracted from the environment.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="cloudfoundry-cloudcache-serviceinstance-targeting">23.2. Targeting Specific Pivotal Cloud Cache Service Instances</h3>
<div class="paragraph">
<p>It is possible to provision multiple instances of the Pivotal Cloud Cache service in your Pivotal CloudFoundry environment. You can then
bind multiple PCC service instances to your Spring Boot application.</p>
</div>
<div class="paragraph">
<p>However, Spring Boot for Apache Geode (SBDG) only auto-configures one PCC service instance for your Spring Boot
application. This does not mean that it is not possible to use multiple PCC service instances with your Spring Boot
application, just that SBDG only auto-configures one service instance for you.</p>
</div>
<div class="paragraph">
<p>You must select which PCC service instance your Spring Boot application automatically auto-configures for you when
you have multiple instances and want to target a specific PCC service instance to use.</p>
</div>
<div class="paragraph">
<p>To do so, declare the following SBDG property in Spring Boot <code>application.properties</code>:</p>
</div>
<div class="exampleblock">
<div class="title">Example 198. Spring Boot application.properties targeting a specific PCC service instance by name</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="properties"># Spring Boot application.properties

spring.boot.data.gemfire.cloud.cloudfoundry.service.cloudcache.name=pccServiceInstanceTwo</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The <code>spring.boot.data.gemfire.cloud.cloudfoundry.service.cloudcache.name</code> property tells SBDG which PCC service instance
to auto-configure.</p>
</div>
<div class="paragraph">
<p>If the PCC service instance identified by the property does not exist, SBDG throws an <code>IllegalStateException</code>
stating the PCC service instance by name could not be found.</p>
</div>
<div class="paragraph">
<p>If you did not set the property and your Spring Boot application is bound to multiple PCC service instances,
SBDG auto-configures the first PCC service instance it finds by name, alphabetically.</p>
</div>
<div class="paragraph">
<p>If you did not set the property and no PCC service instance is found, SBDG logs a warning.</p>
</div>
</div>
<div class="sect2">
<h3 id="cloudfoundry-cloudcache-multiinstance-using">23.3. Using Multiple Pivotal Cloud Cache Service Instances</h3>
<div class="paragraph">
<p>If you want to use multiple PCC service instances with your Spring Boot application, you need to configure multiple
connection <code>Pools</code> connected to each PCC service instance used by your Spring Boot application.</p>
</div>
<div class="paragraph">
<p>The configuration would be similar to the following:</p>
</div>
<div class="exampleblock">
<div class="title">Example 199. Multiple Pivotal Cloud Cache Service Instance Configuration</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Configuration
@EnablePools(pools = {
  @EnablePool(name = "PccOne"),
  @EnablePool(name = "PccTwo"),
  ...,
  @EnablePool(name = "PccN")
})
class PccConfiguration {
  // ...
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>You would then externalize the configuration for the individually declared <code>Pools</code> in Spring Boot
<code>application.properties</code>:</p>
</div>
<div class="exampleblock">
<div class="title">Example 200. Configuring Locator-based Pool connections</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="properties"># Spring Boot `application.properties`

spring.data.gemfire.pool.pccone.locators=pccOneHost1[port1], pccOneHost2[port2], ..., pccOneHostN[portN]

spring.data.gemfire.pool.pcctwo.locators=pccTwoHost1[port1], pccTwoHost2[port2], ..., pccTwoHostN[portN]</code></pre>
</div>
</div>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Though less common, you can also configure the <code>Pool</code> of connections to target specific servers in the cluster
by setting the <code>spring.data.gemfire.pool.&lt;named-pool&gt;.severs</code> property.
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Keep in mind that properties in Spring Boot <code>application.properties</code> can refer to other properties:
<code>property=${otherProperty}</code>. This lets you further externalize properties by using Java System properties
or environment variables.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A client Region is then assigned the Pool of connections that are used to send data to and from the specific
PCC service instance (cluster):</p>
</div>
<div class="exampleblock">
<div class="title">Example 201. Assigning a Pool to a client Region</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Configuration
class GeodeConfiguration {

  @Bean("Example")
  ClientRegionFactoryBean exampleRegion(GemFireCache gemfireCache,
      @Qualifier("PccTwo") Pool poolForPccTwo) {

    ClientRegionFactoryBean exampleRegion = new ClientRegionFactoryBean();

    exampleRegion.setCache(gemfireCache);
    exampleRegion.setPool(poolForPccTwo);
    exampleRegion.setShortcut(ClientRegionShortcut.PROXY);

    return exampleRegion;
  }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>You can configure as many Pools and client Regions as your application needs. Again, the <code>Pool</code> determines
the Pivotal Cloud Cache service instance and cluster in which the data for the client Region resides.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
By default, SBDG configures all <code>Pools</code> declared in a Spring Boot <code>ClientCache</code> application to connect to
and use a single PCC service instance. This may be a targeted PCC service instance when you use the
<code>spring.boot.data.gemfire.cloud.cloudfoundry.service.cloudcache.name</code> property
as discussed <a href="#cloudfoundry-cloudcache-multiinstance-using">earlier</a>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="cloudfoundry-geode">23.4. Hybrid Pivotal CloudFoundry and Apache Geode Spring Boot Applications</h3>
<div class="paragraph">
<p>Sometimes, it is desirable to deploy (that is, <code>cf push</code>) and run your Spring Boot applications in Pivotal CloudFoundry
but still connect your Spring Boot applications to an externally managed, standalone Apache Geode cluster.</p>
</div>
<div class="paragraph">
<p>Spring Boot for Apache Geode (SBDG) makes this a non-event and honors its "<em>little to no code or configuration changes
necessary</em>" goal. Regardless of your runtime choice, it should just work!</p>
</div>
<div class="paragraph">
<p>To help guide you through this process, we cover the following topics:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Install and Run PCFDev.</p>
</li>
<li>
<p>Start an Apache Geode cluster.</p>
</li>
<li>
<p>Create a User-Provided Service (CUPS).</p>
</li>
<li>
<p>Push and Bind a Spring Boot application.</p>
</li>
<li>
<p>Run the Spring Boot application.</p>
</li>
</ol>
</div>
<div class="sect3">
<h4 id="cloudfoundry-geode-pcfdev">23.4.1. Running PCFDev</h4>
<div class="paragraph">
<p>For this exercise, we use <a href="https://docs.pivotal.io/pcf-dev/install-osx.html">PCF Dev</a>.</p>
</div>
<div class="paragraph">
<p>PCF Dev, much like PCF, is an elastic application runtime for deploying, running, and managing your Spring Boot
applications. However, it does so in the confines of your local development environment&#8201;&#8212;&#8201;that is, your workstation.</p>
</div>
<div class="paragraph">
<p>Additionally, PCF Dev provides several services, such as MySQL, Redis, and RabbitMQ. You Spring Boot application
can bind to and use these services to accomplish its tasks.</p>
</div>
<div class="paragraph">
<p>However, PCF Dev lacks the Pivotal Cloud Cache service that is available in PCF. This is actually ideal for this exercise since
we are trying to build and run Spring Boot applications in a PCF environment but connect to an externally managed,
standalone Apache Geode cluster.</p>
</div>
<div class="paragraph">
<p>As a prerequisite, you need to follow the steps outlined in the
<a href="https://pivotal.io/platform/pcf-tutorials/getting-started-with-pivotal-cloud-foundry-dev/introduction">tutorial</a>
to get PCF Dev set up and running on your workstation.</p>
</div>
<div class="paragraph">
<p>To run PCF Dev, execute the following <code>cf</code> CLI command, replacing the path to the TGZ file with the file you acquired
from the <a href="https://network.pivotal.io/products/pcfdev">download</a>:</p>
</div>
<div class="exampleblock">
<div class="title">Example 202. Start PCF Dev</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="txt">$ cf dev start -f ~/Downloads/Pivotal/CloudFoundry/Dev/pcfdev-v1.2.0-darwin.tgz</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>You should see output similar to the following:</p>
</div>
<div class="exampleblock">
<div class="title">Example 203. Running PCF Dev</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="txt">Downloading Network Helper...
Progress: |====================&gt;| 100.0%
Installing cfdevd network helper (requires administrator privileges)...
Password:
Setting up IP aliases for the BOSH Director &amp; CF Router (requires administrator privileges)
Downloading Resources...
Progress: |====================&gt;| 100.0%
Setting State...
WARNING: PCF Dev requires 8192 MB of RAM to run. This machine may not have enough free RAM.
Creating the VM...
Starting VPNKit...
Waiting for the VM...
Deploying the BOSH Director...

Deploying PAS...
  Done (14m34s)
Deploying Apps-Manager...
  Done (1m41s)

 	 ██████╗  ██████╗███████╗██████╗ ███████╗██╗   ██╗
 	 ██╔══██╗██╔════╝██╔════╝██╔══██╗██╔════╝██║   ██║
 	 ██████╔╝██║     █████╗  ██║  ██║█████╗  ██║   ██║
 	 ██╔═══╝ ██║     ██╔══╝  ██║  ██║██╔══╝  ╚██╗ ██╔╝
 	 ██║     ╚██████╗██║     ██████╔╝███████╗ ╚████╔╝
 	 ╚═╝      ╚═════╝╚═╝     ╚═════╝ ╚══════╝  ╚═══╝
 	             is now running!

 	To begin using PCF Dev, please run:
 	    cf login -a https://api.dev.cfdev.sh --skip-ssl-validation

 	Admin user =&gt; Email: admin / Password: admin
 	Regular user =&gt; Email: user / Password: pass

 	To access Apps Manager, navigate here: https://apps.dev.cfdev.sh

 	To deploy a particular service, please run:
 	    cf dev deploy-service &lt;service-name&gt; [Available services: mysql,redis,rabbitmq,scs]</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>To use the <code>cf</code> CLI tool, you must login to the PCF Dev environment:</p>
</div>
<div class="exampleblock">
<div class="title">Example 204. Login to PCF Dev using <code>cf</code> CLI</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="txt">$ cf login -a https://api.dev.cfdev.sh --skip-ssl-validation</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>You can also access the <a href="https://apps.dev.cfdev.sh/">PCF Dev Apps Manager</a> tool from your Web browser at the following URL:</p>
</div>
<div class="paragraph">
<p><a href="https://apps.dev.cfdev.sh/" class="bare">apps.dev.cfdev.sh/</a></p>
</div>
<div class="paragraph">
<p>Apps Manager provides a nice UI to manage your org, space, services and apps. It lets you push and update apps,
create services, bind apps to the services, and start and stop your deployed applications, among many other things.</p>
</div>
</div>
<div class="sect3">
<h4 id="cloudfoundry-geode-cluster">23.4.2. Running an Apache Geode Cluster</h4>
<div class="paragraph">
<p>Now that PCF Dev is set up and running, you need to start an external, standalone Apache Geode cluster to which our
Spring Boot application connects and uses to manage its data.</p>
</div>
<div class="paragraph">
<p>You need to install a <a href="https://geode.apache.org//releases/">distribution</a> of Apache Geode on your computer. Then you must
set the <code>$GEODE</code> environment variable. It is also convenient to add <code>$GEODE/bin</code> to your system <code>$PATH</code>.</p>
</div>
<div class="paragraph">
<p>Afterward, you can launch the Geode Shell (<em>Gfsh</em>) tool:</p>
</div>
<div class="exampleblock">
<div class="title">Example 205. Running Gfsh</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="txt">$ echo $GEODE
/Users/jblum/pivdev/apache-geode-1.6.0

$ gfsh
    _________________________     __
   / _____/ ______/ ______/ /____/ /
  / /  __/ /___  /_____  / _____  /
 / /__/ / ____/  _____/ / /    / /
/______/_/      /______/_/    /_/    1.6.0

Monitor and Manage Apache Geode
gfsh&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>We have provided the Gfsh shell script that you can use to start the Apache Geode cluster:</p>
</div>
<div class="exampleblock">
<div class="title">Example 206. Gfsh shell script to start the Apache Geode cluster</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="txt">#!/bin/gfsh
# Gfsh shell script to configure and bootstrap an Apache Geode cluster.

start locator --name=LocatorOne --log-level=config --classpath=@project-dir@/apache-geode-extensions/build/libs/apache-geode-extensions-@project-version@.jar --J=-Dgemfire.security-manager=org.springframework.geode.security.TestSecurityManager --J=-Dgemfire.http-service-port=8080

start server --name=ServerOne --log-level=config --user=admin --password=admin --classpath=@project-dir@/apache-geode-extensions/build/libs/apache-geode-extensions-@project-version@.jar</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The <code>start-cluster.gfsh</code> shell script starts one Geode Locator and one Geode server.</p>
</div>
<div class="paragraph">
<p>A Locator is used by clients to discover and connect to servers in a cluster to manage its data. A Locator is also used
by new servers that join a cluster as peer members, which lets the cluster be elastically scaled out (or scaled down,
as needed). A Geode server stores the data for the application.</p>
</div>
<div class="paragraph">
<p>You can start as many Locators or servers as necessary to meet the availability and load demands of your application.
The more Locators and servers your cluster has, the more resilient it is to failure. However, you should size your
cluster accordingly, based on your application&#8217;s needs, since there is overhead relative to the cluster size.</p>
</div>
<div class="paragraph">
<p>You see output similar to the following when starting the Locator and server:</p>
</div>
<div class="exampleblock">
<div class="title">Example 207. Starting the Apache Geode cluster</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="txt">gfsh&gt;start locator --name=LocatorOne --log-level=config --classpath=/Users/jblum/pivdev/spring-boot-data-geode/apache-geode-extensions/build/libs/apache-geode-extensions-1.1.0.BUILD-SNAPSHOT.jar --J=-Dgemfire.security-manager=org.springframework.geode.security.TestSecurityManager --J=-Dgemfire.http-service-port=8080
Starting a Geode Locator in /Users/jblum/pivdev/lab/LocatorOne...
..
Locator in /Users/jblum/pivdev/lab/LocatorOne on 10.99.199.24[10334] as LocatorOne is currently online.
Process ID: 14358
Uptime: 1 minute 1 second
Geode Version: 1.6.0
Java Version: 1.8.0_192
Log File: /Users/jblum/pivdev/lab/LocatorOne/LocatorOne.log
JVM Arguments: -Dgemfire.enable-cluster-configuration=true -Dgemfire.load-cluster-configuration-from-dir=false -Dgemfire.log-level=config -Dgemfire.security-manager=org.springframework.geode.security.TestSecurityManager -Dgemfire.http-service-port=8080 -Dgemfire.launcher.registerSignalHandlers=true -Djava.awt.headless=true -Dsun.rmi.dgc.server.gcInterval=9223372036854775806
Class-Path: /Users/jblum/pivdev/apache-geode-1.6.0/lib/geode-core-1.6.0.jar:/Users/jblum/pivdev/spring-boot-data-geode/apache-geode-extensions/build/libs/apache-geode-extensions-1.1.0.BUILD-SNAPSHOT.jar:/Users/jblum/pivdev/apache-geode-1.6.0/lib/geode-dependencies.jar

Security Manager is enabled - unable to auto-connect. Please use "connect --locator=10.99.199.24[10334] --user --password" to connect Gfsh to the locator.

Authentication required to connect to the Manager.

gfsh&gt;connect
Connecting to Locator at [host=localhost, port=10334] ..
Connecting to Manager at [host=10.99.199.24, port=1099] ..
user: admin
password: *****
Successfully connected to: [host=10.99.199.24, port=1099]

gfsh&gt;start server --name=ServerOne --log-level=config --user=admin --password=admin --classpath=/Users/jblum/pivdev/spring-boot-data-geode/apache-geode-extensions/build/libs/apache-geode-extensions-1.1.0.BUILD-SNAPSHOT.jar
Starting a Geode Server in /Users/jblum/pivdev/lab/ServerOne...
....
Server in /Users/jblum/pivdev/lab/ServerOne on 10.99.199.24[40404] as ServerOne is currently online.
Process ID: 14401
Uptime: 3 seconds
Geode Version: 1.6.0
Java Version: 1.8.0_192
Log File: /Users/jblum/pivdev/lab/ServerOne/ServerOne.log
JVM Arguments: -Dgemfire.default.locators=10.99.199.24[10334] -Dgemfire.security-username=admin -Dgemfire.start-dev-rest-api=false -Dgemfire.security-password=******** -Dgemfire.use-cluster-configuration=true -Dgemfire.log-level=config -XX:OnOutOfMemoryError=kill -KILL %p -Dgemfire.launcher.registerSignalHandlers=true -Djava.awt.headless=true -Dsun.rmi.dgc.server.gcInterval=9223372036854775806
Class-Path: /Users/jblum/pivdev/apache-geode-1.6.0/lib/geode-core-1.6.0.jar:/Users/jblum/pivdev/spring-boot-data-geode/apache-geode-extensions/build/libs/apache-geode-extensions-1.1.0.BUILD-SNAPSHOT.jar:/Users/jblum/pivdev/apache-geode-1.6.0/lib/geode-dependencies.jar</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Once the cluster has been started successfully, you can list the members:</p>
</div>
<div class="exampleblock">
<div class="title">Example 208. List members of the cluster</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="txt">gfsh&gt;list members
   Name    | Id
---------- | -----------------------------------------------------------------
LocatorOne | 10.99.199.24(LocatorOne:14358:locator)&lt;ec&gt;&lt;v0&gt;:1024 [Coordinator]
ServerOne  | 10.99.199.24(ServerOne:14401)&lt;v1&gt;:1025</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Currently, we have not defined any Regions in which to store our application&#8217;s data:</p>
</div>
<div class="exampleblock">
<div class="title">Example 209. No Application Regions</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="txt">gfsh&gt;list regions
No Regions Found</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>This is deliberate, since we are going to let the application drive its schema structure, both on the client
(application) as well as on the server-side (cluster). We cover this in more detail later in this chapter.</p>
</div>
</div>
<div class="sect3">
<h4 id="cloudfoundry-geode-cups">23.4.3. Creating a User-Provided Service</h4>
<div class="paragraph">
<p>Now that we have PCF Dev and a small Apache Geode cluster up and running, it is time to create a user-provided service
to the external, standalone Apache Geode cluster that we started in <a href="#cloudfoundry-geode-cluster">step 2</a>.</p>
</div>
<div class="paragraph">
<p>As mentioned, PCF Dev offers MySQL, Redis and RabbitMQ services (among others). However, to use Apache Geode in the same
capacity as you would Pivotal Cloud Cache when running in a production-grade PCF environment, you need to create a user-provided
service for the standalone Apache Geode cluster.</p>
</div>
<div class="paragraph">
<p>To do so, run the following <code>cf</code> CLI command:</p>
</div>
<div class="exampleblock">
<div class="title">Example 210. cf cups command</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="txt">$ cf cups &lt;service-name&gt; -t "gemfire, cloudcache, database, pivotal" -p '&lt;service-credentials-in-json&gt;'</code></pre>
</div>
</div>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
It is important that you specify the tags (<code>gemfire</code>, <code>cloudcache</code>, <code>database</code>, <code>pivotal</code>) exactly as shown
in the preceding <code>cf</code> CLI command.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The argument passed to the <code>-p</code> command-line option is a JSON document (object) containing the credentials for our
user-provided service.</p>
</div>
<div class="paragraph">
<p>The JSON object is as follows:</p>
</div>
<div class="exampleblock">
<div class="title">Example 211. User-Provided Service Crendentials JSON</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="json">{
	"locators": [ "&lt;hostname&gt;[&lt;port&gt;]" ],
	"urls": { "gfsh": "https://&lt;hostname&gt;/gemfire/v1" },
	"users": [{ "password": "&lt;password&gt;", "roles": [ "cluster_operator" ], "username": "&lt;username&gt;" }]
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The complete <code>cf</code> CLI command would be similar to the following:</p>
</div>
<div class="exampleblock">
<div class="title">Example 212. Example <code>cf cups</code> command</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="txt">cf cups apacheGeodeService -t "gemfire, cloudcache, database, pivotal" \
  -p '{ "locators": [ "10.99.199.24[10334]" ], "urls": { "gfsh": "https://10.99.199.24/gemfire/v1" }, "users": [{ "password": "admin", "roles": [ "cluster_operator" ], "username": "admin" }] }'</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>We replaced the <code>&lt;hostname&gt;</code> placeholder with the IP address of our standalone Apache Geode Locator. You can find
the IP address in the Gfsh <code>start locator</code> command output shown in the preceding example.</p>
</div>
<div class="paragraph">
<p>Additionally, the <code>&lt;port&gt;</code> placeholder has been replaced with the default Locator port, <code>10334</code>,</p>
</div>
<div class="paragraph">
<p>Finally, we set the <code>username</code> and <code>password</code> accordingly.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Spring Boot for Apache Geode (SBDG) provides template files in the <code>{docs-dir}/src/main/resources</code> directory.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Once the service has been created, you can query the details of the service from the <code>cf</code> CLI:</p>
</div>
<div class="exampleblock">
<div class="title">Example 213. Query the CF Dev Services</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="txt">$ cf services
Getting services in org cfdev-org / space cfdev-space as admin...

name                 service         plan   bound apps      last operation   broker
apacheGeodeService   user-provided          boot-pcc-demo


$ cf service apacheGeodeService
Showing info of service apacheGeodeService in org cfdev-org / space cfdev-space as admin...

name:      apacheGeodeService
service:   user-provided
tags:      gemfire, cloudcache, database, pivotal

bound apps:
name            binding name   status             message
boot-pcc-demo                  create succeeded</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>You can also view the "apacheGeodeService" from Apps Manager, starting from the <code>Service</code> tab in your org and space:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/pcfdev-appsmanager-org-space-services.png" alt="pcfdev appsmanager org space services">
</div>
</div>
<div class="paragraph">
<p>By clicking on the "apacheGeodeService" service entry in the table, you can get all the service details, such as
the bound apps:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/pcfdev-appsmanager-org-space-service-boundapps.png" alt="pcfdev appsmanager org space service boundapps">
</div>
</div>
<div class="paragraph">
<p>You can also view and set the configuration:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/pcfdev-appsmanager-org-space-service-configuration.png" alt="pcfdev appsmanager org space service configuration">
</div>
</div>
<div class="paragraph">
<p>This brief section did not cover all the capabilities of the Apps Manager. We suggest you explore its UI to see all
that is possible.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
You can learn more about CUPS in the
<a href="https://docs.pivotal.io/platform/application-service/2-11/devguide/services/user-provided.html">PCF documentation</a>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="cloudfoundry-geode-app">23.4.4. Push and Bind a Spring Boot application</h4>
<div class="paragraph">
<p>Now it is time to push a Spring Boot application to PCF Dev and bind the application to the <code>apacheGeodeService</code>.</p>
</div>
<div class="paragraph">
<p>Any Spring Boot <code>ClientCache</code> application that uses SBDG works for this purpose. For this example, we use the
<a href="https://github.com/jxblum/PCCDemo/tree/sbdg-doc-ref">PCCDemo</a> application, which is available in GitHub.</p>
</div>
<div class="paragraph">
<p>After cloning the project to your computer, you must run a build to produce the artifact to push to PCF Dev:</p>
</div>
<div class="exampleblock">
<div class="title">Example 214. Build the PCCDemo application</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="txt">$ mvn clean package</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Then you can push the application to PCF Dev with the following <code>cf</code> CLI command:</p>
</div>
<div class="exampleblock">
<div class="title">Example 215. Push the application to PCF Dev</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="txt">$ cf push boot-pcc-demo -u none --no-start -p target/client-0.0.1-SNAPSHOT.jar</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Once the application has been successfully deployed to PCF Dev, you can get the application details:</p>
</div>
<div class="exampleblock">
<div class="title">Example 216. Get details for the deployed application</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="txt">$ cf apps
Getting apps in org cfdev-org / space cfdev-space as admin...
OK

name            requested state   instances   memory   disk   urls
boot-pcc-demo   stopped           0/1         768M     1G     boot-pcc-demo.dev.cfdev.sh


$ cf app boot-pcc-demo
Showing health and status for app boot-pcc-demo in org cfdev-org / space cfdev-space as admin...

name:              boot-pcc-demo
requested state:   stopped
routes:            boot-pcc-demo.dev.cfdev.sh
last uploaded:     Tue 02 Jul 00:34:09 PDT 2019
stack:             cflinuxfs3
buildpacks:        https://github.com/cloudfoundry/java-buildpack.git

type:           web
instances:      0/1
memory usage:   768M
     state   since                  cpu    memory   disk     details
#0   down    2019-07-02T21:48:25Z   0.0%   0 of 0   0 of 0

type:           task
instances:      0/0
memory usage:   256M

There are no running instances of this process.</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>You can bind the PPCDemo application to the <code>apacheGeodeService</code> using the <code>cf</code> CLI command:</p>
</div>
<div class="exampleblock">
<div class="title">Example 217. Bind application to <code>apacheGeodeService</code> using CLI</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="txt">cf bind-service boot-pcc-demo apacheGeodeService</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Alternatively, you can create a YAML file (<code>manifest.yml</code> in <code>src/main/resources</code>) that contains
the deployment descriptor:</p>
</div>
<div class="exampleblock">
<div class="title">Example 218. Example YAML deployment descriptor</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="yml">\---
applications:
  - name: boot-pcc-demo
    memory: 768M
    instances: 1
    path: ./target/client-0.0.1-SNAPSHOT.jar
    services:
      - apacheGeodeService
    buildpacks:
      - https://github.com/cloudfoundry/java-buildpack.git</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>You can also use Apps Manager to view application details and bind and unbind additional services.
Start by navigating to the <code>App</code> tab under your org and space:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/pcfdev-appsmanager-org-space-apps.png" alt="pcfdev appsmanager org space apps">
</div>
</div>
<div class="paragraph">
<p>From there, you can click on the desired application and navigate to the <code>Overview</code>:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/pcfdev-appsmanager-org-space-app-overview.png" alt="pcfdev appsmanager org space app overview">
</div>
</div>
<div class="paragraph">
<p>You can also review the application <code>Settings</code>. Specifically, we are looking at the configuration of the applicatinon
once it is bound to the <code>apacheGeodeService</code>, as seen in the <code>VCAP_SERVICES</code> environment variable:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/pcfdev-appsmanager-org-space-app-settings-envvars.png" alt="pcfdev appsmanager org space app settings envvars">
</div>
</div>
<div class="paragraph">
<p>This JSON document structure is not unlike the configuration used to bind your Spring Boot <code>ClientCache</code> application
to the Pivotal Cloud Cache service when deploying the same application to Pivotal CloudFoundry. This is actually key if you want to
minimize the amount of boilerplate code and configuration changes when you migrate between different CloudFoundry
environments, even <a href="https://www.cloudfoundry.org/">Open Source CloudFoundry</a>.</p>
</div>
<div class="paragraph">
<p>Again, SBDG&#8217;s goal is to simply the effort for you to build, run, and manage your application, in whatever context
your application lands, even if it changes later. If you follow the steps in this documentation, you can realize
that goal.</p>
</div>
</div>
<div class="sect3">
<h4 id="cloudfoundry-geode-app-run">23.4.5. Running the Spring Boot application</h4>
<div class="paragraph">
<p>All that is left to do now is run the application.</p>
</div>
<div class="paragraph">
<p>You can start the PCCDemo application from the <code>cf</code> CLI by using the following command:</p>
</div>
<div class="exampleblock">
<div class="title">Example 219. Start the Spring Boot application</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="txt">$ cf start boot-pcc-demo</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Alternatively, you can also start the application from Apps Manager. This is convenient, since you can then tail
and monitor the application log file.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/pcfdev-appsmanager-org-space-app-logs.png" alt="pcfdev appsmanager org space app logs">
</div>
</div>
<div class="paragraph">
<p>Once the application has started, you can click the <a href="https://boot-pcc-demo.dev.cfdev.sh/">VIEW APP</a> link
in the upper right corner of the <code>APP</code> screen.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/PCCDemo-app-screenshot.png" alt="PCCDemo app screenshot">
</div>
</div>
<div class="paragraph">
<p>You can navigate to any of the application Web Service, Controller endpoints.  For example, if you know the ISBN
of a book, you can access it from your Web browser:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/PCCDemo-app-book-by-isbn-screenshot.png" alt="PCCDemo app book by isbn screenshot">
</div>
</div>
<div class="paragraph">
<p>You can also access the same data from the Gfsh command-line tool. However, the first thing to observe is that our
application informed the cluster that it needed a Region called <code>Books</code>:</p>
</div>
<div class="exampleblock">
<div class="title">Example 220. Books Region</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="txt">gfsh&gt;list regions
List of regions
---------------
Books


gfsh&gt;describe region --name=/Books
..........................................................
Name            : Books
Data Policy     : partition
Hosting Members : ServerOne

Non-Default Attributes Shared By Hosting Members

 Type  |    Name     | Value
------ | ----------- | ---------
Region | size        | 1
       | data-policy | PARTITION</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The PCCDemo app creates fake data on startup, which we can query in Gfsh:</p>
</div>
<div class="exampleblock">
<div class="title">Example 221. Query Books</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="txt">gfsh&gt;query --query="SELECT book.isbn, book.title FROM /Books book"
Result : true
Limit  : 100
Rows   : 1

    isbn      | title
------------- | ---------------------
1235432BMF342 | The Torment of Others</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="cloudfoundry-geode-summary">23.5. Summary</h3>
<div class="paragraph">
<p>The ability to deploy Spring Boot, Apache Geode <code>ClientCache</code> applications to Pivotal CloudFoundry yet connect your application to
an externally managed, standalone Apache Geode cluster is powerful.</p>
</div>
<div class="paragraph">
<p>Indeed, this is a useful arrangement and stepping stone for many users as they begin their journey towards Cloud-Native
platforms such as Pivotal CloudFoundry and using services such as Pivotal Cloud Cache.</p>
</div>
<div class="paragraph">
<p>Later, when you need to work with real (rather than sample) applications, you can migrate your Spring Boot applications
to a fully managed and production-grade Pivotal CloudFoundry environment, and SBDG figures out what to do, leaving you to focus
entirely on your application.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="geode-docker">24. Docker</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The state of modern software application development is moving towards <a href="https://www.docker.com/resources/what-container">containerization</a>.
Containers offer a controlled environment to predictably build (compile, configure and package), run, and manage your
applications in a reliable and repeatable manner, regardless of context. In many situations, the intrinsic benefit of
using containers is obvious.</p>
</div>
<div class="paragraph">
<p>Understandably, <a href="https://www.docker.com/">Docker&#8217;s</a> popularity took off like wildfire, given its highly powerful and simplified
model for creating, using and managing containers to run packaged applications.</p>
</div>
<div class="paragraph">
<p>Docker&#8217;s ecosystem is also quite impressive, with the advent of <a href="https://www.testcontainers.org">Testcontainers</a> and Spring Boot&#8217;s
now <a href="https://docs.spring.io/spring-boot/docs/current/reference/html/spring-boot-features.html#building-docker-images">dedicated support</a> to create packaged
Spring Boot applications in <a href="https://docs.docker.com/get-started/overview/#docker-objects">Docker images</a> that are then later
run in a Docker container.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
See also <a href="https://docs.spring.io/spring-boot/docs/current/reference/html/deployment.html#containers-deployment">&#8220;Deploying to Containers&#8221;</a> to learn more.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Apache Geode can also run in a controlled, containerized environment. The goal of this chapter is to get you started
running Apache Geode in a container and interfacing to a containerized Apache Geode cluster from your Spring Boot,
Apache Geode client applications.</p>
</div>
<div class="paragraph">
<p>This chapter does not cover how to run your Spring Boot, Apache Geode client applications in a container, since that is
already covered by Spring Boot (again, see the Spring Boot documentation for
<a href="https://docs.spring.io/spring-boot/docs/current/reference/html/spring-boot-features.html#building-docker-images">Docker images</a>
and <a href="https://docs.spring.io/spring-boot/docs/current/reference/html/deployment.html#containers-deployment">container deployment</a>,
along with Docker&#8217;s <a href="https://docs.docker.com/get-started/overview/">documentation</a>).
Instead, our focus is on how to run an Apache Geode cluster in a container and connect to it from a Spring Boot,
Apache Geode client application, regardless of whether the application runs in a container or not.</p>
</div>
<div class="sect2">
<h3 id="geode-docker-image">24.1. Acquiring the Apache Geode Docker Image</h3>
<div class="paragraph">
<p>To run an Apache Geode cluster inside a Docker container, you must first acquire the Docker image. You can get
the Apache Geode Docker image from <a href="https://hub.docker.com/r/apachegeode/geode/">Docker Hub</a>.</p>
</div>
<div class="paragraph">
<p>While Apache Geode&#8217;s <a href="https://geode.apache.org/docs/guide/{apache-geode-doc-version}">official documentation</a> is less than clear on how to use Apache Geode in Docker,
we find a bit of relief in the <a href="https://cwiki.apache.org/confluence/display/GEODE/How+to+use+Geode+on+Docker">Wiki</a>. However, for a complete
and comprehensive write up, see the instructions in
the <a href="https://github.com/markito/geode-docker#building-the-container-image">README</a>
from this <a href="https://github.com/markito/geode-docker">GitHub Repo</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
You must have <a href="https://docs.docker.com/get-docker">Docker</a> installed on your computer to complete the following steps.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Effectively, the high-level steps are as follows:</p>
</div>
<div class="paragraph">
<p>1) Acquire the Apache Geode Docker image from Docker Hub by using the <code>docker pull</code> command (shown with typical output)
from the command-line:</p>
</div>
<div class="exampleblock">
<div class="title">Example 222. Download/Install the Apache Geode Docker Image</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="text">$ docker pull apachegeode/geode
Using default tag: latest
latest: Pulling from apachegeode/geode
Digest: sha256:6a6218f22a2895bb706175727c7d76f654f9162acac22b2d950d09a2649f9cf4
Status: Image is up to date for apachegeode/geode:latest
docker.io/apachegeode/geode:latest</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Instead of pulling from the <code>nightly</code> tag as suggested, the Spring team highly recommends that you pull from
the <code>latest</code> tag, which pulls a stable, production-ready Apache Geode Docker image based on the latest Apache Geode
GA version.</p>
</div>
<div class="paragraph">
<p>2) Verify that the Apache Geode Docker image was downloaded and installed successfully:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="text">$ docker image ls
REPOSITORY                       TAG                          IMAGE ID            CREATED             SIZE
apachegeode/geode                latest                       a2e210950712        2 months ago        224MB
cloudfoundry/run                 base-cnb                     3a7d172559c2        8 weeks ago         71.2MB
open-liberty                     19.0.0.9-webProfile8         dece75feff1a        3 months ago        364MB
tomee                            11-jre-8.0.0-M3-webprofile   0d03e4d395e6        3 months ago        678MB
...</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Now you are ready to run Apache Geode in a Docker container.</p>
</div>
</div>
<div class="sect2">
<h3 id="geode-docker-container">24.2. Running Apache Geode in a Docker Container</h3>
<div class="paragraph">
<p>Now that you have acquired the Apache Geode Docker image, you can run Apache Geode in a Docker container.
Use the following <code>docker run</code> command to start Apache Geode in a Docker container:</p>
</div>
<div class="exampleblock">
<div class="title">Example 223. Start the Apache Geode Docker Container</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="text">$ docker run -it -p 10334:10334 -p 40404:40404 -p 1099:1099 -p 7070:7070 -p 7575:7575 apachegeode/geode
    _________________________     __
   / _____/ ______/ ______/ /____/ /
  / /  __/ /___  /_____  / _____  /
 / /__/ / ____/  _____/ / /    / /
/______/_/      /______/_/    /_/    1.12.0

Monitor and Manage Apache Geode
gfsh&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Since the Apache Geode Docker container was started in interactive mode, you must open a separate command-line shell
to verify that the Apache Geode Docker container is in fact running:</p>
</div>
<div class="exampleblock">
<div class="title">Example 224. Verify the Apache Geode Docker Container is Running</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="text">$ docker container ls
CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS                                                                                                                                  NAMES
3b30b9ffc5dc        apachegeode/geode   "gfsh"              44 seconds ago      Up 43 seconds       0.0.0.0:1099-&gt;1099/tcp, 0.0.0.0:7070-&gt;7070/tcp, 0.0.0.0:7575-&gt;7575/tcp, 0.0.0.0:10334-&gt;10334/tcp, 0.0.0.0:40404-&gt;40404/tcp, 8080/tcp   awesome_khorana</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>You know that the Apache Geode Docker container is running since we ended up at a Gfsh command prompt in
the interactive shell.</p>
</div>
<div class="paragraph">
<p>We also mapped ports between the Docker container and the host system, exposing well-known ports used by Apache Geode
server-side cluster processes, such as Locators and CacheServers:</p>
</div>
<table class="tableblock frame-all grid-all" style="width: 30%;">
<caption class="title">Table 22. Apache Geode Ports</caption>
<colgroup>
<col style="width: 66.6666%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Process</th>
<th class="tableblock halign-left valign-top">Port</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">HTTP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">7070</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Locator</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10334</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Manager</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1099</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Server</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">40404</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>It is unfortunate that the Apache Geode Docker image gives you only a Gfsh command prompt, leaving you with the task of
provisioning a cluster. It would have been more useful to provide preconfigured Docker images with different Apache Geode
cluster configurations, such as one Locator and one server or two Locators and four servers, and so on. However, we can
start the cluster ourselves.</p>
</div>
</div>
<div class="sect2">
<h3 id="geode-docker-cluster">24.3. Start an Apache Geode Cluster in Docker</h3>
<div class="paragraph">
<p>From inside the Apache Geode Docker container, we can start a Locator and a server:</p>
</div>
<div class="exampleblock">
<div class="title">Example 225. Start Apache Geode Locator &amp; Server</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="text">gfsh&gt;start locator --name=LocatorOne --log-level=config --hostname-for-clients=localhost
Starting a Geode Locator in /LocatorOne...
.........
Locator in /LocatorOne on 3b30b9ffc5dc[10334] as LocatorOne is currently online.
Process ID: 167
Uptime: 9 seconds
Geode Version: 1.12.0
Java Version: 1.8.0_212
Log File: /LocatorOne/LocatorOne.log
JVM Arguments: -Dgemfire.enable-cluster-configuration=true -Dgemfire.load-cluster-configuration-from-dir=false -Dgemfire.log-level=config -Dgemfire.launcher.registerSignalHandlers=true -Djava.awt.headless=true -Dsun.rmi.dgc.server.gcInterval=9223372036854775806
Class-Path: /geode/lib/geode-core-1.12.0.jar:/geode/lib/geode-dependencies.jar

Successfully connected to: JMX Manager [host=3b30b9ffc5dc, port=1099]

Cluster configuration service is up and running.


gfsh&gt;start server --name=ServerOne --log-level=config --hostname-for-clients=localhost
Starting a Geode Server in /ServerOne...
.......
Server in /ServerOne on 3b30b9ffc5dc[40404] as ServerOne is currently online.
Process ID: 267
Uptime: 7 seconds
Geode Version: 1.12.0
Java Version: 1.8.0_212
Log File: /ServerOne/ServerOne.log
JVM Arguments: -Dgemfire.default.locators=172.17.0.2[10334] -Dgemfire.start-dev-rest-api=false -Dgemfire.use-cluster-configuration=true -Dgemfire.log-level=config -Dgemfire.launcher.registerSignalHandlers=true -Djava.awt.headless=true -Dsun.rmi.dgc.server.gcInterval=9223372036854775806
Class-Path: /geode/lib/geode-core-1.12.0.jar:/geode/lib/geode-dependencies.jar


gfsh&gt;list members
Member Count : 2

   Name    | Id
---------- | --------------------------------------------------------------
LocatorOne | 172.17.0.2(LocatorOne:167:locator)&lt;ec&gt;&lt;v0&gt;:41000 [Coordinator]
ServerOne  | 172.17.0.2(ServerOne:267)&lt;v1&gt;:41001


gfsh&gt;describe member --name=LocatorOne
Name        : LocatorOne
Id          : 172.17.0.2(LocatorOne:167:locator)&lt;ec&gt;&lt;v0&gt;:41000
Host        : 3b30b9ffc5dc
Regions     :
PID         : 167
Groups      :
Used Heap   : 50M
Max Heap    : 443M
Working Dir : /LocatorOne
Log file    : /LocatorOne/LocatorOne.log
Locators    : 172.17.0.2[10334]


gfsh&gt;describe member --name=ServerOne
Name        : ServerOne
Id          : 172.17.0.2(ServerOne:267)&lt;v1&gt;:41001
Host        : 3b30b9ffc5dc
Regions     :
PID         : 267
Groups      :
Used Heap   : 77M
Max Heap    : 443M
Working Dir : /ServerOne
Log file    : /ServerOne/ServerOne.log
Locators    : 172.17.0.2[10334]

Cache Server Information
Server Bind              :
Server Port              : 40404
Running                  : true

Client Connections : 0</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>We now have an Apache Geode cluster running with one Locator and one server inside a Docker container. We deliberately
started the cluster with a minimal configuration. For example, we have no Regions in which to store data:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="text">gfsh&gt;list regions
No Regions Found</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>However, that is OK. Once more, we want to show the full power of SBDG and let the Spring Boot application drive
the configuration of the Apache Geode cluster that runs in the Docker container, as required by the application.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s have a quick look at our Spring Boot application.</p>
</div>
</div>
<div class="sect2">
<h3 id="geode-docker-application">24.4. Spring Boot, Apache Geode Client Application Explained</h3>
<div class="paragraph">
<p>The Spring Boot, Apache Geode <code>ClientCache</code> application we use to connect to our Apache Geode cluster that runs in
the Docker container appears as follows:</p>
</div>
<div class="exampleblock">
<div class="title">Example 226. Spring Boot, Apache Geode Docker client application</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@SpringBootApplication
@EnableClusterAware
@EnableEntityDefinedRegions(basePackageClasses = Customer.class)
@UseMemberName("SpringBootApacheGeodeDockerClientCacheApplication")
public class SpringBootApacheGeodeDockerClientCacheApplication {

	public static void main(String[] args) {
		SpringApplication.run(SpringBootApacheGeodeDockerClientCacheApplication.class, args);
	}

	@Bean
	@SuppressWarnings("unused")
	ApplicationRunner runner(GemFireCache cache, CustomerRepository customerRepository) {

		return args -&gt; {

			assertClientCacheAndConfigureMappingPdxSerializer(cache);
			assertThat(customerRepository.count()).isEqualTo(0);

			Customer jonDoe = Customer.newCustomer(1L, "Jon Doe");

			log("Saving Customer [%s]...%n", jonDoe);

			jonDoe = customerRepository.save(jonDoe);

			assertThat(jonDoe).isNotNull();
			assertThat(jonDoe.getId()).isEqualTo(1L);
			assertThat(jonDoe.getName()).isEqualTo("Jon Doe");
			assertThat(customerRepository.count()).isEqualTo(1);

			log("Querying for Customer [SELECT * FROM /Customers WHERE name LIKE '%s']...%n", "%Doe");

			Customer queriedJonDoe = customerRepository.findByNameLike("%Doe");

			assertThat(queriedJonDoe).isEqualTo(jonDoe);

			log("Customer was [%s]%n", queriedJonDoe);
		};
	}

	private void assertClientCacheAndConfigureMappingPdxSerializer(GemFireCache cache) {

		assertThat(cache).isNotNull();
		assertThat(cache.getName())
			.isEqualTo(SpringBootApacheGeodeDockerClientCacheApplication.class.getSimpleName());
		assertThat(cache.getPdxSerializer()).isInstanceOf(MappingPdxSerializer.class);

		MappingPdxSerializer serializer = (MappingPdxSerializer) cache.getPdxSerializer();

		serializer.setIncludeTypeFilters(type -&gt; Optional.ofNullable(type)
			.map(Class::getPackage)
			.map(Package::getName)
			.filter(packageName -&gt; packageName.startsWith(this.getClass().getPackage().getName()))
			.isPresent());
	}

	private void log(String message, Object... args) {
		System.err.printf(message, args);
		System.err.flush();
	}
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Our <code>Customer</code> application domain model object type is defined as:</p>
</div>
<div class="exampleblock">
<div class="title">Example 227. <code>Customer</code> class</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Region("Customers")
class Customer {

	@Id
	private Long id;

	private String name;

}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Also, we define a Spring Data CRUD Repository to persist and access <code>Customers</code> stored in the <code>/Customers</code> Region:</p>
</div>
<div class="exampleblock">
<div class="title">Example 228. <code>CustomerRepository</code> interface</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">interface CustomerRepository extends CrudRepository&lt;Customer, Long&gt; {

	Customer findByNameLike(String name);

}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Our main class is annotated with <code>@SpringBootApplication</code>, making it be a proper Spring Boot application.</p>
</div>
<div class="paragraph">
<p>We additionally annotate the main class with SBDG&#8217;s <code>@EnableClusterAware</code> annotation to automatically detect
the Apache Geode cluster that runs in the Docker container and to push cluster configuration metadata from
the application to the cluster as required by the application.</p>
</div>
<div class="paragraph">
<p>Specifically, the application requires that a Region called &#8220;Customers&#8221;, as defined by the <code>@Region</code> mapping
annotation on the <code>Customer</code> application domain model class, exists on the servers in the cluster, to store <code>Customer</code>
data.</p>
</div>
<div class="paragraph">
<p>We use the SDG <code>@EnableEntityDefinedRegions</code> annotation to define the matching client <code>PROXY</code> &#8220;Customers&#8221; Region.</p>
</div>
<div class="paragraph">
<p>Optionally, we have also annotated our main class with SBDG&#8217;s <code>@UseMemberName</code> annotation to give the <code>ClientCache</code>
a name, which we assert in the <code>assertClientCacheAndConfigureMappingPdxSerializer(:ClientCache)</code> method.</p>
</div>
<div class="paragraph">
<p>The primary work performed by this application is done in the Spring Boot <code>ApplicationRunner</code> bean definition. We create
a <code>Customer</code> instance (<code>Jon Doe</code>), save it to the &#8220;Customers&#8221; Region that is managed by the server in the cluster,
and then query for <code>Jon Doe</code> using OQL, asserting that the result is equal to what we expect.</p>
</div>
<div class="paragraph">
<p>We log the output from the application&#8217;s operations to see the application in action.</p>
</div>
</div>
<div class="sect2">
<h3 id="geode-docker-application-run">24.5. Running the Spring Boot, Apache Geode client application</h3>
<div class="paragraph">
<p>When you run the Spring Boot, Apache Geode client application, you should see output similar to the following:</p>
</div>
<div class="exampleblock">
<div class="title">Example 229. Application log output</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="text">/Library/Java/JavaVirtualMachines/jdk1.8.0_241.jdk/Contents/Home/bin/java ...
    org.springframework.geode.docs.example.app.docker.SpringBootApacheGeodeDockerClientCacheApplication

  .   ____          _            __ _ _
 /\\ / ___'_ __ _ _(_)_ __  __ _ \ \ \ \
( ( )\___ | '_ | '_| | '_ \/ _` | \ \ \ \
 \\/  ___)| |_)| | | | | || (_| |  ) ) ) )
  '  |____| .__|_| |_|_| |_\__, | / / / /
 =========|_|==============|___/=/_/_/_/
 :: Spring Boot ::        (v2.3.0.RELEASE)

Saving Customer [Customer(name=Jon Doe)]...
Querying for Customer [SELECT * FROM /Customers WHERE name LIKE '%Doe']...
Customer was [Customer(name=Jon Doe)]

Process finished with exit code 0</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>When we review the configuration of the cluster, we see that the <code>/Customers</code> Region was created when the application
ran:</p>
</div>
<div class="exampleblock">
<div class="title">Example 230. /Customers Region Configuration</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="text">gfsh&gt;list regions
List of regions
---------------
Customers


gfsh&gt;describe region --name=/Customers
Name            : Customers
Data Policy     : partition
Hosting Members : ServerOne

Non-Default Attributes Shared By Hosting Members

 Type  |    Name     | Value
------ | ----------- | ---------
Region | size        | 1
       | data-policy | PARTITION</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Our <code>/Customers</code> Region contains a value (<code>Jon Doe</code>), and we can verify this by running the following OQL Query
with Gfsh:</p>
</div>
<div class="exampleblock">
<div class="title">Example 231. Query the <code>/Customers</code> Region</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="text">gfsh&gt;query --query="SELECT customer.name FROM /Customers customer"
Result : true
Limit  : 100
Rows   : 1

Result
-------
Jon Doe</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Our application ran successfully.</p>
</div>
</div>
<div class="sect2">
<h3 id="geode-docker-application-conclusion">24.6. Conclusion</h3>
<div class="paragraph">
<p>In this chapter, we saw how to connect a Spring Boot, Apache Geode <code>ClientCache</code> application to an Apache Geode cluster
that runs in a Docker container.</p>
</div>
<div class="paragraph">
<p>Later, we provide more information on how to scale up, or rather scale out, our Apache Geode cluster that runs in Docker.
Additionally, we provide details on how you can use Apache Geode&#8217;s Docker image with Testcontainers when you write
integration tests, which formally became part of the Spring Test for Apache Geode (STDG) project.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="geode-samples">25. Samples</h2>
<div class="sectionbody">
<div class="quoteblock">
<blockquote>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
You are viewing Samples for Spring Boot for Apache Geode (SBDG) version {version}.
</td>
</tr>
</table>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>This section contains working examples that show how to use Spring Boot for Apache Geode (SBDG) effectively.</p>
</div>
<div class="paragraph">
<p>Some examples focus on specific use cases (such as (HTTP) session state caching), while other examples show how SBDG
works under the hood, to give you a better understanding of what is actually happening and how to debug problems with
your Spring Boot Apache Geode applications.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 23. Example Spring Boot applications using Apache Geode</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Guide</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Source</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="guides/getting-started.html">Getting Started with Spring Boot for Apache Geode</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Explains how to get started quickly, easily, and reliably building Apache Geode powered applications with Spring Boot.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">{github-samples-url}/intro/getting-started[Getting Started]</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="guides/boot-configuration.html">Spring Boot Auto-Configuration for Apache Geode</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Explains what auto-configuration is provided by SBDG and what the auto-configuration does.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">{github-samples-url}/boot/configuration[Spring Boot Auto-Configuration]</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="guides/boot-actuator.html">Spring Boot Actuator for Apache Geode</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Explains how to use Spring Boot Actuator for Apache Geode and how it works.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">{github-samples-url}/boot/actuator[Spring Boot Actuator]</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="guides/boot-security.html">Spring Boot Security for Apache Geode</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Explains how to configure auth and TLS with SSL when you use Apache Geode in your Spring Boot applications.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">{github-samples-url}/boot/security[Spring Boot Security]</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="guides/caching-look-aside.html">Look-Aside Caching with Spring&#8217;s Cache Abstraction and Apache Geode</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Explains how to enable and use Spring&#8217;s Cache Abstraction with Apache Geode as the caching provider
for look-aside caching.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">{github-samples-url}/caching/look-aside[Look-Aside Caching]</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="guides/caching-inline.html">Inline Caching with Spring&#8217;s Cache Abstraction and Apache Geode</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Explains how to enable and use Spring&#8217;s Cache Abstraction with Apache Geode as the caching provider for inline caching.
This sample builds on the look-aside caching sample.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">{github-samples-url}/caching/inline[Inline Caching]</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="guides/caching-inline-async.html">Asynchronous Inline Caching with Spring&#8217;s Cache Abstraction and Apache Geode</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Explains how to enable and use Spring&#8217;s Cache Abstraction with Apache Geode as the caching provider for asynchronous
inline caching. This sample builds on the look-aside and inline caching samples.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">{github-samples-url}/caching/inline-async[Asynchronous Inline Caching]</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="guides/caching-near.html">Near Caching with Spring&#8217;s Cache Abstraction and Apache Geode</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Explains how to enable and use Spring&#8217;s Cache Abstraction with Apache Geode as the caching provider for near caching.
This sample builds on the look-aside caching sample.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">{github-samples-url}/caching/near[Near Caching]</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="guides/caching-multi-site.html">Multi-Site Caching with Spring&#8217;s Cache Abstraction and Apache Geode</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Explains how to enable and use Spring&#8217;s Cache Abstraction with Apache Geode as the caching provider for multi-site
caching. This sample builds on the look-aside caching sample.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">{github-samples-url}/caching/multi-site[Multi-Site Caching]</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="guides/caching-http-session.html">HTTP Session Caching with Spring Session and Apache Geode</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Explains how to enable and use Spring Session with Apache Geode to manage HTTP session state.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">{github-samples-url}/caching/http-session[HTTP Session Caching]</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="appendix">26. Appendix</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following appendices provide additional help while developing Spring Boot applications backed by Apache Geode:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="#geode-auto-configuration-annotations">Auto-configuration vs. Annotation-based configuration</a></p>
</li>
<li>
<p><a href="#geode-configuration-metadata">Configuration Metadata Reference</a></p>
</li>
<li>
<p><a href="#geode-auto-configuration-disable">Disabling Auto-configuration</a></p>
</li>
<li>
<p><a href="#geode-gemfire-switch">Switching from Apache Geode to VMware Tanzu GemFire or VMware Tanzu GemFire for VMs</a></p>
</li>
<li>
<p><a href="#geode-cluster-configuration-bootstrapping">Running an Apache Geode cluster with Spring Boot from your IDE</a></p>
</li>
<li>
<p><a href="#geode-testing-support">Testing</a></p>
</li>
<li>
<p><a href="#geode-examples">Examples</a></p>
</li>
<li>
<p><a href="#references">References</a></p>
</li>
</ol>
</div>
<div class="sect2">
<h3 id="geode-auto-configuration-annotations">Auto-configuration vs. Annotation-based configuration</h3>
<div class="paragraph">
<p>The question most often asked is, &#8220;What Spring Data for Apache Geode (SDG) annotations can I use, or must I use, when
developing Apache Geode applications with Spring Boot?&#8221;</p>
</div>
<div class="paragraph">
<p>This section answers this question and more.</p>
</div>
<div class="paragraph">
<p>See the complementary sample, <a href="guides/boot-configuration.html">Spring Boot Auto-configuration for Apache Geode</a>,
which shows the auto-configuration provided by Spring Boot for Apache Geode in action.</p>
</div>
<div class="sect3">
<h4 id="geode-autoconfiguration-annotations-background">Background</h4>
<div class="paragraph">
<p>To help answer this question, you must start by reviewing the complete collection of available Spring Data for
Apache Geode (SDG) annotations. These annotations are provided in the
<a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/package-summary.html"><code>org.springframework.data.gemfire.config.annotation</code></a>
package. Most of the essential annotations begin with <code>@Enable&#8230;&#8203;</code>, except for the base annotations:
<code>@ClientCacheApplication</code>, <code>@PeerCacheApplication</code> and <code>@CacheServerApplication</code>.</p>
</div>
<div class="paragraph">
<p>By extension, Spring Boot for Apache Geode (SBDG) builds on SDG&#8217;s annotation-based configuration model to implement
auto-configuration and apply Spring Boot&#8217;s core concepts, such as &#8220;convention over configuration&#8221;, letting
Apache Geode applications be built with Spring Boot reliably, quickly, and easily.</p>
</div>
<div class="paragraph">
<p>SDG provides this annotation-based configuration model to, first and foremost, give application developers &#8220;choice&#8221;
when building Spring applications with Apache Geode. SDG makes no assumptions about what application developers are
trying to create and fails fast anytime the configuration is ambiguous, giving users immediate feedback.</p>
</div>
<div class="paragraph">
<p>Second, SDG&#8217;s annotations were meant to get application developers up and running quickly and reliably with ease. SDG
accomplishes this by applying sensible defaults so that application developers need not know, or even have to learn, all
the intricate configuration details and tooling provided by Apache Geode to accomplish simple tasks, such as building a
prototype.</p>
</div>
<div class="paragraph">
<p>So, SDG is all about &#8220;choice&#8221; and SBDG is all about &#8220;convention&#8221;. Together these frameworks provide application
developers with convenience and ease to move quickly and reliably.</p>
</div>
<div class="paragraph">
<p>To learn more about the motivation behind SDG&#8217;s annotation-based configuration model, see the
<a href="https://docs.spring.io/spring-data/gemfire/docs/current/reference/html/#bootstrap-annotation-config-introduction">Reference Documentation</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="geode-autoconfiguration-annotations-conventions">Conventions</h4>
<div class="paragraph">
<p>Currently, SBDG provides auto-configuration for the following features:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>ClientCache</code></p>
</li>
<li>
<p>Caching with Spring&#8217;s Cache Abstraction</p>
</li>
<li>
<p>Continuous Query</p>
</li>
<li>
<p>Function Execution and Implementation</p>
</li>
<li>
<p>Logging</p>
</li>
<li>
<p>PDX</p>
</li>
<li>
<p><code>GemfireTemplate</code></p>
</li>
<li>
<p>Spring Data Repositories</p>
</li>
<li>
<p>Security (Client/server auth and SSL)</p>
</li>
<li>
<p>Spring Session</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This means the following SDG annotations are not required to use the features above:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>@ClientCacheApplication</code></p>
</li>
<li>
<p><code>@EnableGemfireCaching</code> (or by using Spring Framework&#8217;s <code>@EnableCaching</code> annotation)</p>
</li>
<li>
<p><code>@EnableContinuousQueries</code></p>
</li>
<li>
<p><code>@EnableGemfireFunctionExecutions</code></p>
</li>
<li>
<p><code>@EnableGemfireFunctions</code></p>
</li>
<li>
<p><code>@EnableLogging</code></p>
</li>
<li>
<p><code>@EnablePdx</code></p>
</li>
<li>
<p><code>@EnableGemfireRepositories</code></p>
</li>
<li>
<p><code>@EnableSecurity</code></p>
</li>
<li>
<p><code>@EnableSsl</code></p>
</li>
<li>
<p><code>@EnableGemFireHttpSession</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Since SBDG auto-configures these features for you, the above annotations are not strictly required. Typically, you
would only declare one of these annotations when you want to &#8220;override&#8221; Spring Boot&#8217;s conventions, as expressed in
auto-configuration, and &#8220;customize&#8221; the behavior of the feature.</p>
</div>
</div>
<div class="sect3">
<h4 id="geode-autoconfiguration-annotations-overriding">Overriding</h4>
<div class="paragraph">
<p>In this section, we cover a few examples to make the behavior when overriding more apparent.</p>
</div>
<div class="sect4">
<h5 id="geode-autoconfiguration-annotations-overriding-caches">Caches</h5>
<div class="paragraph">
<p>By default, SBDG provides you with a <code>ClientCache</code> instance. SBDG accomplishes this by annotating an auto-configuration
class with <code>@ClientCacheApplication</code> internally.</p>
</div>
<div class="paragraph">
<p>By convention, we assume most application developers' are developing Spring Boot applications by using Apache Geode
as &#8220;client&#8221; applications in Apache Geode&#8217;s client/server topology. This is especially true as users migrate their
applications to a managed cloud environment.</p>
</div>
<div class="paragraph">
<p>Still, you can &#8220;override&#8221; the default settings (convention) and declare your Spring applications to be actual peer
<code>Cache</code> members (nodes) of a Apache Geode cluster, instead:</p>
</div>
<div class="exampleblock">
<div class="title">Example 232. Spring Boot, Apache Geode Peer <code>Cache</code> Application</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@SpringBootApplication
@CacheServerApplication
class SpringBootApacheGeodePeerCacheServerApplication {  }</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>By declaring the <code>@CacheServerApplication</code> annotation, you effectively override the SBDG default. Therefore, SBDG
does not provide you with a <code>ClientCache</code> instance by default, because you have informed SBDG of exactly what you want:
a peer <code>Cache</code> instance hosting an embedded <code>CacheServer</code> that allows client connections.</p>
</div>
<div class="paragraph">
<p>However, you then might ask, &#8220;Well, how do I customize the <code>ClientCache</code> instance when developing client applications
without explicitly declaring the <code>@ClientCacheApplication</code> annotation?&#8221;</p>
</div>
<div class="paragraph">
<p>First, you can &#8220;customize&#8221; the <code>ClientCache</code> instance by explicitly declaring the <code>@ClientCacheApplication</code> annotation
in your Spring Boot application configuration and setting specific attributes as needed. However, you should be aware
that, by explicitly declaring this annotation, (or, by default, any of the other auto-configured annotations), you
assume all the responsibility that comes with it, since you have effectively overridden the auto-configuration. One
example of this is security, which we touch on more later.</p>
</div>
<div class="paragraph">
<p>The most ideal way to &#8220;customize&#8221; the configuration of any feature is by way of the well-known and documented
<a href="#geode-configuration-metadata">properties</a>, specified in Spring Boot <code>application.properties</code> (the &#8220;convention&#8221;),
or by using a <a href="https://docs.spring.io/spring-data/gemfire/docs/current/reference/html/#bootstrap-annotation-config-configurers"><code>Configurer</code></a>.</p>
</div>
<div class="paragraph">
<p>See the <a href="#geode-clientcache-applications">Reference Guide</a> for more detail.</p>
</div>
</div>
<div class="sect4">
<h5 id="geode-autoconfiguration-annotations-overriding-security">Security</h5>
<div class="paragraph">
<p>As with the <code>@ClientCacheApplication</code> annotation, the <code>@EnableSecurity</code> annotation is not strictly required, unless you
want to override and customize the defaults.</p>
</div>
<div class="paragraph">
<p>Outside a managed environment, the only security configuration required is specifying a username and password. You do
this by using the well-known and documented SDG username and password properties in Spring Boot <code>application.properties</code>:</p>
</div>
<div class="exampleblock">
<div class="title">Example 233. Required Security Properties in a Non-Manage Envionment</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="properties">spring.data.gemfire.security.username=MyUser
spring.data.gemfire.security.password=Secret</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>You need not explicitly declare the <code>@EnableSecurity</code> annotation just to specify security configuration (such as
username and password).</p>
</div>
<div class="paragraph">
<p>Inside a managed environment, such as the VMware Tanzu Application Service (TAS) when using VMware Tanzu GemFire, SBDG is able to introspect
the environment and configure security (auth) completely without the need to specify any configuration, usernames
and passwords, or otherwise. This is due, in part, because TAS supplies the security details in the VCAP environment
when the application is deployed to TAS and bound to services (such as VMware Tanzu GemFire).</p>
</div>
<div class="paragraph">
<p>So, in short, you need not explicitly declare the <code>@EnableSecurity</code> annotation (or <code>@ClientCacheApplication</code>).</p>
</div>
<div class="paragraph">
<p>However, if you do explicitly declare the <code>@ClientCacheApplication</code> or <code>@EnableSecurity</code> annotations, you are now
responsible for this configuration, and SBDG&#8217;s auto-configuration no longer applies.</p>
</div>
<div class="paragraph">
<p>While explicitly declaring <code>@EnableSecurity</code> makes more sense when &#8220;overriding&#8221; the SBDG security auto-configuration,
explicitly declaring the <code>@ClientCacheApplication</code> annotation most likely makes less sense with regard to its impact
on security configuration.</p>
</div>
<div class="paragraph">
<p>This is entirely due to the internals of Apache Geode, because, in certain cases (such as security), not even Spring
is able to completely shield you from the nuances of Apache Geode&#8217;s configuration. No framework can.</p>
</div>
<div class="paragraph">
<p>You must configure both auth and SSL before the cache instance (whether a <code>ClientCache</code> or a peer <code>Cache</code>) is created.
This is because security is enabled and configured during the &#8220;construction&#8221; of the cache. Also,, the cache pulls
the configuration from JVM System properties that must be set before the cache is constructed.</p>
</div>
<div class="paragraph">
<p>Structuring the &#8220;exact&#8221; order of the auto-configuration classes provided by SBDG when the classes are triggered, is no
small feat. Therefore, it should come as no surprise to learn that the security auto-configuration classes in SBDG must
be triggered before the <code>ClientCache</code> auto-configuration class, which is why a <code>ClientCache</code> instance cannot &#8220;auto&#8221;
authenticate properly in PCC when the <code>@ClientCacheApplication</code> is explicitly declared without some assistance. In other
words you must also explicitly declare the <code>@EnableSecurity</code> annotation in this case, since you overrode the
auto-configuration of the cache, and implicitly security, as well.</p>
</div>
<div class="paragraph">
<p>Again, this is due to the way security (auth) and SSL metadata must be supplied to Apache Geode on startup.</p>
</div>
<div class="paragraph">
<p>See the <a href="#geode-security">Reference Guide</a> for more details.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="geode-autoconfiguration-annotations-extension">Extension</h4>
<div class="paragraph">
<p>Most of the time, many of the other auto-configured annotations for CQ, Functions, PDX, Repositories, and so on need not
ever be declared explicitly.</p>
</div>
<div class="paragraph">
<p>Many of these features are enabled automatically by having SBDG or other libraries (such as Spring Session) on
the application classpath or are enabled based on other annotations applied to beans in the Spring <code>ApplicationContext</code>.</p>
</div>
<div class="paragraph">
<p>We review a few examples in the following sections.</p>
</div>
<div class="sect4">
<h5 id="geode-autoconfiguration-annotations-extension-caching">Caching</h5>
<div class="paragraph">
<p>It is rarely, if ever, necessary to explicitly declare either the Spring Framework&#8217;s <code>@EnableCaching</code> or the
SDG-specific <code>@EnableGemfireCaching</code> annotation in Spring configuration when you use SBDG. SBDG automatically
enables caching and configures the SDG <code>GemfireCacheManager</code> for you.</p>
</div>
<div class="paragraph">
<p>You need only focus on which application service components are appropriate for caching:</p>
</div>
<div class="exampleblock">
<div class="title">Example 234. Service Caching</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Service
class CustomerService {

    @Autowired
    private CustomerRepository customerRepository;

    @Cacheable("CustomersByName")
    public Customer findBy(String name) {
        return customerRepository.findByName(name);
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>You need to create Apache Geode Regions that back the caches declared in your application service components
(<code>CustomersByName</code> in the preceding example) by using Spring&#8217;s caching annotations (such as <code>@Cacheable</code>),
or alternatively, JSR-107 JCache annotations (such as <code>@CacheResult</code>).</p>
</div>
<div class="paragraph">
<p>You can do that by defining each Region explicitly or, more conveniently, you can use the following approach:</p>
</div>
<div class="exampleblock">
<div class="title">Example 235. Configuring Caches (Regions)</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@SpringBootApplication
@EnableCachingDefinedRegions
class Application {  }</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p><code>@EnableCachingDefinedRegions</code> is optional, provided for convenience, and complementary to caching when used rather than
being necessary.</p>
</div>
<div class="paragraph">
<p>See the <a href="#geode-caching-provider">Reference Guide</a> for more detail.</p>
</div>
</div>
<div class="sect4">
<h5 id="geode-autoconfiguration-annotations-extension-cq">Continuous Query</h5>
<div class="paragraph">
<p>It is rarely, if ever, necessary to explicitly declare the SDG <code>@EnableContinuousQueries</code> annotation. Instead, you
should focus on defining your application queries and worry less about the plumbing.</p>
</div>
<div class="paragraph">
<p>Consider the following example:</p>
</div>
<div class="exampleblock">
<div class="title">Example 236. Defining Queries for CQ</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Component
public class TemperatureMonitor extends AbstractTemperatureEventPublisher {

	@ContinuousQuery(name = "BoilingTemperatureMonitor",
		query = "SELECT * FROM /TemperatureReadings WHERE temperature.measurement &gt;= 212.0")
	public void boilingTemperatureReadings(CqEvent event) {
		publish(event, temperatureReading -&gt; new BoilingTemperatureEvent(this, temperatureReading));
	}

	@ContinuousQuery(name = "FreezingTemperatureMonitor",
		query = "SELECT * FROM /TemperatureReadings WHERE temperature.measurement &lt;= 32.0")
	public void freezingTemperatureReadings(CqEvent event) {
		publish(event, temperatureReading -&gt; new FreezingTemperatureEvent(this, temperatureReading));
	}
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Apache Geode CQ applies only to clients.</p>
</div>
<div class="paragraph">
<p>See the <a href="#geode-continuous-query">Reference Guide</a> for more detail.</p>
</div>
</div>
<div class="sect4">
<h5 id="geode-autoconfiguration-annotations-extension-functions">Functions</h5>
<div class="paragraph">
<p>You rarely, if ever, need to explicitly declare either the <code>@EnableGemfireFunctionExecutions</code>
or <code>@EnableGemfireFunctions</code> annotations. SBDG provides auto-configuration for both Function implementations
and executions.</p>
</div>
<div class="paragraph">
<p>You need to define the implementation:</p>
</div>
<div class="exampleblock">
<div class="title">Example 237. Function Implementation</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@Component
class GeodeFunctions {

    @GemfireFunction
    Object exampleFunction(Object arg) {
        // ...
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Then you need to define the execution:</p>
</div>
<div class="exampleblock">
<div class="title">Example 238. Function Execution</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@OnRegion(region = "Example")
interface GeodeFunctionExecutions {

    Object exampleFunction(Object arg);

}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>SBDG automatically finds, configures, and registers Function implementations (POJOs) in Apache Geode as proper
<code>Functions</code> and creates execution proxies for the interfaces, which can then be injected into application service
components to invoke the registered <code>Functions</code> without needing to explicitly declare the enabling annotations.
The application Function implementations (POJOs) and executions (interfaces) should exist below
the <code>@SpringBootApplication</code> annotated main class.</p>
</div>
<div class="paragraph">
<p>See the <a href="#geode-functions">Reference Guide</a> for more detail.</p>
</div>
</div>
<div class="sect4">
<h5 id="geode-autoconfiguration-annotations-extension-pdx">PDX</h5>
<div class="paragraph">
<p>You rarely, if ever, need to explicitly declare the <code>@EnablePdx</code> annotation, since SBDG auto-configures PDX by default.
SBDG also automatically configures the SDG <code>MappingPdxSerializer</code> as the default <code>PdxSerializer</code>.</p>
</div>
<div class="paragraph">
<p>It is easy to customize the PDX configuration by setting the appropriate <a href="#geode-configuration-metadata">properties</a>
(search for &#8220;PDX&#8221;) in Spring Boot <code>application.properties</code>.</p>
</div>
<div class="paragraph">
<p>See the <a href="#geode-data-serialization">Reference Guide</a> for more detail.</p>
</div>
</div>
<div class="sect4">
<h5 id="geode-autoconfiguration-annotations-extension-repositories">Spring Data Repositories</h5>
<div class="paragraph">
<p>You rarely, if ever, need to explicitly declare the <code>@EnableGemfireRepositories</code> annotation, since SBDG auto-configures
Spring Data (SD) Repositories by default.</p>
</div>
<div class="paragraph">
<p>You need only define your Repositories:</p>
</div>
<div class="exampleblock">
<div class="title">Example 239. Customer&#8217;s Repository</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">interface CustomerRepository extends CrudRepository&lt;Customer, Long&gt; {

    Customer findByName(String name);

}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>SBDG finds the Repository interfaces defined in your application, proxies them, and registers them as beans in
the Spring <code>ApplicationContext</code>. The Repositories can be injected into other application service components.</p>
</div>
<div class="paragraph">
<p>It is sometimes convenient to use the <code>@EnableEntityDefinedRegions</code> along with Spring Data Repositories to identify
the entities used by your application and define the Regions used by the Spring Data Repository infrastructure to
persist the entity&#8217;s state. The <code>@EnableEntityDefinedRegions</code> annotation is optional, provided for convenience,
and complementary to the <code>@EnableGemfireRepositories</code> annotation.</p>
</div>
<div class="paragraph">
<p>See the <a href="#geode-repositories">Reference Guide</a> for more detail.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="geode-autoconfiguration-annotations-explicit">Explicit Configuration</h4>
<div class="paragraph">
<p>Most of the other annotations provided in SDG are focused on particular application concerns or enable certain
Apache Geode features, rather than being a necessity, including:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>@EnableAutoRegionLookup</code></p>
</li>
<li>
<p><code>@EnableBeanFactoryLocator</code></p>
</li>
<li>
<p><code>@EnableCacheServer(s)</code></p>
</li>
<li>
<p><code>@EnableCachingDefinedRegions</code></p>
</li>
<li>
<p><code>@EnableClusterConfiguration</code></p>
</li>
<li>
<p><code>@EnableClusterDefinedRegions</code></p>
</li>
<li>
<p><code>@EnableCompression</code></p>
</li>
<li>
<p><code>@EnableDiskStore(s)</code></p>
</li>
<li>
<p><code>@EnableEntityDefinedRegions</code></p>
</li>
<li>
<p><code>@EnableEviction</code></p>
</li>
<li>
<p><code>@EnableExpiration</code></p>
</li>
<li>
<p><code>@EnableGatewayReceiver</code></p>
</li>
<li>
<p><code>@EnableGatewaySender(s)</code></p>
</li>
<li>
<p><code>@EnableGemFireAsLastResource</code></p>
</li>
<li>
<p><code>@EnableHttpService</code></p>
</li>
<li>
<p><code>@EnableIndexing</code></p>
</li>
<li>
<p><code>@EnableOffHeap</code></p>
</li>
<li>
<p><code>@EnableLocator</code></p>
</li>
<li>
<p><code>@EnableManager</code></p>
</li>
<li>
<p><code>@EnableMemcachedServer</code></p>
</li>
<li>
<p><code>@EnablePool(s)</code></p>
</li>
<li>
<p><code>@EnableRedisServer</code></p>
</li>
<li>
<p><code>@EnableStatistics</code></p>
</li>
<li>
<p><code>@UseGemFireProperties</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>None of these annotations are necessary and none are auto-configured by SBDG. They are at your disposal when and if you
need them. This also means that none of these annotations are in conflict with any SBDG auto-configuration.</p>
</div>
</div>
<div class="sect3">
<h4 id="geode-autoconfiguration-annotations-summary">Summary</h4>
<div class="paragraph">
<p>In conclusion, you need to understand where SDG ends and SBDG begins. It all begins with the auto-configuration
provided by SBDG.</p>
</div>
<div class="paragraph">
<p>If a feature or function is not covered by SBDG&#8217;s auto-configuration, you are responsible for enabling and configuring
the feature appropriately, as needed by your application (for example, <code>@EnableRedisServer</code>).</p>
</div>
<div class="paragraph">
<p>In other cases, you might also want to explicitly declare a complimentary annotation
(such as <code>@EnableEntityDefinedRegions</code>) for convenience, since SBDG provides no convention or opinion.</p>
</div>
<div class="paragraph">
<p>In all remaining cases, it boils down to understanding how Apache Geode works under the hood. While we go to great
lengths to shield you from as many details as possible, it is not feasible or practical to address all matters, such as
cache creation and security.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="geode-configuration-metadata">Configuration Metadata Reference</h3>
<div class="paragraph">
<p>The following reference sections cover documented and well-known properties recognized and processed by
Spring Data for Apache Geode (SDG) and Spring Session for Apache Geode (SSDG).</p>
</div>
<div class="paragraph">
<p>These properties may be used in Spring Boot <code>application.properties</code> or as JVM System properties, to configure different
aspects of or enable individual features of Apache Geode in a Spring application. When combined with the power of
Spring Boot, they give you the ability to quickly create an application that uses Apache Geode.</p>
</div>
<div class="sect3">
<h4 id="geode-configuration-metadata-springdata">Spring Data Based Properties</h4>
<div class="paragraph">
<p>The following properties all have a <code>spring.data.gemfire.*</code> prefix. For example, to set the cache <code>copy-on-read</code>
property, use <code>spring.data.gemfire.cache.copy-on-read</code> in Spring Boot <code>application.properties</code>.</p>
</div>
<table class="tableblock frame-all grid-all" style="width: 90%;">
<caption class="title">Table 24. <code>spring.data.gemfire.*</code> properties</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">From</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the Apache Geode.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SpringBasedCacheClientApplication</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/ClientCacheApplication.html#name--"><code>ClientCacheApplication.name</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>locators</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Comma-delimited list of Locator endpoints formatted as: <code>locator1[port1],&#8230;&#8203;,locatorN[portN]</code>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/PeerCacheApplication.html#locators--"><code>PeerCacheApplication.locators</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>use-bean-factory-locator</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enable the SDG <code>BeanFactoryLocator</code> when mixing Spring config with Apache Geode native config (such as <code>cache.xml</code>) and you wish to configure Apache Geode objects declared in <code>cache.xml</code> with Spring.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/ClientCacheApplication.html#useBeanFactoryLocator--"><code>ClientCacheApplication.useBeanFactoryLocator</code></a></p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all" style="width: 90%;">
<caption class="title">Table 25. <code>spring.data.gemfire.*</code> <em>GemFireCache</em> properties</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">From</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cache.copy-on-read</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Configure whether a copy of an object returned from <code>Region.get(key)</code> is made.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/ClientCacheApplication.html#copyOnRead--"><code>ClientCacheApplication.copyOnRead</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cache.critical-heap-percentage</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Percentage of heap at or above which the cache is considered in danger of becoming inoperable.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/ClientCacheApplication.html#criticalHeapPercentage--"><code>ClientCacheApplication.criticalHeapPercentage</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cache.critical-off-heap-percentage</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Percentage of off-heap at or above which the cache is considered in danger of becoming inoperable.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/ClientCacheApplication.html#criticalOffHeapPercentage--"><code>ClientCacheApplication.criticalOffHeapPercentage</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cache.enable-auto-region-lookup</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether to lookup Regions configured in Apache Geode native configuration and declare them as Spring beans.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnableAutoRegionLookup.html#enabled--"><code>EnableAutoRegionLookup.enable</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cache.eviction-heap-percentage</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Percentage of heap at or above which the eviction should begin on Regions configured for HeapLRU eviction.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/ClientCacheApplication.html#evictionHeapPercentage--"><code>ClientCacheApplication.evictionHeapPercentage</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cache.eviction-off-heap-percentage</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Percentage of off-heap at or above which the eviction should begin on Regions configured for HeapLRU eviction.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/ClientCacheApplication.html#evictionOffHeapPercentage--"><code>ClientCacheApplication.evictionOffHeapPercentage</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cache.log-level</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Configure the log-level of an Apache Geode cache.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>config</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/ClientCacheApplication.html#logLevel--"><code>ClientCacheApplication.logLevel</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cache.name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Alias for <code>spring.data.gemfire.name</code>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SpringBasedCacheClientApplication</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/ClientCacheApplication.html#name--"><code>ClientCacheApplication.name</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cache.compression.bean-name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of a Spring bean that implements <code>org.apache.geode.compression.Compressor</code>.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnableCompression.html#compressorBeanName--"><code>EnableCompression.compressorBeanName</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cache.compression.region-names</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Comma-delimited list of Region names for which compression is configured.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>[]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnableCompression.html#RegionNames--">EnableCompression.RegionNames</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">cache.off-heap.memory-size</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Determines the size of off-heap memory used by Apache Geode in megabytes (m) or gigabytes (g)&#8201;&#8212;&#8201;for example, <code>120g</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnableOffHeap.html#memorySize--"><code>EnableOffHeap.memorySize</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cache.off-heap.region-names</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Comma-delimited list of Region names for which off-heap is configured.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>[]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnableOffHeap.html#RegionNames--"><code>EnableOffHeap.RegionNames</code></a></p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all" style="width: 90%;">
<caption class="title">Table 26. <code>spring.data.gemfire.*</code> <em>ClientCache</em> properties</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">From</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cache.client.durable-client-id</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Used only for clients in a client/server installation. If set, this indicates that the client is durable and identifies the client. The ID is used by servers to reestablish any messaging that was interrupted by client downtime.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/ClientCacheApplication.html#durableClientId--"><code>ClientCacheApplication.durableClientId</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cache.client.durable-client-timeout</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Used only for clients in a client/server installation. Number of seconds this client can remain disconnected from its server and have the server continue to accumulate durable events for it.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>300</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/ClientCacheApplication.html#durableClientTimeout--"><code>ClientCacheApplication.durableClientTimeout</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cache.client.keep-alive</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether the server should keep the durable client&#8217;s queues alive for the timeout period.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/ClientCacheApplication.html#keepAlive--"><code>ClientCacheApplication.keepAlive</code></a></p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all" style="width: 90%;">
<caption class="title">Table 27. <code>spring.data.gemfire.*</code> peer <em>Cache</em> properties</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">From</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cache.peer.enable-auto-reconnect</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether a member (a Locator or Server) try to reconnect and reinitialize the cache after it has been forced out of the cluster by a network partition event or has otherwise been shunned by other members.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/PeerCacheApplication.html#enableAutoReconnect--"><code>PeerCacheApplication.enableAutoReconnect</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cache.peer.lock-lease</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The length, in seconds, of distributed lock leases obtained by this cache.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>120</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/PeerCacheApplication.html#lockLease--"><code>PeerCacheApplication.lockLease</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cache.peer.lock-timeout</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of seconds a cache operation waits to obtain a distributed lock lease.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>60</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/PeerCacheApplication.html#lockTimeout--"><code>PeerCacheApplication.lockTimeout</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cache.peer.message-sync-interval</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The frequency (in seconds) at which a message is sent by the primary cache-server to all the secondary cache-server nodes to remove the events that have already been dispatched from the queue.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/PeerCacheApplication.html#messageSyncInterval--"><code>PeerCacheApplication.messageSyncInterval</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cache.peer.search-timeout</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of seconds a cache get operation can spend searching for a value.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>300</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/PeerCacheApplication.html#searchTimeout--"><code>PeerCacheApplication.searchTimeout</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cache.peer.use-cluster-configuration</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether this cache member node pulls its configuration metadata from the cluster-based cluster configuration service.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/PeerCacheApplication.html#useClusterConfiguration--"><code>PeerCacheApplication.useClusterConfiguration</code></a></p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all" style="width: 90%;">
<caption class="title">Table 28. <code>spring.data.gemfire.*</code> <em>CacheServer</em> properties</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">From</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cache.server.auto-startup</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether the <code>CacheServer</code> should be started automatically at runtime.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/CacheServerApplication.html#autoStartup--"><code>CacheServerApplication.autoStartup</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cache.server.bind-address</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The IP address or hostname on which this cache server listens.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/CacheServerApplication.html#bindAddress--"><code>CacheServerApplication.bindAddress</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cache.server.hostname-for-clients</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The IP address or hostname that server locators tell to clients to indicate the IP address on which the cache server listens.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/CacheServerApplication.html#hostnameForClients--"><code>CacheServerApplication.hostNameForClients</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cache.server.load-poll-interval</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The frequency in milliseconds at which to poll the load probe on this cache server.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>5000</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/CacheServerApplication.html#loadPollInterval--"><code>CacheServerApplication.loadPollInterval</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cache.server.max-connections</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The maximum client connections.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>800</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/CacheServerApplication.html#maxConnections--"><code>CacheServerApplication.maxConnections</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cache.server.max-message-count</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The maximum number of messages that can be in a client queue.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>230000</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/CacheServerApplication.html#maxMessageCount--"><code>CacheServerApplication.maxMessageCount</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cache.server.max-threads</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The maximum number of threads allowed in this cache server to service client requests.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/CacheServerApplication.html#maxThreads--"><code>CacheServerApplication.maxThreads</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cache.server.max-time-between-pings</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The maximum amount of time between client pings.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>60000</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/CacheServerApplication.html#maxTimeBetweenPings--"><code>CacheServerApplication.maxTimeBetweenPings</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cache.server.message-time-to-live</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The time (in seconds) after which a message in the client queue expires.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>180</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/CacheServerApplication.html#messageTimeToLive--"><code>CacheServerApplication.messageTimeToLive</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cache.server.port</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The port on which this cache server listens for clients.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>40404</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/CacheServerApplication.html#port--"><code>CacheServerApplication.port</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cache.server.socket-buffer-size</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The buffer size of the socket connection to this <code>CacheServer</code>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>32768</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/CacheServerApplication.html#socketBufferSize--"><code>CacheServerApplication.socketBufferSize</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cache.server.subscription-capacity</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The capacity of the client queue.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/CacheServerApplication.html#subscriptionCapacity--"><code>CacheServerApplication.subscriptionCapacity</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cache.server.subscription-disk-store-name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the disk store for client subscription queue overflow.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/CacheServerApplication.html#subscriptionDiskStoreName--"><code>CacheServerApplication.subscriptionDiskStoreName</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cache.server.subscription-eviction-policy</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The eviction policy that is executed when the capacity of the client subscription queue is reached.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>none</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/CacheServerApplication.html#subscriptionEvictionPolicy--"><code>CacheServerApplication.subscriptionEvictionPolicy</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cache.server.tcp-no-delay</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The outgoing socket connection tcp-no-delay setting.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/CacheServerApplication.html#tcpNoDelay--"><code>CacheServerApplication.tcpNoDelay</code></a></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><code>CacheServer</code> properties can be further targeted at specific <code>CacheServer</code> instances by using an optional bean name
of the <code>CacheServer</code> bean defined in the Spring <code>ApplicationContext</code>. Consider the following example:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="properties">spring.data.gemfire.cache.server.[&lt;cacheServerBeanName&gt;].bind-address=...</code></pre>
</div>
</div>
</div>
</div>
<table class="tableblock frame-all grid-all" style="width: 90%;">
<caption class="title">Table 29. <code>spring.data.gemfire.*</code> Cluster properties</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">From</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cluster.Region.type</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the data management policy used when creating Regions on the servers in the cluster.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://geode.apache.org/releases/latest/javadoc/org/apache/geode/cache/RegionShortcut.html#PARTITION"><code>RegionShortcut.PARTITION</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnableClusterConfiguration.html#serverRegionShortcut--"><code>EnableClusterConfiguration.serverRegionShortcut</code></a></p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all" style="width: 90%;">
<caption class="title">Table 30. <code>spring.data.gemfire.*</code> <em>DiskStore</em> properties</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">From</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>disk.store.allow-force-compaction</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether to allow <code>DiskStore.forceCompaction()</code> to be called on Regions that use a disk store.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnableDiskStore.html#allowForceCompaction--"><code>EnableDiskStore.allowForceCompaction</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>disk.store.auto-compact</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether to cause the disk files to be automatically compacted.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnableDiskStore.html#autoCompact--"><code>EnableDiskStore.autoCompact</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>disk.store.compaction-threshold</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The threshold at which an oplog becomes compactible.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>50</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnableDiskStore.html#compactionThreshold--"><code>EnableDiskStore.compactionThreshold</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>disk.store.directory.location</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The system directory where the <code>DiskStore</code> (oplog) files are stored.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>[]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnableDiskStore.html#diskDirectories--"><code>EnableDiskStore.diskDirectories.location</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>disk.store.directory.size</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The amount of disk space allowed to store disk store (oplog) files.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>21474883647</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnableDiskStore.html#diskDirectories--"><code>EnableDiskStore.diskDirectories.size</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>disk.store.disk-usage-critical-percentage</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The critical threshold for disk usage as a percentage of the total disk volume.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>99.0</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnableDiskStore.html#diskUsageCriticalPercentage--"><code>EnableDiskStore.diskUsageCriticalPercentage</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>disk.store.disk-usage-warning-percentage</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The warning threshold for disk usage as a percentage of the total disk volume.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>90.0</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnableDiskStore.html#diskUsageWarningPercentage--"><code>EnableDiskStore.diskUsageWarningPercentage</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>disk.store.max-oplog-size</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The maximum size (in megabytes) a single oplog (operation log) can be.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1024</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnableDiskStore.html#maxOplogSize--"><code>EnableDiskStore.maxOplogSize</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>disk.store.queue-size</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The maximum number of operations that can be asynchronously queued.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnableDiskStore.html#queueSize--"><code>EnableDiskStore.queueSize</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>disk.store.time-interval</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of milliseconds that can elapse before data written asynchronously is flushed to disk.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1000</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnableDiskStore.html#timeInterval--"><code>EnableDiskStore.timeInterval</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>disk.store.write-buffer-size</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Configures the write buffer size in bytes.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>32768</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnableDiskStore.html#writeBufferSize--"><code>EnableDiskStore.writeBufferSize</code></a></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><code>DiskStore</code> properties can be further targeted at specific <code>DiskStore</code> instances by setting the
<a href="https://geode.apache.org/releases/latest/javadoc/org/apache/geode/cache/DiskStore.html#getName--"><code>DiskStore.name</code></a> property.</p>
</div>
<div class="paragraph">
<p>For example, you can specify directory location of the files for a specific, named <code>DiskStore</code> by using:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="properties">spring.data.gemfire.disk.store.Example.directory.location=/path/to/geode/disk-stores/Example/</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The directory location and size of the <code>DiskStore</code> files can be further divided into multiple locations and size
using array syntax:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="properties">spring.data.gemfire.disk.store.Example.directory[0].location=/path/to/geode/disk-stores/Example/one
spring.data.gemfire.disk.store.Example.directory[0].size=4096000
spring.data.gemfire.disk.store.Example.directory[1].location=/path/to/geode/disk-stores/Example/two
spring.data.gemfire.disk.store.Example.directory[1].size=8192000</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Both the name and array index are optional, and you can use any combination of name and array index. Without a name,
the properties apply to all <code>DiskStore</code> instances. Without array indexes, all named <code>DiskStore</code> files are stored in
the specified location and limited to the defined size.</p>
</div>
<table class="tableblock frame-all grid-all" style="width: 90%;">
<caption class="title">Table 31. <code>spring.data.gemfire.*</code> Entity properties</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">From</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>entities.base-packages</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Comma-delimited list of package names indicating the start points for the entity scan.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnableEntityDefinedRegions.html#basePackages--"><code>EnableEntityDefinedRegions.basePackages</code></a></p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all" style="width: 90%;">
<caption class="title">Table 32. <code>spring.data.gemfire.*</code> Locator properties</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">From</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>locator.host</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The IP address or hostname of the system NIC to which the embedded Locator is bound to listen for connections.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnableLocator.html#host--"><code>EnableLocator.host</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">locator.port</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The network port to which the embedded Locator will listen for connections.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>10334</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnableLocator.html#port--"><code>EnableLocator.port</code></a></p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all" style="width: 90%;">
<caption class="title">Table 33. <code>spring.data.gemfire.*</code> Logging properties</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">From</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>logging.level</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The log level of an Apache Geode cache. Alias for 'spring.data.gemfire.cache.log-level'.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>config</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnableLogging.html#logLevel--"><code>EnableLogging.logLevel</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>logging.log-disk-space-limit</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The amount of disk space allowed to store log files.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnableLogging.html#logDiskSpaceLimit--"><code>EnableLogging.logDiskSpaceLimit</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>logging.log-file</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The pathname of the log file used to log messages.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnableLogging.html#logFile--"><code>EnableLogging.logFile</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>logging.log-file-size</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The maximum size of a log file before the log file is rolled.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnableLogging.html#logFileSizeLimit--"><code>EnableLogging.logFileSize</code></a></p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all" style="width: 90%;">
<caption class="title">Table 34. <code>spring.data.gemfire.*</code> Management properties</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">From</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>management.use-http</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether to use the HTTP protocol to communicate with an Apache Geode Manager.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnableClusterConfiguration.html#useHttp--"><code>EnableClusterConfiguration.useHttp</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>management.http.host</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The IP address or hostname of the Apache Geode Manager that runs the HTTP service.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnableClusterConfiguration.html#host--"><code>EnableClusterConfiguration.host</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>management.http.port</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The port used by the Apache Geode Manager&#8217;s HTTP service to listen for connections.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>7070</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnableClusterConfiguration.html#port--"><code>EnableClusterConfiguration.port</code></a></p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all" style="width: 90%;">
<caption class="title">Table 35. <code>spring.data.gemfire.*</code> Manager properties</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">From</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>manager.access-file</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The access control list (ACL) file used by the Manager to restrict access to the JMX MBeans by the clients.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnableManager.html#accessFile--"><code>EnableManager.accessFile</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">manager.bind-address</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The IP address or hostname of the system NIC used by the Manager to bind and listen for JMX client connections.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnableManager.html#bindAddress--"><code>EnableManager.bindAddress</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>manager.hostname-for-clients</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The hostname given to JMX clients to ask the Locator for the location of the Manager.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnableManager.html#hostnameForClients--"><code>EnableManager.hostNameForClients</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>manager.password-file</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">By default, the JMX Manager lets clients without credentials connect. If this property is set to the name of a file, only clients that connect with credentials that match an entry in this file are allowed.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnableManager.html#passwordFile--"><code>EnableManager.passwordFile</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>manager.port</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The port used by the Manager to listen for JMX client connections.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1099</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnableManager.html#port--"><code>EnableManager.port</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>manager.start</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether to start the Manager service at runtime.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnableManager.html#start--"><code>EnableManager.start</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>manager.update-rate</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The rate, in milliseconds, at which this member pushes updates to any JMX Managers.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>2000</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnableManager.html#updateRate--"><code>EnableManager.updateRate</code></a></p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all" style="width: 90%;">
<caption class="title">Table 36. <code>spring.data.gemfire.*</code> PDX properties</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">From</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>pdx.disk-store-name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the <code>DiskStore</code> used to store PDX type metadata to disk when PDX is persistent.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnablePdx.html#diskStoreName--"><code>EnablePdx.diskStoreName</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>pdx.ignore-unread-fields</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether PDX ignores fields that were unread during deserialization.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnablePdx.html#ignoreUnreadFields--"><code>EnablePdx.ignoreUnreadFields</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>pdx.persistent</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether PDX persists type metadata to disk.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnablePdx.html#persistent--"><code>EnablePdx.persistent</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>pdx.read-serialized</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether a Region entry is returned as a <code>PdxInstance</code> or deserialized back into object form on read.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnablePdx.html#readSerialized--"><code>EnablePdx.readSerialized</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>pdx.serialize-bean-name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of a custom Spring bean that implements <code>org.apache.geode.pdx.PdxSerializer</code>.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnablePdx.html#serializerBeanName--"><code>EnablePdx.serializerBeanName</code></a></p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all" style="width: 90%;">
<caption class="title">Table 37. <code>spring.data.gemfire.*</code> Pool properties</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">From</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>pool.free-connection-timeout</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The timeout used to acquire a free connection from a Pool.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>10000</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnablePool.html#freeConnectionTimeout--"><code>EnablePool.freeConnectionTimeout</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>pool.idle-timeout</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The amount of time a connection can be idle before expiring (and closing) the connection.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>5000</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnablePool.html#idleTimeout--"><code>EnablePool.idleTimeout</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>pool.load-conditioning-interval</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The interval for how frequently the Pool checks to see if a connection to a given server should be moved to a different server to improve the load balance.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>300000</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnablePool.html#loadConditioningInterval--"><code>EnablePool.loadConditioningInterval</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>pool.locators</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Comma-delimited list of locator endpoints in the format of <code>locator1[port1],&#8230;&#8203;,locatorN[portN]</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnablePool.html#locators--"><code>EnablePool.locators</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>pool.max-connections</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The maximum number of client to server connections that a Pool will create.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnablePool.html#maxConnections--">EnablePool.maxConnections</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>pool.min-connections</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The minimum number of client to server connections that a Pool maintains.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnablePool.html#minConnections--"><code>EnablePool.minConnections</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>pool.multi-user-authentication</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether the created Pool can be used by multiple authenticated users.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnablePool.html#multiUserAuthentication--"><code>EnablePool.multiUserAuthentication</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>pool.ping-interval</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">How often to ping servers to verify that they are still alive.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>10000</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnablePool.html#pingInterval--"><code>EnablePool.pingInterval</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>pool.pr-single-hop-enabled</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether to perform single-hop data access operations between the client and servers. When <code>true</code>, the client is aware of the location of partitions on servers that host Regions with <code>DataPolicy.PARTITION</code>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnablePool.html#prSingleHopEnabled--"><code>EnablePool.prSingleHopEnabled</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>pool.read-timeout</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of milliseconds to wait for a response from a server before timing out the operation and trying another server (if any are available).</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>10000</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnablePool.html#readTimeout--"><code>EnablePool.readTimeout</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>pool.ready-for-events</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether to signal the server that the client is prepared and ready to receive events.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/ClientCacheApplication.html#readyForEvents--"><code>ClientCacheApplication.readyForEvents</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>pool.retry-attempts</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of times to retry a request after timeout/exception.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnablePool.html#retryAttempts--"><code>EnablePool.retryAttempts</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>pool.server-group</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The group that all servers to which a Pool connects must belong.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnablePool.html#serverGroup--"><code>EnablePool.serverGroup</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>pool.servers</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Comma-delimited list of <code>CacheServer</code> endpoints in the format of <code>server1[port1],&#8230;&#8203;,serverN[portN]</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnablePool.html#servers--"><code>EnablePool.servers</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>pool.socket-buffer-size</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The socket buffer size for each connection made in all Pools.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>32768</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnablePool.html#socketBufferSize--"><code>EnablePool.socketBufferSize</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>pool.statistic-interval</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">How often to send client statistics to the server.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnablePool.html#statisticInterval--"><code>EnablePool.statisticInterval</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">pool.subscription-ack-interval</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The interval in milliseconds to wait before sending acknowledgements to the <code>CacheServer</code> for events received from the server subscriptions.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>100</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnablePool.html#subscriptionAckInterval--"><code>EnablePool.subscriptionAckInterval</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>pool.subscription-enabled</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether the created Pool has server-to-client subscriptions enabled.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnablePool.html#subscriptionEnabled--"><code>EnablePool.subscriptionEnabled</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>pool.subscription-message-tracking-timeout</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The <code>messageTrackingTimeout</code> attribute, which is the time-to-live period, in milliseconds, for subscription events the client has received from the server.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>900000</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnablePool.html#subscriptionMessageTrackingTimeout--"><code>EnablePool.subscriptionMessageTrackingTimeout</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>pool.subscription-redundancy</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The redundancy level for all Pools server-to-client subscriptions.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnablePool.html#subscriptionRedundancy--"><code>EnablePool.subsriptionRedundancy</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>pool.thread-local-connections</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The thread local connections policy for all Pools.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnablePool.html#threadLocalConnections--"><code>EnablePool.threadLocalConnections</code></a></p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all" style="width: 90%;">
<caption class="title">Table 38. <code>spring.data.gemfire.*</code> Security properties</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">From</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>security.username</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the user used to authenticate with the servers.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnableSecurity.html#securityUsername--"><code>EnableSecurity.securityUsername</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>security.password</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The user password used to authenticate with the servers.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnableSecurity.html#securityPassword--"><code>EnableSecurity.securityPassword</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>security.properties-file</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The system pathname to a properties file that contains security credentials.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnableAuth.html#securityPropertiesFile--"><code>EnableAuth.propertiesFile</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>security.client.accessor</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnableAuth.html#clientAccessor--"><code>EnableAuth.clientAccessor</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>security.client.accessor-post-processor</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The callback that should be invoked in the post-operation phase, which is when the operation has completed on the server but before the result is sent to the client.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnableAuth.html#clientAccessorPostProcessor--"><code>EnableAuth.clientAccessorPostProcessor</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>security.client.authentication-initializer</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Static creation method that returns an <code>AuthInitialize</code> object, which obtains credentials for peers in a cluster.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnableSecurity.html#clientAuthenticationInitializer--"><code>EnableSecurity.clientAuthentiationInitializer</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>security.client.authenticator</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Static creation method that returns an <code>Authenticator</code> object used by a cluster member (Locator or Server) to verify the credentials of a connecting client.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnableAuth.html#clientAuthenticator--"><code>EnableAuth.clientAuthenticator</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>security.client.diffie-hellman-algorithm</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Used for authentication. For secure transmission of sensitive credentials (such as passwords), you can encrypt the credentials by using the Diffie-Hellman key-exchange algorithm. You can do so by setting the <code>security-client-dhalgo</code> system property on the clients to the name of a valid, symmetric key cipher supported by the JDK.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnableAuth.html#clientDiffieHellmanAlgorithm--"><code>EnableAuth.clientDiffieHellmanAlgorithm</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>security.log.file</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The pathname to a log file used for security log messages.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnableAuth.html#securityLogFile--"><code>EnableAuth.securityLogFile</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>security.log.level</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The log level for security log messages.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnableAuth.html#securityLogLevel--"><code>EnableAuth.securityLogLevel</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>security.manager.class-name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of a class that implements <code>org.apache.geode.security.SecurityManager</code>.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnableSecurity.html#securityManagerClassName--"><code>EnableSecurity.securityManagerClassName</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>security.peer.authentication-initializer</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Static creation method that returns an <code>AuthInitialize</code> object, which obtains credentials for peers in a cluster.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnableSecurity.html#peerAuthenticationInitializer--"><code>EnableSecurity.peerAuthenticationInitializer</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>security.peer.authenticator</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Static creation method that returns an <code>Authenticator</code> object, which is used by a peer to verify the credentials of a connecting node.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnableAuth.html#peerAuthenticator--"><code>EnableAuth.peerAuthenticator</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">security.peer.verify-member-timeout</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The timeout in milliseconds used by a peer to verify membership of an unknown authenticated peer requesting a secure connection.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnableAuth.html#peerVerifyMemberTimeout--"><code>EnableAuth.peerVerifyMemberTimeout</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>security.post-processor.class-name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of a class that implements the <code>org.apache.geode.security.PostProcessor</code> interface that can be used to change the returned results of Region get operations.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnableSecurity.html#securityPostProcessorClassName--"><code>EnableSecurity.securityPostProcessorClassName</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>security.shiro.ini-resource-path</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The Apache Geode System property that refers to the location of an Apache Shiro INI file that configures the Apache Shiro Security Framework in order to secure Apache Geode.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnableSecurity.html#shiroIniResourcePath--"><code>EnableSecurity.shiroIniResourcePath</code></a></p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all" style="width: 90%;">
<caption class="title">Table 39. <code>spring.data.gemfire.*</code> SSL properties</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">From</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>security.ssl.certificate.alias.cluster</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The alias to the stored SSL certificate used by the cluster to secure communications.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnableSsl.html#componentCertificateAliases--"><code>EnableSsl.componentCertificateAliases</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>security.ssl.certificate.alias.default-alias</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The default alias to the stored SSL certificate used to secure communications across the entire Apache Geode system.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnableSsl.html#defaultCertificateAlias--"><code>EnableSsl.defaultCertificateAlias</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>security.ssl.certificate.alias.gateway</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The alias to the stored SSL certificate used by the WAN Gateway Senders/Receivers to secure communications.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnableSsl.html#componentCertificateAliases--"><code>EnableSsl.componentCertificateAliases</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>security.ssl.certificate.alias.jmx</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The alias to the stored SSL certificate used by the Manager&#8217;s JMX-based JVM MBeanServer and JMX clients to secure communications.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnableSsl.html#componentCertificateAliases--"><code>EnableSsl.componentCertificateAliases</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>security.ssl.certificate.alias.locator</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The alias to the stored SSL certificate used by the Locator to secure communications.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnableSsl.html#componentCertificateAliases--"><code>EnableSsl.componentCertificateAliases</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>security.ssl.certificate.alias.server</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The alias to the stored SSL certificate used by clients and servers to secure communications.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnableSsl.html#componentCertificateAliases--"><code>EnableSsl.componentCertificateAliases</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>security.ssl.certificate.alias.web</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The alias to the stored SSL certificate used by the embedded HTTP server to secure communications (HTTPS).</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnableSsl.html#componentCertificateAliases--"><code>EnableSsl.componentCertificateAliases</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>security.ssl.ciphers</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Comma-separated list of SSL ciphers or <code>any</code>.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnableSsl.html#ciphers--"><code>EnableSsl.ciphers</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>security.ssl.components</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Comma-delimited list of Apache Geode components (for example, WAN) to be configured for SSL communication.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnableSsl.html#components--"><code>EnableSsl.components</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>security.ssl.keystore</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The system pathname to the Java KeyStore file storing certificates for SSL.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnableSsl.html#keystore--"><code>EnableSsl.keystore</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>security.ssl.keystore.password</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The password used to access the Java KeyStore file.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnableSsl.html#keystorePassword--"><code>EnableSsl.keystorePassword</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>security.ssl.keystore.type</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The password used to access the Java KeyStore file (for example, JKS).</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnableSsl.html#keystoreType--"><code>EnableSsl.keystoreType</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>security.ssl.protocols</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Comma-separated list of SSL protocols or <code>any</code>.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnableSsl.html#protocols--"><code>EnableSsl.protocols</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>security.ssl.require-authentication</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether two-way authentication is required.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnableSsl.html#requireAuthentication--"><code>EnableSsl.requireAuthentication</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>security.ssl.truststore</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The system pathname to the trust store (Java KeyStore file) that stores certificates for SSL.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnableSsl.html#truststore--"><code>EnableSsl.truststore</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>security.ssl.truststore.password</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The password used to access the trust store (Java KeyStore file).</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnableSsl.html#truststorePassword--"><code>EnableSsl.truststorePassword</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>security.ssl.truststore.type</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The password used to access the trust store (Java KeyStore file&#8201;&#8212;&#8201;for example, JKS).</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnableSsl.html#truststoreType--"><code>EnableSsl.truststoreType</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>security.ssl.web-require-authentication</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether two-way HTTP authentication is required.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnableSsl.html#webRequireAuthentication--"><code>EnableSsl.webRequireAuthentication</code></a></p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all" style="width: 90%;">
<caption class="title">Table 40. <code>spring.data.gemfire.*</code> Service properties</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">From</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>service.http.bind-address</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The IP address or hostname of the system NIC used by the embedded HTTP server to bind and listen for HTTP(S) connections.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnableHttpService.html#bindAddress--"><code>EnableHttpService.bindAddress</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>service.http.port</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The port used by the embedded HTTP server to listen for HTTP(S) connections.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>7070</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnableHttpService.html#port--"><code>EnableHttpService.port</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>service.http.ssl-require-authentication</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether two-way HTTP authentication is required.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnableHttpService.html#sslRequireAuthentication--"><code>EnableHttpService.sslRequireAuthentication</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>service.http.dev-rest-api-start</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether to start the Developer REST API web service. A full installation of Apache Geode is required, and you must set the <code>$GEODE</code> environment variable.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnableHttpService.html#startDeveloperRestApi--"><code>EnableHttpService.startDeveloperRestApi</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>service.memcached.port</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The port of the embedded Memcached server (service).</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>11211</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnableMemcachedServer.html#port--"><code>EnableMemcachedServer.port</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>service.memcached.protocol</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The protocol used by the embedded Memcached server (service).</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ASCII</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnableMemcachedServer.html#protocol--"><code>EnableMemcachedServer.protocol</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>service.redis.bind-address</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The IP address or hostname of the system NIC used by the embedded Redis server to bind and listen for connections.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnableRedisServer.html#bindAddress--"><code>EnableRedis.bindAddress</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>service.redis.port</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The port used by the embedded Redis server to listen for connections.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>6479</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/EnableRedisServer.html#port--"><code>EnableRedisServer.port</code></a></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="geode-configuration-metadata-springsession">Spring Session Based Properties</h4>
<div class="paragraph">
<p>The following properties all have a <code>spring.session.data.gemfire.*</code> prefix. For example, to set the session Region name,
set <code>spring.session.data.gemfire.session.region.name</code> in Spring Boot <code>application.properties</code>.</p>
</div>
<table class="tableblock frame-all grid-all" style="width: 90%;">
<caption class="title">Table 41. <code>spring.session.data.gemfire.*</code> properties</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">From</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cache.client.pool.name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the pool used to send data access operations between the client and servers.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>gemfirePool</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/autorepo/docs/spring-session-data-geode-build/{spring-session-data-geode-version}/api/org/springframework/session/data/gemfire/config/annotation/web/http/EnableGemFireHttpSession.html#poolName--"><code>EnableGemFireHttpSession.poolName</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cache.client.Region.shortcut</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The <code>DataPolicy</code> used by the client Region to manage (HTTP) session state.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://geode.apache.org/releases/latest/javadoc/org/apache/geode/cache/client/ClientRegionShortcut.html#PROXY"><code>ClientRegionShortcut.PROXY</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/autorepo/docs/spring-session-data-geode-build/{spring-session-data-geode-version}/api/org/springframework/session/data/gemfire/config/annotation/web/http/EnableGemFireHttpSession.html#clientRegionShortcut--"><code>EnableGemFireHttpSession.clientRegionShortcut</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cache.server.Region.shortcut</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The <code>DataPolicy</code> used by the server Region to manage (HTTP) session state.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://geode.apache.org/releases/latest/javadoc/org/apache/geode/cache/RegionShortcut.html#PARTITION"><code>RegionShortcut.PARTITION</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/autorepo/docs/spring-session-data-geode-build/{spring-session-data-geode-version}/api/org/springframework/session/data/gemfire/config/annotation/web/http/EnableGemFireHttpSession.html#serverRegionShortcut--"><code>EnableGemFireHttpSession.serverRegionShortcut</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>session.attributes.indexable</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The names of session attributes for which an Index is created.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>[]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/autorepo/docs/spring-session-data-geode-build/{spring-session-data-geode-version}/api/org/springframework/session/data/gemfire/config/annotation/web/http/EnableGemFireHttpSession.html#indexableSessionAttributes--"><code>EnableGemFireHttpSession.indexableSessionAttributes</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>session.expiration.max-inactive-interval-seconds</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Configures the number of seconds in which a session can remain inactive before it expires.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1800</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/autorepo/docs/spring-session-data-geode-build/{spring-session-data-geode-version}/api/org/springframework/session/data/gemfire/config/annotation/web/http/EnableGemFireHttpSession.html#maxInactiveIntervalSeconds--"><code>EnableGemFireHttpSession.maxInactiveIntervalSeconds</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>session.Region.name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the (client/server) Region used to manage (HTTP) session state.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ClusteredSpringSessions</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/autorepo/docs/spring-session-data-geode-build/{spring-session-data-geode-version}/api/org/springframework/session/data/gemfire/config/annotation/web/http/EnableGemFireHttpSession.html#RegionName--"><code>EnableGemFireHttpSession.RegionName</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>session.serializer.bean-name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of a Spring bean that implements <code>org.springframework.session.data.gemfire.serialization.SessionSerializer</code>.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/autorepo/docs/spring-session-data-geode-build/{spring-session-data-geode-version}/api/org/springframework/session/data/gemfire/config/annotation/web/http/EnableGemFireHttpSession.html#sessionSerializerBeanName--"><code>EnableGemFireHttpSession.sessionSerializerBeanName</code></a></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="geode-configuration-metadata-apachegeode">Apache Geode Properties</h4>
<div class="paragraph">
<p>While we do not recommend using Apache Geode properties directly in your Spring applications, SBDG does not prevent you
from doing so. See the <a href="https://geode.apache.org/docs/guide/{apache-geode-doc-version}/reference/topics/gemfire_properties.html">complete reference to the Apache Geode specific properties</a>.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Apache Geode is very strict about the properties that may be specified in a <code>gemfire.properties</code> file.
You cannot mix Spring properties with <code>gemfire.*</code> properties in an Apache Geode <code>gemfire.properties</code> file.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="geode-auto-configuration-disable">Disabling Auto-configuration</h3>
<div class="paragraph">
<p>If you would like to disable the auto-configuration of any feature provided by Spring Boot for Apache Geode, you
can specify the auto-configuration class in the <code>exclude</code> attribute of the <code>@SpringBootApplication</code> annotation:</p>
</div>
<div class="exampleblock">
<div class="title">Example 240. Disable Auto-configuration of PDX</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@SpringBootApplication(exclude = PdxSerializationAutoConfiguration.class)
public class MySpringBootApplication {

  public static void main(String[] args) {
    SpringApplication.run(MySpringBootApplication.class, args);
  }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>You can disable more than one auto-configuration class at a time by specifying each class in the <code>exclude</code> attribute
using array syntax:</p>
</div>
<div class="exampleblock">
<div class="title">Example 241. Disable Auto-configuration of PDX &amp; SSL</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@SpringBootApplication(exclude = { PdxSerializationAutoConfiguration.class, SslAutoConfiguration.class })
public class MySpringBootApplication {

  public static void main(String[] args) {
    SpringApplication.run(MySpringBootApplication.class, args);
  }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="geode-auto-configuration-disable-classes">Complete Set of Auto-configuration Classes</h4>
<div class="paragraph">
<p>The current set of auto-configuration classes in Spring Boot for Apache Geode includes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CacheNameAutoConfiguration</code></p>
</li>
<li>
<p><code>CachingProviderAutoConfiguration</code></p>
</li>
<li>
<p><code>ClientCacheAutoConfiguration</code></p>
</li>
<li>
<p><code>ClientSecurityAutoConfiguration</code></p>
</li>
<li>
<p><code>ContinuousQueryAutoConfiguration</code></p>
</li>
<li>
<p><code>FunctionExecutionAutoConfiguration</code></p>
</li>
<li>
<p><code>GemFirePropertiesAutoConfiguration</code></p>
</li>
<li>
<p><code>LoggingAutoConfiguration</code></p>
</li>
<li>
<p><code>PdxSerializationAutoConfiguration</code></p>
</li>
<li>
<p><code>PeerSecurityAutoConfiguration</code></p>
</li>
<li>
<p><code>RegionTemplateAutoConfiguration</code></p>
</li>
<li>
<p><code>RepositoriesAutoConfiguration</code></p>
</li>
<li>
<p><code>SpringSessionAutoConfiguration</code></p>
</li>
<li>
<p><code>SpringSessionPropertiesAutoConfiguration</code></p>
</li>
<li>
<p><code>SslAutoConfiguration</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="geode-gemfire-switch">Switching from Apache Geode to VMware Tanzu GemFire or VMware Tanzu GemFire for VMs</h3>
<div class="paragraph">
<p>Spring Boot for Apache Geode (SBDG) stopped providing support for VMware Tanzu GemFire after SBDG 1.3. SBDG 1.3 was
the last version to support both Apache Geode and VMware Tanzu GemFire. If you need support for VMware Tanzu GemFire
in Spring Boot, then you will need to downgrade to SBDG 1.3.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
This section is now deprecated. Spring Boot for Apache Geode (SBDG) no longer provides the
<code>spring-gemfire-starter</code> or related starter modules. As of SBDG 1.4, SBDG is based on Apache Geode 1.13. Standalone
GemFire bits based on Apache Geode are no longer being released by VMware, Inc. after GemFire 9.10. GemFire 9.10
was based on Apache Geode 1.12, and SBDG can no longer properly support standalone GemFire bits (version &#8656; 9.10).
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
What was Pivotal GemFire has now been rebranded as <a href="https://pivotal.io/pivotal-gemfire">VMware Tanzu GemFire</a>
and what was Pivotal Cloud Cache (PCC) running on Pivotal CloudFoundry (PCF) has been rebranded as
<a href="https://pivotal.io/pivotal-cloud-cache">VMware Tanzu GemFire for VMs</a> and <a href="https://pivotal.io/platform">VMware Tanzu Application Service (TAS) (TAS)</a>,
respectively.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="geode-cluster-configuration-bootstrapping">Running an Apache Geode cluster with Spring Boot from your IDE</h3>
<div class="paragraph">
<p>As described in <a href="#geode-clientcache-applications">Building <code>ClientCache</code> Applications</a>, you can configure and run a small Apache Geode cluster from inside
your IDE using Spring Boot. This is extremely helpful during development because it enables you to manually run, test,
and debug your applications quickly and easily.</p>
</div>
<div class="paragraph">
<p>Spring Boot for Apache Geode includes such a class:</p>
</div>
<div class="exampleblock">
<div class="title">Example 242. Spring Boot application class used to configure and bootstrap an Apache Geode server</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">@SpringBootApplication
@CacheServerApplication(name = "SpringBootApacheGeodeCacheServerApplication")
@SuppressWarnings("unused")
public class SpringBootApacheGeodeCacheServerApplication {

	public static void main(String[] args) {

		new SpringApplicationBuilder(SpringBootApacheGeodeCacheServerApplication.class)
			.web(WebApplicationType.NONE)
			.build()
			.run(args);
	}

	@Configuration
	@UseLocators
	@Profile("clustered")
	static class ClusteredConfiguration { }

	@Configuration
	@EnableLocator
	@EnableManager(start = true)
	@Profile("!clustered")
	static class LonerConfiguration { }

}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>This class is a proper Spring Boot application that you can use to configure and bootstrap multiple Apache Geode servers
and join them together to form a small cluster. You only need to modify the runtime configuration of this class
to startup multiple servers.</p>
</div>
<div class="paragraph">
<p>Initially, you will need to start a single (primary) server with an embedded Locator and Manager.</p>
</div>
<div class="paragraph">
<p>The Locator enables members in the cluster to locate one another and lets new members join the cluster as a peer.
The Locator also lets clients connect to the servers in the cluster. When the cache client&#8217;s connection pool
is configured to use Locators, the pool of connections can intelligently route data requests directly to the server
hosting the data (a.k.a. single-hop access), especially when the data is partitioned/sharded across multiple servers
in the cluster. Locator-based connection pools include support for load balancing connections and handling automatic
fail-over in the event of failed connections, among other things.</p>
</div>
<div class="paragraph">
<p>The Manager lets you connect to this server using Gfsh (Apache Geode&#8217;s
<a href="https://geode.apache.org/docs/guide/{apache-geode-doc-version}/tools_modules/gfsh/chapter_overview.html">command-line shell tool</a>).</p>
</div>
<div class="paragraph">
<p>To start your primary server, create a run configuration in your IDE for the <code>SpringBootApacheGeodeCacheServerApplication</code>
class using the following, recommended JRE command-line options:</p>
</div>
<div class="exampleblock">
<div class="title">Example 243. Server 1 run profile configuration</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="txt">-server -ea -Dspring.profiles.active=</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Run the class. You should see output similar to the following:</p>
</div>
<div class="exampleblock">
<div class="title">Example 244. Server 1 output on startup</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="txt">/Library/Java/JavaVirtualMachines/jdk1.8.0_152.jdk/Contents/Home/bin/java -server -ea -Dspring.profiles.active= "-javaagent:/Applications/IntelliJ IDEA 17 CE.app/Contents/lib/idea_rt.jar=62866:/Applications/IntelliJ IDEA 17 CE.app/Contents/bin" -Dfile.encoding=UTF-8 -classpath /Library/Java/JavaVirtualMachines/jdk1.8.0_152.jdk/Contents/Home/jre/lib/charsets.jar:/Library/Java/JavaVirtualMachines/jdk1.8.0_152.jdk/Contents/Home/jre/lib/deploy.jar:/Library/Java/JavaVirtualMachines/jdk1.8.0_152.jdk/Contents/Home/jre/lib/ext/cldrdata.jar:/Library/Java/JavaVirtualMachines/jdk1.8.0_152.jdk/Contents/Home/jre/lib/ext/dnsns.jar:/Library/Java/JavaVirtualMachines/jdk1.8.0_152.jdk/Contents/Home/jre/lib/ext/jaccess.jar:/Library/Java/JavaVirtualMachines/jdk1.8.0_152.jdk/Contents/Home/jre/lib/ext/jfxrt.jar:/Library/Java/JavaVirtualMachines/jdk1.8.0_152.jdk/Contents/Home/jre/lib/ext/localedata.jar:/Library/Java/JavaVirtualMachines/jdk1.8.0_152.jdk/Contents/Home/jre/lib/ext/nashorn.jar:/Library/Java/JavaVirtualMachines/jdk1.8.0_152.jdk/Contents/Home/jre/lib/ext/sunec.jar:/Library/Java/JavaVirtualMachines/jdk1.8.0_152.jdk/Contents/Home/jre/lib/ext/sunjce_provider.jar:/Library/Java/JavaVirtualMachines/jdk1.8.0_152.jdk/Contents/Home/jre/lib/ext/sunpkcs11.jar:/Library/Java/JavaVirtualMachines/jdk1.8.0_152.jdk/Contents/Home/jre/lib/ext/zipfs.jar:/Library/Java/JavaVirtualMachines/jdk1.8.0_152.jdk/Contents/Home/jre/lib/javaws.jar:/Library/Java/JavaVirtualMachines/jdk1.8.0_152.jdk/Contents/Home/jre/lib/jce.jar:/Library/Java/JavaVirtualMachines/jdk1.8.0_152.jdk/Contents/Home/jre/lib/jfr.jar:/Library/Java/JavaVirtualMachines/jdk1.8.0_152.jdk/Contents/Home/jre/lib/jfxswt.jar:/Library/Java/JavaVirtualMachines/jdk1.8.0_152.jdk/Contents/Home/jre/lib/jsse.jar:/Library/Java/JavaVirtualMachines/jdk1.8.0_152.jdk/Contents/Home/jre/lib/management-agent.jar:/Library/Java/JavaVirtualMachines/jdk1.8.0_152.jdk/Contents/Home/jre/lib/plugin.jar:/Library/Java/JavaVirtualMachines/jdk1.8.0_152.jdk/Contents/Home/jre/lib/resources.jar:/Library/Java/JavaVirtualMachines/jdk1.8.0_152.jdk/Contents/Home/jre/lib/rt.jar:/Library/Java/JavaVirtualMachines/jdk1.8.0_152.jdk/Contents/Home/lib/ant-javafx.jar:/Library/Java/JavaVirtualMachines/jdk1.8.0_152.jdk/Contents/Home/lib/dt.jar:/Library/Java/JavaVirtualMachines/jdk1.8.0_152.jdk/Contents/Home/lib/javafx-mx.jar:/Library/Java/JavaVirtualMachines/jdk1.8.0_152.jdk/Contents/Home/lib/jconsole.jar:/Library/Java/JavaVirtualMachines/jdk1.8.0_152.jdk/Contents/Home/lib/packager.jar:/Library/Java/JavaVirtualMachines/jdk1.8.0_152.jdk/Contents/Home/lib/sa-jdi.jar:/Library/Java/JavaVirtualMachines/jdk1.8.0_152.jdk/Contents/Home/lib/tools.jar:/Users/jblum/pivdev/spring-boot-data-geode/spring-geode-docs/build/classes/main:/Users/jblum/pivdev/spring-boot-data-geode/spring-geode-docs/build/resources/main:/Users/jblum/pivdev/spring-boot-data-geode/spring-geode-autoconfigure/build/classes/main:/Users/jblum/pivdev/spring-boot-data-geode/spring-geode-autoconfigure/build/resources/main:/Users/jblum/pivdev/spring-boot-data-geode/spring-geode/build/classes/main:/Users/jblum/.gradle/caches/modules-2/files-2.1/org.springframework.boot/spring-boot-starter/2.0.3.RELEASE/ffaa050dbd36b0441645598f1a7ddaf67fd5e678/spring-boot-starter-2.0.3.RELEASE.jar:/Users/jblum/.gradle/caches/modules-2/files-2.1/org.springframework.boot/spring-boot-autoconfigure/2.0.3.RELEASE/11bc4cc96b08fabad2b3186755818fa0b32d83f/spring-boot-autoconfigure-2.0.3.RELEASE.jar:/Users/jblum/.gradle/caches/modules-2/files-2.1/org.springframework.boot/spring-boot/2.0.3.RELEASE/b874870d915adbc3dd932e19077d3d45c8e54aa0/spring-boot-2.0.3.RELEASE.jar:/Users/jblum/.gradle/caches/modules-2/files-2.1/javax.annotation/javax.annotation-api/1.3.2/934c04d3cfef185a8008e7bf34331b79730a9d43/javax.annotation-api-1.3.2.jar:/Users/jblum/.gradle/caches/modules-2/files-2.1/org.springframework.data/spring-data-geode/2.0.8.RELEASE/9e0a3cd2805306d355c77537aea07c281fc581b/spring-data-geode-2.0.8.RELEASE.jar:/Users/jblum/.gradle/caches/modules-2/files-2.1/org.springframework/spring-context-support/5.0.7.RELEASE/e8ee4902d9d8bfbb21bc5e8f30cfbb4324adb4f3/spring-context-support-5.0.7.RELEASE.jar:/Users/jblum/.gradle/caches/modules-2/files-2.1/org.springframework/spring-context/5.0.7.RELEASE/243a23f8968de8754d8199d669780d683ab177bd/spring-context-5.0.7.RELEASE.jar:/Users/jblum/.gradle/caches/modules-2/files-2.1/org.springframework/spring-tx/5.0.7.RELEASE/4ca59b21c61162adb146ad1b40c30b60d8dc42b8/spring-tx-5.0.7.RELEASE.jar:/Users/jblum/.gradle/caches/modules-2/files-2.1/org.springframework/spring-web/5.0.7.RELEASE/2e04c6c2922fbfa06b5948be14a5782db168b6ec/spring-web-5.0.7.RELEASE.jar:/Users/jblum/.gradle/caches/modules-2/files-2.1/org.springframework.data/spring-data-commons/2.0.8.RELEASE/5c19af63b5acb0eab39066684e813d5ecd9d03b7/spring-data-commons-2.0.8.RELEASE.jar:/Users/jblum/.gradle/caches/modules-2/files-2.1/org.springframework/spring-aop/5.0.7.RELEASE/fdd0b6aa3c9c7a188c3bfbf6dfd8d40e843be9ef/spring-aop-5.0.7.RELEASE.jar:/Users/jblum/.gradle/caches/modules-2/files-2.1/org.springframework/spring-beans/5.0.7.RELEASE/c1196cb3e56da83e3c3a02ef323699f4b05feedc/spring-beans-5.0.7.RELEASE.jar:/Users/jblum/.gradle/caches/modules-2/files-2.1/org.springframework/spring-expression/5.0.7.RELEASE/ca01fb473f53dd0ee3c85663b26d5dc325602057/spring-expression-5.0.7.RELEASE.jar:/Users/jblum/.gradle/caches/modules-2/files-2.1/org.springframework/spring-core/5.0.7.RELEASE/54b731178d81e66eca9623df772ff32718208137/spring-core-5.0.7.RELEASE.jar:/Users/jblum/.gradle/caches/modules-2/files-2.1/org.yaml/snakeyaml/1.19/2d998d3d674b172a588e54ab619854d073f555b5/snakeyaml-1.19.jar:/Users/jblum/.gradle/caches/modules-2/files-2.1/org.springframework/spring-jcl/5.0.7.RELEASE/699016ddf454c2c167d9f84ae5777eccadf54728/spring-jcl-5.0.7.RELEASE.jar:/Users/jblum/.gradle/caches/modules-2/files-2.1/org.apache.geode/geode-lucene/1.2.1/3d22a050bd4eb64bd8c82a74677f45c070f102d5/geode-lucene-1.2.1.jar:/Users/jblum/.gradle/caches/modules-2/files-2.1/org.apache.geode/geode-core/1.2.1/fe853317e33dd2a1c291f29cee3c4be549f75a69/geode-core-1.2.1.jar:/Users/jblum/.gradle/caches/modules-2/files-2.1/org.apache.geode/geode-cq/1.2.1/69873d6b956ba13b55c894a13e72106fb552e840/geode-cq-1.2.1.jar:/Users/jblum/.gradle/caches/modules-2/files-2.1/org.apache.geode/geode-wan/1.2.1/df0dd8516e1af17790185255ff21a54b56d94344/geode-wan-1.2.1.jar:/Users/jblum/.gradle/caches/modules-2/files-2.1/antlr/antlr/2.7.7/83cd2cd674a217ade95a4bb83a8a14f351f48bd0/antlr-2.7.7.jar:/Users/jblum/.gradle/caches/modules-2/files-2.1/org.apache.shiro/shiro-spring/1.3.2/281a6b565f6cf3aebd31ddb004632008d7106f2d/shiro-spring-1.3.2.jar:/Users/jblum/.gradle/caches/modules-2/files-2.1/org.aspectj/aspectjweaver/1.8.13/ad94df2a28d658a40dc27bbaff6a1ce5fbf04e9b/aspectjweaver-1.8.13.jar:/Users/jblum/.gradle/caches/modules-2/files-2.1/com.fasterxml.jackson.core/jackson-databind/2.9.6/cfa4f316351a91bfd95cb0644c6a2c95f52db1fc/jackson-databind-2.9.6.jar:/Users/jblum/.gradle/caches/modules-2/files-2.1/com.fasterxml.jackson.core/jackson-annotations/2.9.0/7c10d545325e3a6e72e06381afe469fd40eb701/jackson-annotations-2.9.0.jar:/Users/jblum/.gradle/caches/modules-2/files-2.1/org.apache.shiro/shiro-web/1.3.2/725be023e1c65a0fd70c01b8c0c13a2936c23315/shiro-web-1.3.2.jar:/Users/jblum/.gradle/caches/modules-2/files-2.1/org.apache.shiro/shiro-core/1.3.2/b5dede9d890f335998a8ebf479809fe365b927fc/shiro-core-1.3.2.jar:/Users/jblum/.gradle/caches/modules-2/files-2.1/org.slf4j/slf4j-api/1.7.25/da76ca59f6a57ee3102f8f9bd9cee742973efa8a/slf4j-api-1.7.25.jar:/Users/jblum/.gradle/caches/modules-2/files-2.1/com.github.stephenc.findbugs/findbugs-annotations/1.3.9-1/a6b11447635d80757d64b355bed3c00786d86801/findbugs-annotations-1.3.9-1.jar:/Users/jblum/.gradle/caches/modules-2/files-2.1/org.jgroups/jgroups/3.6.10.Final/fc0ff5a8a9de27ab62939956f705c2909bf86bc2/jgroups-3.6.10.Final.jar:/Users/jblum/.gradle/caches/modules-2/files-2.1/commons-io/commons-io/2.5/2852e6e05fbb95076fc091f6d1780f1f8fe35e0f/commons-io-2.5.jar:/Users/jblum/.gradle/caches/modules-2/files-2.1/commons-lang/commons-lang/2.6/ce1edb914c94ebc388f086c6827e8bdeec71ac2/commons-lang-2.6.jar:/Users/jblum/.gradle/caches/modules-2/files-2.1/it.unimi.dsi/fastutil/7.1.0/9835253257524c1be7ab50c057aa2d418fb72082/fastutil-7.1.0.jar:/Users/jblum/.gradle/caches/modules-2/files-2.1/javax.resource/javax.resource-api/1.7/ae40e0864eb1e92c48bf82a2a3399cbbf523fb79/javax.resource-api-1.7.jar:/Users/jblum/.gradle/caches/modules-2/files-2.1/net.java.dev.jna/jna/4.5.1/65bd0cacc9c79a21c6ed8e9f588577cd3c2f85b9/jna-4.5.1.jar:/Users/jblum/.gradle/caches/modules-2/files-2.1/net.sf.jopt-simple/jopt-simple/5.0.3/cdd846cfc4e0f7eefafc02c0f5dce32b9303aa2a/jopt-simple-5.0.3.jar:/Users/jblum/.gradle/caches/modules-2/files-2.1/org.apache.logging.log4j/log4j-core/2.10.0/c90b597163cd28ab6d9687edd53db601b6ea75a1/log4j-core-2.10.0.jar:/Users/jblum/.gradle/caches/modules-2/files-2.1/org.apache.logging.log4j/log4j-api/2.10.0/fec5797a55b786184a537abd39c3fa1449d752d6/log4j-api-2.10.0.jar:/Users/jblum/.gradle/caches/modules-2/files-2.1/commons-beanutils/commons-beanutils/1.9.3/c845703de334ddc6b4b3cd26835458cb1cba1f3d/commons-beanutils-1.9.3.jar:/Users/jblum/.gradle/caches/modules-2/files-2.1/io.github.lukehutch/fast-classpath-scanner/2.0.11/ae34a7a5e6de8ad1f86e12f6f7ae1869fcfe9987/fast-classpath-scanner-2.0.11.jar:/Users/jblum/.gradle/caches/modules-2/files-2.1/org.apache.geode/geode-common/1.2.1/9db253081d33f424f6e3ce0cde4b306e23e3420b/geode-common-1.2.1.jar:/Users/jblum/.gradle/caches/modules-2/files-2.1/org.apache.geode/geode-json/1.2.1/bdb4c262e4ce6bb3b22e0f511cfb133a65fa0c04/geode-json-1.2.1.jar:/Users/jblum/.gradle/caches/modules-2/files-2.1/org.apache.lucene/lucene-analyzers-common/6.4.1/c6f0f593503080204e9d33189cdc59320f55db37/lucene-analyzers-common-6.4.1.jar:/Users/jblum/.gradle/caches/modules-2/files-2.1/org.apache.lucene/lucene-queryparser/6.4.1/1fc5795a072770a2c47dce11a3c85a80f3437af6/lucene-queryparser-6.4.1.jar:/Users/jblum/.gradle/caches/modules-2/files-2.1/org.apache.lucene/lucene-queries/6.4.1/6de41d984c16185a244b52c4d069b00f5b2b120f/lucene-queries-6.4.1.jar:/Users/jblum/.gradle/caches/modules-2/files-2.1/org.apache.lucene/lucene-core/6.4.1/2a18924b9e0ed86b318902cb475a0b9ca4d7be5b/lucene-core-6.4.1.jar:/Users/jblum/.gradle/caches/modules-2/files-2.1/com.fasterxml.jackson.core/jackson-core/2.9.6/4e393793c37c77e042ccc7be5a914ae39251b365/jackson-core-2.9.6.jar:/Users/jblum/.gradle/caches/modules-2/files-2.1/javax.transaction/javax.transaction-api/1.2/d81aff979d603edd90dcd8db2abc1f4ce6479e3e/javax.transaction-api-1.2.jar:/Users/jblum/.gradle/caches/modules-2/files-2.1/commons-logging/commons-logging/1.2/4bfc12adfe4842bf07b657f0369c4cb522955686/commons-logging-1.2.jar:/Users/jblum/.gradle/caches/modules-2/files-2.1/commons-collections/commons-collections/3.2.2/8ad72fe39fa8c91eaaf12aadb21e0c3661fe26d5/commons-collections-3.2.2.jar:/Users/jblum/.gradle/caches/modules-2/files-2.1/org.springframework.shell/spring-shell/1.2.0.RELEASE/d94047721f292bd5334b5654e8600cef4b845049/spring-shell-1.2.0.RELEASE.jar:/Users/jblum/.gradle/caches/modules-2/files-2.1/com.google.guava/guava/17.0/9c6ef172e8de35fd8d4d8783e4821e57cdef7445/guava-17.0.jar:/Users/jblum/.gradle/caches/modules-2/files-2.1/jline/jline/2.12/ce9062c6a125e0f9ad766032573c041ae8ecc986/jline-2.12.jar org.springframework.geode.docs.example.app.server.SpringBootApacheGeodeCacheServerApplication
SLF4J: Failed to load class "org.slf4j.impl.StaticLoggerBinder".
SLF4J: Defaulting to no-operation (NOP) logger implementation
SLF4J: See https://www.slf4j.org/codes.html#StaticLoggerBinder for further details.

  .   ____          _            __ _ _
 /\\ / ___'_ __ _ _(_)_ __  __ _ \ \ \ \
( ( )\___ | '_ | '_| | '_ \/ _` | \ \ \ \
 \\/  ___)| |_)| | | | | || (_| |  ) ) ) )
  '  |____| .__|_| |_|_| |_\__, | / / / /
 =========|_|==============|___/=/_/_/_/
 :: Spring Boot ::        (v2.0.3.RELEASE)

[info 2018/06/24 21:42:28.183 PDT &lt;main&gt; tid=0x1] Starting SpringBootApacheGeodeCacheServerApplication on jblum-mbpro-2.local with PID 41795 (/Users/jblum/pivdev/spring-boot-data-geode/spring-geode-docs/build/classes/main started by jblum in /Users/jblum/pivdev/spring-boot-data-geode/spring-geode-docs/build)

[info 2018/06/24 21:42:28.186 PDT &lt;main&gt; tid=0x1] No active profile set, falling back to default profiles: default

[info 2018/06/24 21:42:28.278 PDT &lt;main&gt; tid=0x1] Refreshing org.springframework.context.annotation.AnnotationConfigApplicationContext@6fa51cd4: startup date [Sun Jun 24 21:42:28 PDT 2018]; root of context hierarchy

[warn 2018/06/24 21:42:28.962 PDT &lt;main&gt; tid=0x1] @Bean method PdxConfiguration.pdxDiskStoreAwareBeanFactoryPostProcessor is non-static and returns an object assignable to Spring's BeanFactoryPostProcessor interface. This will result in a failure to process annotations such as @Autowired, @Resource and @PostConstruct within the method's declaring @Configuration class. Add the 'static' modifier to this method to avoid these container lifecycle issues; see @Bean javadoc for complete details.

[info 2018/06/24 21:42:30.036 PDT &lt;main&gt; tid=0x1]
---------------------------------------------------------------------------

  Licensed to the Apache Software Foundation (ASF) under one or more
  contributor license agreements.  See the NOTICE file distributed with this
  work for additional information regarding copyright ownership.

  The ASF licenses this file to You under the Apache License, Version 2.0
  (the "License"); you may not use this file except in compliance with the
  License.  You may obtain a copy of the License at

  https://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
  WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.  See the
  License for the specific language governing permissions and limitations
  under the License.

---------------------------------------------------------------------------
Build-Date: 2017-09-16 07:20:46 -0700
Build-Id: abaker 0
Build-Java-Version: 1.8.0_121
Build-Platform: Mac OS X 10.12.3 x86_64
Product-Name: Apache Geode
Product-Version: 1.2.1
Source-Date: 2017-09-08 11:57:38 -0700
Source-Repository: release/1.2.1
Source-Revision: 0b881b515eb1dcea974f0f5c1b40da03d42af9cf
Native version: native code unavailable
Running on: /10.0.0.121, 8 cpu(s), x86_64 Mac OS X 10.10.5
Communications version: 65
Process ID: 41795
User: jblum
Current dir: /Users/jblum/pivdev/spring-boot-data-geode/spring-geode-docs/build
Home dir: /Users/jblum
Command Line Parameters:
  -ea
  -Dspring.profiles.active=
  -javaagent:/Applications/IntelliJ IDEA 17 CE.app/Contents/lib/idea_rt.jar=62866:/Applications/IntelliJ IDEA 17 CE.app/Contents/bin
  -Dfile.encoding=UTF-8
Class Path:
  /Library/Java/JavaVirtualMachines/jdk1.8.0_152.jdk/Contents/Home/jre/lib/charsets.jar
  ...
Library Path:
  /Users/jblum/Library/Java/Extensions
  /Library/Java/Extensions
  /Network/Library/Java/Extensions
  /System/Library/Java/Extensions
  /usr/lib/java
  .
System Properties:
    PID = 41795
  ...
[info 2018/06/24 21:42:30.045 PDT &lt;main&gt; tid=0x1] Startup Configuration:
 ### GemFire Properties defined with api ###
disable-auto-reconnect=true
jmx-manager=true
jmx-manager-port=1099
jmx-manager-start=true
jmx-manager-update-rate=2000
log-level=config
mcast-port=0
name=SpringBootApacheGeodeCacheServerApplication
start-locator=localhost[10334]
use-cluster-configuration=false
### GemFire Properties using default values ###
ack-severe-alert-threshold=0
...

[info 2018/06/24 21:42:30.090 PDT &lt;main&gt; tid=0x1] Starting peer location for Distribution Locator on localhost/127.0.0.1

[info 2018/06/24 21:42:30.093 PDT &lt;main&gt; tid=0x1] Starting Distribution Locator on localhost/127.0.0.1

[info 2018/06/24 21:42:30.094 PDT &lt;main&gt; tid=0x1] Locator was created at Sun Jun 24 21:42:30 PDT 2018

[info 2018/06/24 21:42:30.094 PDT &lt;main&gt; tid=0x1] Listening on port 10334 bound on address localhost/127.0.0.1

...

[info 2018/06/24 21:42:30.685 PDT &lt;main&gt; tid=0x1] Initializing region _monitoringRegion_10.0.0.121&lt;v0&gt;1024

[info 2018/06/24 21:42:30.688 PDT &lt;main&gt; tid=0x1] Initialization of region _monitoringRegion_10.0.0.121&lt;v0&gt;1024 completed

...

[info 2018/06/24 21:42:31.570 PDT &lt;main&gt; tid=0x1] CacheServer Configuration:   port=40404 max-connections=800 max-threads=0 notify-by-subscription=true socket-buffer-size=32768 maximum-time-between-pings=60000 maximum-message-count=230000 message-time-to-live=180 eviction-policy=none capacity=1 overflow directory=. groups=[] loadProbe=ConnectionCountProbe loadPollInterval=5000 tcpNoDelay=true

[info 2018/06/24 21:42:31.588 PDT &lt;main&gt; tid=0x1] Started SpringBootApacheGeodeCacheServerApplication in 3.77 seconds (JVM running for 5.429)</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>You can now connect to this server by using Gfsh:</p>
</div>
<div class="exampleblock">
<div class="title">Example 245. Connect with Gfsh</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="txt">$ echo $GEMFIRE
/Users/jblum/pivdev/apache-geode-1.2.1
jblum-mbpro-2:lab jblum$
jblum-mbpro-2:lab jblum$ gfsh
    _________________________     __
   / _____/ ______/ ______/ /____/ /
  / /  __/ /___  /_____  / _____  /
 / /__/ / ____/  _____/ / /    / /
/______/_/      /______/_/    /_/    1.2.1

Monitor and Manage Apache Geode

gfsh&gt;connect
Connecting to Locator at [host=localhost, port=10334] ..
Connecting to Manager at [host=10.0.0.121, port=1099] ..
Successfully connected to: [host=10.0.0.121, port=1099]


gfsh&gt;list members
                   Name                     | Id
------------------------------------------- | --------------------------------------------------------------------------
SpringBootApacheGeodeCacheServerApplication | 10.0.0.121(SpringBootApacheGeodeCacheServerApplication:41795)&lt;ec&gt;&lt;v0&gt;:1024


gfsh&gt;describe member --name=SpringBootApacheGeodeCacheServerApplication
Name        : SpringBootApacheGeodeCacheServerApplication
Id          : 10.0.0.121(SpringBootApacheGeodeCacheServerApplication:41795)&lt;ec&gt;&lt;v0&gt;:1024
Host        : 10.0.0.121
Regions     :
PID         : 41795
Groups      :
Used Heap   : 184M
Max Heap    : 3641M
Working Dir : /Users/jblum/pivdev/spring-boot-data-geode/spring-geode-docs/build
Log file    : /Users/jblum/pivdev/spring-boot-data-geode/spring-geode-docs/build
Locators    : localhost[10334]

Cache Server Information
Server Bind              :
Server Port              : 40404
Running                  : true
Client Connections       : 0</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Now you can run additional servers to scale-out your cluster.</p>
</div>
<div class="paragraph">
<p>To do so, you must vary the name of the members you add to your cluster as peers. Apache Geode requires members in a
cluster to be named and for the names of each member in the cluster to be unique.</p>
</div>
<div class="paragraph">
<p>Additionally, since we are running multiple instances of our <code>SpringBootApacheGeodeCacheServerApplication</code> class,
which also embeds a <code>CacheServer</code> component enabling cache clients to connect. Therefore, you must vary the ports
used by the embedded services.</p>
</div>
<div class="paragraph">
<p>Fortunately, you do not need to run another embedded Locator or Manager (you need only one of each in this case).
Therefore, you can switch profiles from non-clustered to using the Spring "clustered" profile, which includes different
configuration (the <code>ClusterConfiguration</code> class) to connect another server as a peer member in the cluster,
which currently has only one member, as shown in Gfsh with the <code>list members</code> command (shown earlier).</p>
</div>
<div class="paragraph">
<p>To add another server, set the member name and <code>CacheServer</code> port to different values with the following
run configuration:</p>
</div>
<div class="exampleblock">
<div class="title">Example 246. Run profile configuration for server 2</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="txt">-server -ea -Dspring.profiles.active=clustered -Dspring.data.gemfire.name=ServerTwo -Dspring.data.gemfire.cache.server.port=41414</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Notice that we explicitly activated the "clustered" Spring profile, which enables the configuration provided in
the nested <code>ClusteredConfiguration</code> class while disabling the configuration provided in the <code>LonerConfiguration</code> class.</p>
</div>
<div class="paragraph">
<p>The <code>ClusteredConfiguration</code> class is also annotated with <code>@UseLocators</code>, which sets the Apache Geode <code>locators</code>
property to "localhost[10334]".  By default, it assumes that the Locator runs on localhost, listening on the default
Locator port of 10334. You can adjust your <code>locators</code> connection endpoint if your Locators run elsewhere in your network
by using the <code>locators</code> attribute of the <code>@UseLocators</code> annotation.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
In production environments, it is common to run multiple Locators in separate processes. Running multiple Locators
provides redundancy in case a Locator fails. If all Locators in your cluster fail, then your cluster will continue to
run, but no other members will be able to join the cluster, which is important when scaling out the cluster. Clients
also will not be able to connect. Restart the Locators if this happens.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Also, we set the <code>spring.data.gemfire.name</code> property to <code>ServerTwo</code>, adjusting the name of our member when it joins
the cluster as a peer.</p>
</div>
<div class="paragraph">
<p>Finally, we set the <code>spring.data.gemfire.cache.server.port</code> property to <code>41414</code> to vary the <code>CacheServer</code> port used by
<code>ServerTwo</code>.  The default <code>CacheServer</code> port is <code>40404</code>. If we had not set this property before starting <code>ServerTwo</code>,
we would have encounter a <code>java.net.BindException</code>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Both <code>spring.data.gemfire.name</code> and <code>spring.data.gemfire.cache.server.port</code> are well-known properties used by SDG
to dynamically configure Apache Geode with a Spring Boot <code>application.properties</code> file or by using Java System
properties. You can find these properties in the annotation Javadoc in SDG&#8217;s annotation-based configuration model.
For example, see the Javadoc for the
<a href="https://docs.spring.io/spring-data/geode/docs/current/api/org/springframework/data/gemfire/config/annotation/CacheServerApplication.html#port--"><code>spring.data.gemfire.cache.server.port</code> property</a>.
Most SDG annotations include corresponding properties that can be defined in Spring Boot <code>application.properties</code>,
which is explained in detail in the <a href="https://docs.spring.io/spring-data/geode/docs/current/reference/html/#bootstrap-annotation-config-properties">documentation</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>After starting our second server, <code>ServerTwo</code>, we should see output similar to the following at the command-line
and in Gfsh when we again <code>list members</code> and <code>describe member</code>:</p>
</div>
<div class="exampleblock">
<div class="title">Example 247. Gfsh output after starting server 2</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="txt">gfsh&gt;list members
                   Name                     | Id
------------------------------------------- | --------------------------------------------------------------------------
SpringBootApacheGeodeCacheServerApplication | 10.0.0.121(SpringBootApacheGeodeCacheServerApplication:41795)&lt;ec&gt;&lt;v0&gt;:1024
ServerTwo                                   | 10.0.0.121(ServerTwo:41933)&lt;v1&gt;:1025


gfsh&gt;describe member --name=ServerTwo
Name        : ServerTwo
Id          : 10.0.0.121(ServerTwo:41933)&lt;v1&gt;:1025
Host        : 10.0.0.121
Regions     :
PID         : 41933
Groups      :
Used Heap   : 165M
Max Heap    : 3641M
Working Dir : /Users/jblum/pivdev/spring-boot-data-geode/spring-geode-docs/build
Log file    : /Users/jblum/pivdev/spring-boot-data-geode/spring-geode-docs/build
Locators    : localhost[10334]

Cache Server Information
Server Bind              :
Server Port              : 41414
Running                  : true
Client Connections       : 0</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>When we list the members of the cluster, we see <code>ServerTwo</code>, and when we <code>describe</code> <code>ServerTwo</code>, we see that its
<code>CacheServer</code> port is appropriately set to <code>41414</code>.</p>
</div>
<div class="paragraph">
<p>We can add one more server, <code>ServerThree</code>, by using the following run configuration:</p>
</div>
<div class="exampleblock">
<div class="title">Example 248. Add server three to our cluster</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="txt">-server -ea -Dspring.profiles.active=clustered -Dspring.data.gemfire.name=ServerThree -Dspring.data.gemfire.cache.server.port=42424</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>We again see similar output at the command-line and in Gfsh:</p>
</div>
<div class="exampleblock">
<div class="title">Example 249. Gfsh output after starting server 3</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="txt">gfsh&gt;list members
                   Name                     | Id
------------------------------------------- | --------------------------------------------------------------------------
SpringBootApacheGeodeCacheServerApplication | 10.0.0.121(SpringBootApacheGeodeCacheServerApplication:41795)&lt;ec&gt;&lt;v0&gt;:1024
ServerTwo                                   | 10.0.0.121(ServerTwo:41933)&lt;v1&gt;:1025
ServerThree                                 | 10.0.0.121(ServerThree:41965)&lt;v2&gt;:1026


gfsh&gt;describe member --name=ServerThree
Name        : ServerThree
Id          : 10.0.0.121(ServerThree:41965)&lt;v2&gt;:1026
Host        : 10.0.0.121
Regions     :
PID         : 41965
Groups      :
Used Heap   : 180M
Max Heap    : 3641M
Working Dir : /Users/jblum/pivdev/spring-boot-data-geode/spring-geode-docs/build
Log file    : /Users/jblum/pivdev/spring-boot-data-geode/spring-geode-docs/build
Locators    : localhost[10334]

Cache Server Information
Server Bind              :
Server Port              : 42424
Running                  : true
Client Connections       : 0</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Congratulations. You have just started a small Apache Geode cluster with 3 members by using Spring Boot from inside
your IDE.</p>
</div>
<div class="paragraph">
<p>Now you can build and run a Spring Boot, Apache Geode <code>ClientCache</code> application that connects to this cluster. To do so,
include and use Spring Boot for Apache Geode.</p>
</div>
</div>
<div class="sect2">
<h3 id="geode-testing-support">Testing</h3>
<div class="paragraph">
<p><a href="https://github.com/spring-projects/spring-test-data-geode">Spring Test for Apache Geode</a> (STDG) is a relatively new project
to help you write both unit and integration tests when you use Apache Geode in a Spring context. In fact, the entire
{github-url}/tree/master/spring-geode-autoconfigure/src/test/java/org/springframework/geode/boot/autoconfigure[test suite]
in Spring Boot for Apache Geode is based on this project.</p>
</div>
<div class="paragraph">
<p>All Spring projects that integrate with Apache Geode will use this new test framework for all their testing needs,
making this new test framework for Apache Geode a proven and reliable solution for all your Apache Geode application
testing needs when using Spring as well.</p>
</div>
<div class="paragraph">
<p>In future versions, this reference guide will include an entire chapter on testing along with samples. In the meantime,
look to the STDG <a href="https://github.com/spring-projects/spring-test-data-geode#stdg-in-a-nutshell">README</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="geode-examples">Examples</h3>
<div class="paragraph">
<p>The definitive source of truth on how to best use Spring Boot for Apache Geode is to refer to
the <a href="#geode-samples">samples</a>.</p>
</div>
<div class="paragraph">
<p>See also the <a href="https://github.com/jxblum/temperature-service">Temperature Service</a>, Spring Boot application that implements
a temperature sensor and monitoring, Internet of Things (IOT) example. The example uses SBDG to showcase Apache Geode CQ,
function implementations and executions, and positions Apache Geode as a caching provider in Spring&#8217;s Cache Abstraction.
It is a working, sophisticated, and complete example, and we highly recommend it as a good starting point for real-world
use cases.</p>
</div>
<div class="paragraph">
<p>See the <a href="https://github.com/jxblum/contacts-application/tree/master/boot-example">Boot example</a> from the contact
application reference implementation (RI) for Spring Data for Apache Geode (SDG) as yet another example.</p>
</div>
</div>
<div class="sect2">
<h3 id="references">References</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Spring Framework <a href="https://docs.spring.io/spring/docs/current/spring-framework-reference">Reference Guide</a> | <a href="https://docs.spring.io/spring/docs/current/javadoc-api">Javadoc</a></p>
</li>
<li>
<p>Spring Boot <a href="https://docs.spring.io/spring-boot/docs/current/reference/html">Reference Guide</a> | <a href="https://docs.spring.io/spring-boot/docs/current/api">Javadoc</a></p>
</li>
<li>
<p>Spring Data Commons <a href="https://docs.spring.io/spring-data/commons/docs/current/reference/html">Reference Guide</a> | <a href="https://docs.spring.io/spring-data/commons/docs/current/api">Javadoc</a></p>
</li>
<li>
<p>Spring Data for Apache Geode <a href="https://docs.spring.io/spring-data/geode/docs/current/reference/html">Reference Guide</a> | <a href="https://docs.spring.io/spring-data/geode/docs/current/api">Javadoc</a></p>
</li>
<li>
<p>Spring Session for Apache Geode <a href="https://docs.spring.io/autorepo/docs/spring-session-data-geode-build/{spring-session-data-geode-version}/reference/html5">Reference Guide</a> | <a href="https://docs.spring.io/autorepo/docs/spring-session-data-geode-build/{spring-session-data-geode-version}/api">Javadoc</a></p>
</li>
<li>
<p>Spring Test for Apache Geode <a href="https://github.com/spring-projects/spring-test-data-geode#spring-test-framework-for-apache-geode&#8212;&#8203;vmware-tanzu-gemfire">README</a></p>
</li>
<li>
<p>Apache Geode <a href="https://geode.apache.org/docs/guide/{apache-geode-doc-version}">User Guide</a> | <a href="https://geode.apache.org/releases/latest/javadoc">Javadoc</a></p>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Version {version}<br>
Last updated 2022-10-06 11:36:43 -0700
</div>
</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/run_prettify.min.js"></script>
</body>
</html>